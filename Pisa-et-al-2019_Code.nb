(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    538128,      13815]
NotebookOptionsPosition[    528680,      13553]
NotebookOutlinePosition[    529709,      13587]
CellTagsIndexPosition[    529666,      13584]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Mathematica code: Simulations for \[OpenCurlyDoubleQuote]The influence of \
fluctuating population densities on evolutionary dynamics\
\[CloseCurlyDoubleQuote]\
\>", "Chapter",
 CellChangeTimes->{{3.7401452325168843`*^9, 3.7401452383460183`*^9}, {
  3.748608282494454*^9, 3.7486082831350307`*^9}, {3.761947726291092*^9, 
  3.761947777568524*^9}}],

Cell[CellGroupData[{

Cell["Evolution only (in the absence of population dynamics)", "Section",
 CellChangeTimes->{{3.7401979518956842`*^9, 3.740197956508235*^9}, {
  3.7605218341953697`*^9, 3.7605218447761116`*^9}}],

Cell[TextData[StyleBox["Find the formula for a polymorphic equilibrium:",
 FontVariations->{"Underline"->True}]], "Text",
 CellChangeTimes->{{3.7401981268028636`*^9, 3.7401981949438467`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p1p2EquilibriumAll", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "m12"}], ")"}], " ", "p1", " ", "c1"}], "+", 
             RowBox[{"m21", " ", "p2", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", "c1"}], ")"}]}]}], 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "m12"}], ")"}], " ", "c1"}], " ", "+", 
             RowBox[{"m21", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", "c1"}], ")"}]}]}]], "*", " ", 
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], " ", "p1", " ", "c1"}], 
                  "+", 
                  RowBox[{"m21", " ", "p2", " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "c1"}], ")"}]}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], " ", "c1"}], " ", "+", 
                  RowBox[{"m21", " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "c1"}], ")"}]}]}], ")"}]}], " ", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], " ", "p1", " ", "c1"}], 
                    "+", 
                    RowBox[{"m21", " ", "p2", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "c1"}], ")"}]}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], " ", "c1"}], " ", "+", 
                    RowBox[{"m21", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "c1"}], ")"}]}]}], ")"}]}]}], ")"}], 
                " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "s1"}], ")"}]}]}], ")"}]}], ")"}]}], "-", 
          "p1"}], "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "m21"}], ")"}], " ", "p2", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", "c1"}], ")"}]}], "+", 
             RowBox[{"m12", " ", "p1", " ", "c1"}]}], 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "m21"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", "c1"}], ")"}]}], " ", "+", " ", 
             RowBox[{"m12", " ", "c1"}]}]], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "s2"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], " ", "p2", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "c1"}], ")"}]}], "+", 
                    RowBox[{"m12", " ", "p1", " ", "c1"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "c1"}], ")"}]}], " ", "+", " ", 
                    RowBox[{"m12", " ", "c1"}]}], ")"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "s2"}], ")"}]}], "+", "1", "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], " ", "p2", " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "c1"}], ")"}]}], "+", 
                  RowBox[{"m12", " ", "p1", " ", "c1"}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "c1"}], ")"}]}], " ", "+", " ", 
                  RowBox[{"m12", " ", "c1"}]}], ")"}]}]}], ")"}]}], ")"}]}], 
          "-", "p2"}], "\[Equal]", "0"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2"}], "}"}]}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p1p2Equilibrium", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p1p2EquilibriumAll", "\[LeftDoubleBracket]", 
       RowBox[{"3", ",", "1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"p1p2EquilibriumAll", "\[LeftDoubleBracket]", 
       RowBox[{"3", ",", "2", ",", "2"}], "\[RightDoubleBracket]"}]}], 
     "}"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Extract", " ", "the", " ", "relevant", " ", "solution", " ", "only", " ", 
    "and", " ", "turn", " ", "it", " ", "into", " ", "a", " ", "function"}], 
   " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.740198794235943*^9, 3.740198954932149*^9}, {
   3.7402009205385685`*^9, 3.7402009413390045`*^9}, {3.7402020306791396`*^9, 
   3.740202048103715*^9}, 3.7402023101522617`*^9, {3.740202372787396*^9, 
   3.7402023975246863`*^9}, {3.740202473696004*^9, 3.7402024772745523`*^9}, 
   3.740203182261605*^9, {3.740203293080001*^9, 3.7402032966902156`*^9}, 
   3.7402035069929037`*^9, {3.7402943564624543`*^9, 3.7402943588384833`*^9}, {
   3.7402944677634664`*^9, 3.740294469764063*^9}, 3.7402950662715635`*^9, {
   3.7403197990341187`*^9, 3.7403198396990643`*^9}, {3.7485271808596964`*^9, 
   3.748527187361064*^9}}],

Cell[TextData[{
 StyleBox["Find the conditions for a protected polymorphism:",
  FontVariations->{"Underline"->True}],
 "\n1. Compute the Jacobian matrices at 0 and 1 resp."
}], "Text",
 CellChangeTimes->{{3.740199052795538*^9, 3.740199072064114*^9}, {
  3.7401991727710032`*^9, 3.740199173958359*^9}, {3.7401992276263943`*^9, 
  3.7401992688987265`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"jacobi", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "m12"}], ")"}], " ", "p1", " ", "c1"}], "+", 
              RowBox[{"m21", " ", "p2", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", "c1"}], ")"}]}]}], 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "m12"}], ")"}], " ", "c1"}], " ", "+", 
              RowBox[{"m21", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", "c1"}], ")"}]}]}]], "*", " ", 
            RowBox[{"(", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], " ", "p1", " ", "c1"}], 
                   "+", 
                   RowBox[{"m21", " ", "p2", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "c1"}], ")"}]}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], " ", "c1"}], " ", "+", 
                   RowBox[{"m21", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "c1"}], ")"}]}]}], ")"}]}], " ", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], " ", "p1", " ", "c1"}], 
                    "+", 
                    RowBox[{"m21", " ", "p2", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "c1"}], ")"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], " ", "c1"}], " ", "+", 
                    RowBox[{"m21", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "c1"}], ")"}]}]}], ")"}]}]}], ")"}], 
                 " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "s1"}], ")"}]}]}], ")"}]}], ")"}]}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "m21"}], ")"}], " ", "p2", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", "c1"}], ")"}]}], "+", 
              RowBox[{"m12", " ", "p1", " ", "c1"}]}], 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "m21"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", "c1"}], ")"}]}], " ", "+", " ", 
              RowBox[{"m12", " ", "c1"}]}]], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "s2"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], " ", "p2", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "c1"}], ")"}]}], "+", 
                    RowBox[{"m12", " ", "p1", " ", "c1"}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "c1"}], ")"}]}], " ", "+", " ", 
                    RowBox[{"m12", " ", "c1"}]}], ")"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "s2"}], ")"}]}], "+", "1", "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], " ", "p2", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "c1"}], ")"}]}], "+", 
                   RowBox[{"m12", " ", "p1", " ", "c1"}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "c1"}], ")"}]}], " ", "+", " ", 
                   RowBox[{"m12", " ", "c1"}]}], ")"}]}]}], ")"}]}], 
             ")"}]}]}], "}"}], ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2"}], "}"}]}], "//", "Simplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jacobiZero", "=", 
   RowBox[{
    RowBox[{"jacobi", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", "\[Rule]", " ", "0"}], ",", 
       RowBox[{"p2", "\[Rule]", "0"}]}], " ", "}"}]}], "//", "Simplify"}]}], 
  " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jacobiOne", " ", "=", 
    RowBox[{
     RowBox[{"jacobi", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "\[Rule]", " ", "1"}], ",", 
        RowBox[{"p2", "\[Rule]", "1"}]}], " ", "}"}]}], "//", "Simplify"}]}], 
   " ", ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.740199101709882*^9, 3.740199162346721*^9}, {
  3.7401995006138954`*^9, 3.740199509146408*^9}}],

Cell["2. Compute trace (s) and determinant (d) of both matrices", "Text",
 CellChangeTimes->{{3.7401992989353857`*^9, 3.740199324596254*^9}, {
  3.740199435009081*^9, 3.740199441463114*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dZero", "=", " ", 
   RowBox[{
    RowBox[{"Det", "[", "jacobiZero", "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sZero", "=", 
    RowBox[{
     RowBox[{"Tr", "[", "jacobiZero", "]"}], "//", "Simplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dOne", "=", " ", 
   RowBox[{
    RowBox[{"Det", "[", "jacobiOne", "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sOne", "=", 
   RowBox[{
    RowBox[{"Tr", "[", "jacobiOne", "]"}], "//", "Simplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7401993540230026`*^9, 3.74019941323974*^9}, {
  3.740199511693516*^9, 3.740199518241793*^9}}],

Cell["\<\
3. Now, 0 is stable iff |sZero| < 1 + dZero < 2
    and  1 is stable iff |sOne| < 1 + dOne < 2\
\>", "Text",
 CellChangeTimes->{{3.7401995738454323`*^9, 3.7401996689894485`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Reduce", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "sZero", "]"}], "<", 
     RowBox[{"1", "+", "dZero"}], "<", "2"}], "&&", 
    RowBox[{"0", "<", "m12", "<", 
     RowBox[{"1", "/", "2"}]}], "&&", 
    RowBox[{"0", "<", "m21", "<", 
     RowBox[{"1", "/", "2"}]}], "&&", 
    RowBox[{"0", "<", "s1", "<", "1"}], "&&", 
    RowBox[{"0", "<", "s2", "<", "1"}], "&&", 
    RowBox[{"0", "<", "c1", "<", "1"}]}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Reduce", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "sOne", "]"}], "<", 
     RowBox[{"1", "+", "dOne"}], "<", "2"}], "&&", 
    RowBox[{"0", "<", "m12", "<", 
     RowBox[{"1", "/", "2"}]}], "&&", 
    RowBox[{"0", "<", "m21", "<", 
     RowBox[{"1", "/", "2"}]}], "&&", 
    RowBox[{"0", "<", "s1", "<", "1"}], "&&", 
    RowBox[{"0", "<", "s2", "<", "1"}], "&&", 
    RowBox[{"0", "<", "c1", "<", "1"}]}], "]"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.740199692102049*^9, 3.7401996991347437`*^9}, {
   3.740199856521566*^9, 3.7401998634132905`*^9}, 3.7402000130358086`*^9}],

Cell["\<\
4. Reverse the unequal signs to obtain conditions for stability of the \
polymorphic equilibrium ( = instability of both monomorphisms)\
\>", "Text",
 CellChangeTimes->{{3.74019997813901*^9, 3.740200026553975*^9}, {
  3.748527265632292*^9, 3.748527294873155*^9}}],

Cell[TextData[{
 "To obtain the condition stated in the main text ( ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"m", "*"}], "|", 
    RowBox[{
     RowBox[{"1", "/", 
      SubscriptBox["s", "1"]}], "-", 
     RowBox[{"1", "/", 
      SubscriptBox["s", "2"]}]}], "|", 
    RowBox[{"<", 
     RowBox[{"1", "-", "m"}]}]}], TraditionalForm]]],
 " ) set ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["c", "1"], "=", 
    RowBox[{"1", "/", "2"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "12"], "=", 
    RowBox[{
     SubscriptBox["m", "21"], "=", "m"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ":"
}], "Text",
 CellChangeTimes->{{3.7402000749227576`*^9, 3.740200100130234*^9}, {
  3.7402001452182245`*^9, 3.740200196805497*^9}, {3.7402002565190086`*^9, 
  3.740200333740382*^9}, {3.7402274756846685`*^9, 3.740227561027417*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"c1", "=", 
   RowBox[{"1", "/", "2"}]}], ";", "   ", 
  RowBox[{"m", "=."}], ";", " ", 
  RowBox[{"m12", "=", "m"}], ";", 
  RowBox[{"m21", "=", "m"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", "m21", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "m21", "+", 
      RowBox[{"c1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m12", "+", "m21"}], ")"}]}]}], ")"}], " ", 
    "s2"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "m21"}], "+", 
      RowBox[{"c1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m12", "+", "m21"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"s2", "-", 
      RowBox[{"m21", " ", "s2"}], "+", 
      RowBox[{"c1", " ", 
       RowBox[{"(", 
        RowBox[{"m12", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m21"}], ")"}], " ", "s2"}]}], ")"}]}]}],
      ")"}]}]], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  FractionBox[
   RowBox[{"c1", " ", "m12", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "m21"}], "+", 
      RowBox[{"c1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m12", "+", "m21"}], ")"}]}]}], ")"}], " ", 
    "s1"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "m21", "+", 
      RowBox[{"c1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m12", "+", "m21"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", "m21"}], "+", 
      RowBox[{"c1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m12"}], ")"}], " ", "s1"}]}], ")"}]}]], "//",
   "Simplify"}]}], "Input",
 CellChangeTimes->{{3.740200219543751*^9, 3.7402002211690674`*^9}, 
   3.7402003721072454`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Density dependent regulation", "Section",
 CellChangeTimes->{{3.740145261881398*^9, 3.740145269194948*^9}}],

Cell[CellGroupData[{

Cell["Simulations", "Subsection",
 CellChangeTimes->{{3.7401455515016174`*^9, 3.74014555345501*^9}}],

Cell[TextData[{
 "CompleteModel [s1, s2, m12, m21, p1, p2, N1, N2, K1, K2, r1, r2, tm]  \
iterates the system (for initial conditions p1, p2, N1, N2)  tm times and \
creates a list {",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "(", "1", ")"}], ",", " ", 
      RowBox[{
       SubscriptBox["p", "2"], "(", "1", ")"}], ",", " ", 
      RowBox[{
       SubscriptBox["N", "1"], "(", "1", ")"}], ",", " ", 
      RowBox[{
       SubscriptBox["N", "2"], "(", "1", ")"}]}]}]}], TraditionalForm]]],
 " }, ... , ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "1"], "(", "t", ")"}], ",", " ", 
     RowBox[{
      SubscriptBox["p", "2"], "(", "t", ")"}], ",", " ", 
     RowBox[{
      SubscriptBox["N", "1"], "(", "t", ")"}], ",", " ", 
     RowBox[{
      SubscriptBox["N", "2"], "(", "t", ")"}]}]}], TraditionalForm]]],
 " }, ... , ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "1"], "(", "tm", ")"}], ",", " ", 
     RowBox[{
      SubscriptBox["p", "2"], "(", "tm", ")"}], ",", " ", 
     RowBox[{
      SubscriptBox["N", "1"], "(", "tm", ")"}], ",", " ", 
     RowBox[{
      SubscriptBox["N", "2"], "(", "tm", ")"}]}]}], TraditionalForm]]],
 " } } of the results:"
}], "Text",
 CellChangeTimes->{{3.7401457914622135`*^9, 3.7401458778844*^9}, 
   3.7401459400867248`*^9, {3.740146368155882*^9, 3.7401463725316286`*^9}, {
   3.74014652426519*^9, 3.7401465408933353`*^9}, {3.740146588900976*^9, 
   3.74014669091969*^9}, {3.7401471054009085`*^9, 3.7401471203565335`*^9}, {
   3.7485292081510196`*^9, 3.74852921721154*^9}, {3.761917586658828*^9, 
   3.7619176324201035`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CompleteModel", "[", 
   RowBox[{
   "s1_", ",", "s2_", ",", "m12_", ",", "m21_", ",", "p1_", ",", "p2_", ",", 
    "N1_", ",", "N2_", " ", ",", "K1_", ",", "K2_", ",", "r1_", ",", "r2_", 
    ",", "tm_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"w1A", "=", "1"}], ",", 
      RowBox[{"w1a", "=", 
       RowBox[{"1", "-", "s1"}]}], ",", 
      RowBox[{"w2A", "=", 
       RowBox[{"1", "-", "s2"}]}], ",", 
      RowBox[{"w2a", "=", "1"}]}], "}"}], ",", 
    RowBox[{"NestList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m12"}], ")"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{"m21", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m12"}], ")"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{"m21", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}]}]],
           "*", 
          RowBox[{"(", 
           RowBox[{"w1A", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}], ")"}], "*", 
               "w1A"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}]}], ")"}], "*", 
               "w1a"}]}], ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m21"}], ")"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{"m12", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m21"}], ")"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{"m12", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}]],
           "*", 
          RowBox[{"(", 
           RowBox[{"w2A", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}], ")"}], "*", 
               "w2A"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}]}], ")"}], "*", 
               "w2a"}]}], ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m12"}], ")"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{"m21", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}]}], 
           ")"}], 
          RowBox[{"Exp", "[", " ", 
           RowBox[{"r1", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m12"}], ")"}], 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{"m21", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "4", 
                  "\[RightDoubleBracket]"}]}]}], "K1"]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}], ")"}], "*", 
               "w1A"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}]}], ")"}], "*", 
               "w1a"}]}], ")"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m21"}], ")"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{"m12", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
           ")"}], " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"r2", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m21"}], ")"}], 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "4", 
                  "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{"m12", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}]}]}], "K2"]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}], ")"}], "*", 
               "w2A"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}]}], ")"}], "*", 
               "w2a"}]}], ")"}]}], "]"}]}]}], "}"}], " ", "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2", ",", "N1", ",", "N2"}], "}"}], ",", "tm"}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7401459979257345`*^9, 3.7401460323222322`*^9}, 
   3.7401462087655964`*^9, {3.7485292388559837`*^9, 3.7485292837101803`*^9}}],

Cell[TextData[{
 "With this, we can e.g. create ",
 StyleBox["Fig. 2",
  FontWeight->"Bold"],
 " with the following parameters:"
}], "Text",
 CellChangeTimes->{{3.740148032933442*^9, 3.7401480381216326`*^9}, {
   3.7401480834906445`*^9, 3.7401481569755945`*^9}, {3.7403219539766912`*^9, 
   3.740321989468795*^9}, 3.7403240984192553`*^9, 3.7485291027467575`*^9, {
   3.748606470235115*^9, 3.7486064846136675`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "0.1"}], ";", " ", 
  RowBox[{"m12", "=", "m"}], ";", " ", 
  RowBox[{"m21", "=", "m"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "=", "0.05"}], ";", " ", 
  RowBox[{"s1", "=", "s"}], ";", " ", 
  RowBox[{"s2", "=", "s"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r2", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kk", "=", "100"}], ";", 
  RowBox[{"K1", "=", "kk"}], ";", 
  RowBox[{"K2", "=", "kk"}], ";", " ", 
  RowBox[{"c1", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N1", "=", "1"}], ";", " ", 
  RowBox[{"N2", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tm", "=", "1250"}], ";"}]}], "Input",
 CellChangeTimes->{{3.740148437361336*^9, 3.7401485201276093`*^9}, {
  3.740200818361204*^9, 3.740200833098524*^9}, {3.7402010436555467`*^9, 
  3.7402010448279285`*^9}, {3.7402967778485627`*^9, 3.7402968155883684`*^9}, {
  3.7485293085395975`*^9, 3.748529344750455*^9}, {3.748529521194784*^9, 
  3.748529521850315*^9}, {3.748530037659954*^9, 3.7485300486123953`*^9}, {
  3.7485301405663834`*^9, 3.7485301442480288`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"r1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p1", "=", "0.01"}], ";", " ", 
  RowBox[{"p2", "=", "0.005"}], ";", 
  RowBox[{"modelR1", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"CompleteModel", "[", 
     RowBox[{
     "s1", ",", "s2", ",", "m12", ",", "m21", ",", "p1", ",", "p2", ",", "N1",
       ",", "N2", ",", "K1", ",", "K2", ",", "r1", ",", "r2", ",", "tm"}], 
     "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.740201123450468*^9, {3.7402014441389513`*^9, 3.7402015608289127`*^9}, {
   3.7402038295041227`*^9, 3.7402038303014126`*^9}, {3.740203890106944*^9, 
   3.740203985094172*^9}, 3.7402278999150295`*^9, {3.748529377344947*^9, 
   3.748529405692172*^9}, {3.748529556904194*^9, 3.7485295747159224`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"r1", "=", "2.5"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p1", "=", "0.999"}], ";", " ", 
  RowBox[{"p2", "=", "0.997"}], ";", " ", 
  RowBox[{"modelR25", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"CompleteModel", "[", 
     RowBox[{
     "s1", ",", "s2", ",", "m12", ",", "m21", ",", "p1", ",", "p2", ",", "N1",
       ",", "N2", ",", "K1", ",", "K2", ",", "r1", ",", "r2", ",", "tm"}], 
     "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7402039941421256`*^9, 3.7402039962987022`*^9}, 
   3.740227906416511*^9, 3.740296764205832*^9, 3.748529412513074*^9, {
   3.748529580690815*^9, 3.7485295946938887`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"P1", "=", 
   RowBox[{
   "modelR1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
  " ", 
  RowBox[{"P2", "=", 
   RowBox[{
   "modelR1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
  " ", 
  RowBox[{"N1", "=", 
   RowBox[{
   "modelR1", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], ";", 
  " ", 
  RowBox[{"N2", "=", 
   RowBox[{
   "modelR1", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P1Fluct", "=", 
   RowBox[{
   "modelR25", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
  " ", 
  RowBox[{"P2Fluct", "=", 
   RowBox[{
   "modelR25", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
  " ", 
  RowBox[{"N1Fluct", "=", 
   RowBox[{
   "modelR25", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], ";", 
  " ", 
  RowBox[{"N2Fluct", "=", 
   RowBox[{
   "modelR25", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7402015831961823`*^9, 3.7402016069967213`*^9}, {
   3.7402016434875045`*^9, 3.7402016649291134`*^9}, {3.7402038243445363`*^9, 
   3.7402038823870983`*^9}, {3.740203942508956*^9, 3.74020396258994*^9}, {
   3.7402040115036545`*^9, 3.740204036210815*^9}, {3.7402279136206427`*^9, 
   3.740227925998116*^9}, 3.740227958987668*^9, {3.7485298591600456`*^9, 
   3.748529894325657*^9}}],

Cell[BoxData[
 RowBox[{"GraphicsGrid", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"N1", "+", "1"}], ")"}], "/", "K1"}], ",", 
           RowBox[{"N2", "/", "K2"}]}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "100"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"Joined", "\[Rule]", " ", "True"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"P1", ",", "P2"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1200"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", " ", "True"}]}], "]"}], ",", 
         RowBox[{"Plot", "[", 
          RowBox[{"p1p2Equilibrium", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "tm"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"Dashed", ",", " ", "Gray"}], "}"}]}]}], "]"}]}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N1Fluct", "/", "K1"}], ",", 
           RowBox[{"N2Fluct", "/", "K2"}]}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "100"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"Joined", "\[Rule]", " ", "True"}]}], "]"}], ",", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"P1Fluct", ",", "P2Fluct"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1200"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", " ", "True"}]}], "]"}], ",", 
         RowBox[{"Plot", "[", 
          RowBox[{"p1p2Equilibrium", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "tm"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"Dashed", ",", " ", "Gray"}], "}"}]}]}], "]"}]}], 
        "]"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", " ", "900"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7402016746808615`*^9, 3.740201686119809*^9}, 
   3.74020174178421*^9, {3.7402019479784365`*^9, 3.740201977842548*^9}, {
   3.740202510357145*^9, 3.7402025200934577`*^9}, {3.7402027705441413`*^9, 
   3.740202851841714*^9}, {3.740202906522953*^9, 3.740203015544473*^9}, {
   3.7402031648521795`*^9, 3.7402031678839884`*^9}, 3.740203739346366*^9, {
   3.7402951114958625`*^9, 3.7402951330948763`*^9}, 3.740296909790468*^9, {
   3.7485294584785213`*^9, 3.7485294963756685`*^9}, {3.748529871922269*^9, 
   3.748529900298036*^9}, {3.74852994325381*^9, 3.7485300129588327`*^9}}],

Cell[TextData[{
 "\nCompleteModelLast [s1, s2, m12, m21, p1, p2, N1, N2, K1, K2, r1, r2, tm]  \
does the same iteration as \[OpenCurlyDoubleQuote]CompleteModel\
\[CloseCurlyDoubleQuote], but saves only the last element  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "1"], "(", "tm", ")"}], ",", " ", 
     RowBox[{
      SubscriptBox["p", "2"], "(", "tm", ")"}], ",", " ", 
     RowBox[{
      SubscriptBox["N", "1"], "(", "tm", ")"}], ",", " ", 
     RowBox[{
      SubscriptBox["N", "2"], "(", "tm", ")"}]}]}], TraditionalForm]]],
 " }, i.e. we use it to analyze the long-term behavior (by choosing tm large \
enough):"
}], "Text",
 CellChangeTimes->{{3.740146341322995*^9, 3.740146344542445*^9}, 
   3.7401465658504148`*^9, {3.740146702795456*^9, 3.7401468606370597`*^9}, {
   3.740147073177106*^9, 3.740147088085516*^9}, {3.7401471334365487`*^9, 
   3.7401471616911154`*^9}, 3.7402279761781683`*^9, {3.740228111423373*^9, 
   3.7402281262075834`*^9}, 3.7485302025162487`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CompleteModelLast", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s1", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s2", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m12", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m21", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p2", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"N1", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"N2", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"K1", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"K2", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"r1", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"r2", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"tm", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"w1A", "=", "1"}], ",", 
         RowBox[{"w1a", "=", 
          RowBox[{"1", "-", "s1"}]}], ",", 
         RowBox[{"w2A", "=", 
          RowBox[{"1", "-", "s2"}]}], ",", 
         RowBox[{"w2a", "=", "1"}]}], "}"}], ",", 
       RowBox[{"Nest", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "m12"}], ")"}], 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}], "+", 
                 RowBox[{"m21", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "4", 
                   "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "m12"}], ")"}], 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}], "+", 
                 RowBox[{"m21", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "4", 
                   "\[RightDoubleBracket]"}]}]}], ")"}]}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"w1A", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}], ")"}], "*", 
                  "w1A"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}]}], ")"}], "*", 
                  "w1a"}]}], ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "m21"}], ")"}], 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "4", 
                   "\[RightDoubleBracket]"}]}], "+", 
                 RowBox[{"m12", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "m21"}], ")"}], 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "4", 
                   "\[RightDoubleBracket]"}]}], "+", 
                 RowBox[{"m12", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}]}], ")"}]}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"w2A", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}], ")"}], "*", 
                  "w2A"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}]}], ")"}], "*", 
                  "w2a"}]}], ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m12"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m21", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", 
                 "\[RightDoubleBracket]"}]}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"r1", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], "K1"]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}], ")"}], "*", 
                  "w1A"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}]}], ")"}], "*", 
                  "w1a"}]}], ")"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m21"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m12", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}]}], ")"}], " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"r2", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], "K2"]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}], ")"}], "*", 
                  "w2A"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}
                    ]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}]}], ")"}], "*", 
                  "w2a"}]}], ")"}]}], "]"}]}]}], "}"}], " ", "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p2", ",", "N1", ",", "N2"}], "}"}], ",", "tm"}],
         "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6721289880822554`*^9, 3.672128989111862*^9}, 
   3.6721290468644323`*^9, {3.672129093149929*^9, 3.672129147719079*^9}, {
   3.672129204003911*^9, 3.6721292348919106`*^9}, {3.672129270381911*^9, 
   3.6721293334839106`*^9}, {3.672130640138384*^9, 3.672130682040436*^9}, {
   3.673627786911661*^9, 3.6736279190834556`*^9}, 3.6736866294408445`*^9, {
   3.6736866720743923`*^9, 3.673686700225286*^9}, {3.673686740472989*^9, 
   3.673686772681857*^9}, {3.6736868455742197`*^9, 3.67368686888099*^9}, {
   3.728644646416024*^9, 3.728644678823926*^9}, {3.728644710342885*^9, 
   3.7286447213590803`*^9}, {3.7286447596421924`*^9, 3.728644801659971*^9}, {
   3.7286448449120893`*^9, 3.728644993532254*^9}, {3.7286450239400177`*^9, 
   3.7286450576292343`*^9}, {3.7286453325382695`*^9, 3.728645333053902*^9}, {
   3.7286529602619476`*^9, 3.7286529653569117`*^9}, {3.7401451219152703`*^9, 
   3.7401451267752495`*^9}, {3.740145403627776*^9, 3.7401454565104513`*^9}, {
   3.740145492078643*^9, 3.7401455014710474`*^9}, {3.748530227253521*^9, 
   3.748530267651997*^9}}],

Cell[TextData[{
 "Using the function CompleteModelLast, we can run simulations for a large \
set of parameters, and create the bifurcation diagrams for the ",
 StyleBox["figures 3A-B ",
  FontWeight->"Bold"],
 "(blue and orange lines)",
 StyleBox[" and 5 ",
  FontWeight->"Bold"],
 "(and S3, S7, S13 upper part, S14). Namely, we choose tm large and compute \
CompleteModelLast (i.e. the equilibrium) repetitively for different values of \
the intrinsic rate of increase in niche 1, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["r", "1"], TraditionalForm]]],
 " (to obtain a bifurcation diagram as a function of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["r", "1"], ")"}], TraditionalForm]]],
 ". The initial population size in niche 1, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["N", "1"], "(", "0", ")"}], TraditionalForm]]],
 ", is being varied, too (because of sensitivity to initial conditions of the \
population size), while selection, migration, carrying capacity and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["r", "2"], TraditionalForm]]],
 " are fixed throughout one simulation. Every equilibrium is saved in a list \
(which can then be plotted).\nE.g. for",
 StyleBox[" Fig. 3A, B",
  FontWeight->"Bold"],
 " (blue, orange):",
 StyleBox["      ",
  FontWeight->"Bold"],
 "(",
 StyleBox["Fig. 5",
  FontWeight->"Bold"],
 " and the SI-figures are generated with the same code but different \
parameters)"
}], "Text",
 CellChangeTimes->{{3.740227996122447*^9, 3.7402281022814426`*^9}, {
   3.7402283927754307`*^9, 3.740228497527845*^9}, {3.740228606428252*^9, 
   3.740228740001765*^9}, {3.7402294939516215`*^9, 3.740229595655868*^9}, {
   3.740230943439977*^9, 3.740231032423983*^9}, {3.740231182831386*^9, 
   3.7402311956615562`*^9}, {3.740231227541111*^9, 3.740231501878913*^9}, {
   3.7402316648180428`*^9, 3.74023167247776*^9}, {3.7402423435257215`*^9, 
   3.74024234419774*^9}, {3.740242489318199*^9, 3.740242505899347*^9}, {
   3.7402425600334415`*^9, 3.7402426336273518`*^9}, {3.7402427044681835`*^9, 
   3.740242707859562*^9}, {3.7402427554772577`*^9, 3.7402427683542695`*^9}, {
   3.7402428223358746`*^9, 3.740242907303879*^9}, {3.74024303406513*^9, 
   3.7402431217992887`*^9}, {3.7402431705478506`*^9, 
   3.7402432275588293`*^9}, {3.740243507233813*^9, 3.740243594972644*^9}, {
   3.7402436250874224`*^9, 3.7402436921799164`*^9}, {3.7485303446211243`*^9, 
   3.74853036293023*^9}, {3.7485304028719597`*^9, 3.7485304163646584`*^9}, {
   3.748530468314266*^9, 3.7485305573495617`*^9}, {3.7485307681932497`*^9, 
   3.748530805339161*^9}, {3.748530872145728*^9, 3.748530881631034*^9}, {
   3.7485309465797224`*^9, 3.7485309572326417`*^9}, {3.7485354094687076`*^9, 
   3.7485354137992744`*^9}, {3.7486066466674223`*^9, 
   3.7486066828448076`*^9}, {3.748607303305127*^9, 3.748607312680477*^9}, {
   3.7605218871946363`*^9, 3.7605219031064634`*^9}, 3.760522037870102*^9, {
   3.7605220715233994`*^9, 3.760522105191157*^9}, {3.7605223204575043`*^9, 
   3.760522322443035*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Fixed", " ", 
    RowBox[{"parameters", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"m12", "=", "0.05"}], ";", " ", 
    RowBox[{"m21", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s1", "=", "0.1"}], ";", " ", 
    RowBox[{"s2", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"K1", "=", "1000"}], ";", " ", 
    RowBox[{"K2", "=", "K1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r2", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p1", "=", "0.1"}], ";", " ", 
    RowBox[{"p2", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tm", "=", 
     SuperscriptBox["2", "10"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Simulations", " ", "for", " ", "a", " ", "large", " ", "range", " ", 
      "of", " ", "growth", " ", "rates", " ", "and", " ", "initial", " ", 
      "conditions", " ", "in", " ", "population", " ", 
      RowBox[{"size", ":", " ", 
       RowBox[{
        SubscriptBox["r", "1"], " ", "between", " ", "0.1", " ", "to", " ", 
        "5.2"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"and", " ", 
       SubscriptBox["N", "1"], 
       RowBox[{"(", "0", ")"}], " ", "between", " ", "5", " ", "and", " ", 
       "50"}], ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s01m005Longterm", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"r1", ",", "r1", ",", "r1", ",", " ", "r1"}], "}"}], 
              ",", 
              RowBox[{"CompleteModelLast", "[", 
               RowBox[{
               "s1", ",", "s2", ",", "m12", ",", "m21", ",", "p1", ",", "p2", 
                ",", "N1", ",", "N2", ",", "K1", ",", "K2", ",", "r1", ",", 
                "r2", ",", 
                RowBox[{"tm", "+", 
                 RowBox[{"RandomInteger", "[", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "10"}], "}"}], "]"}]}]}], "]"}]}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"r1", ",", "0.01", ",", "5.2", ",", "0.0003"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"N1", ",", 
            RowBox[{"Round", "[", 
             RowBox[{"c1", " ", 
              RowBox[{"kk", "/", "10"}]}], "]"}], ",", 
            RowBox[{"Round", "[", 
             RowBox[{"c1", " ", "kk"}], "]"}], ",", "5"}], "}"}]}], "]"}], 
        ",", "1"}], "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.740232931638814*^9, 3.7402329407845106`*^9}, {
   3.7402330742375164`*^9, 3.740233092137112*^9}, {3.7402331477944045`*^9, 
   3.740233248645594*^9}, {3.740233313020022*^9, 3.7402333178369055`*^9}, {
   3.740233409961315*^9, 3.7402334398614516`*^9}, {3.7402337901603966`*^9, 
   3.7402338240122013`*^9}, {3.740234331272463*^9, 3.7402343314755735`*^9}, {
   3.740242032353306*^9, 3.740242105370489*^9}, {3.740242157567157*^9, 
   3.740242164318327*^9}, {3.7402423136925573`*^9, 3.740242355027506*^9}, {
   3.7402426786201763`*^9, 3.740242682948909*^9}, {3.748530998244167*^9, 
   3.748531008230427*^9}, 3.7485310490857005`*^9, 3.748535422004939*^9, 
   3.7605236895688453`*^9, {3.761918638383628*^9, 3.76191869473418*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Plot", " ", 
     RowBox[{"Fig", ".", " ", "3"}], "A"}], ",", " ", 
    RowBox[{"B", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                "/", "K1"}]}], "}"}], "&"}], "/@", 
            RowBox[{
            "s01m005Longterm", "\[LeftDoubleBracket]", "3", 
             "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "5"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "4"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "0.003", "]"}], ",", 
              RowBox[{"Darker", "[", "Blue", "]"}]}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   "+", "1"}], ")"}], "/", "K2"}]}], "}"}], "&"}], "/@", 
            RowBox[{
            "s01m005Longterm", "\[LeftDoubleBracket]", "4", 
             "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "0.003", "]"}], ",", 
              RowBox[{"Lighter", "[", "Orange", "]"}]}], "}"}]}]}], "]"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
           "s01m005Longterm", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "5"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.001"}], ",", "1.05"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "0.003", "]"}], ",", 
              RowBox[{"Darker", "[", "Blue", "]"}]}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
           "s01m005Longterm", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "0.003", "]"}], ",", 
              RowBox[{"Lighter", "[", "Orange", "]"}]}], "}"}]}]}], "]"}]}], 
        "]"}]}], "}"}], "}"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "900"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7402335200897408`*^9, 3.7402336298419533`*^9}, {
   3.740233675281658*^9, 3.7402337064524484`*^9}, 3.740233920074185*^9, {
   3.7402340120646935`*^9, 3.740234082448171*^9}, {3.740234150051633*^9, 
   3.7402342060636787`*^9}, 3.7402342901256113`*^9, {3.740242360950674*^9, 
   3.740242378531345*^9}, {3.7485310665357437`*^9, 3.748531072071454*^9}, {
   3.7485326274623985`*^9, 3.748532701253934*^9}, 3.7485327371297474`*^9, {
   3.748532793514892*^9, 3.7485327965472813`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Imposed fluctuations", "Section",
 CellChangeTimes->{{3.740145282432394*^9, 3.740145343004999*^9}, {
  3.748606138876979*^9, 3.7486061399550247`*^9}}],

Cell[CellGroupData[{

Cell["Simulations", "Subsection",
 CellChangeTimes->{{3.740145583554201*^9, 3.740145585398309*^9}}],

Cell["\<\
Here, we compute the population sizes differently:
Population density in niche 1 fluctuates between K1 + D1 and K1 - D1, \
population size in niche 2 is fixed to N2.\
\>", "Text",
 CellChangeTimes->{{3.740310807837838*^9, 3.7403108875072002`*^9}, {
  3.7403109465203996`*^9, 3.7403110343497705`*^9}, {3.740311171312521*^9, 
  3.740311195753373*^9}, {3.7403112999943743`*^9, 3.7403113035259757`*^9}, {
  3.7485361546183662`*^9, 3.74853615819326*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"s1", "=."}], ";", 
  RowBox[{"s2", "=."}], ";", 
  RowBox[{"m12", "=."}], ";", 
  RowBox[{"m21", "=."}], ";", 
  RowBox[{"p1", "=."}], ";", 
  RowBox[{"p2", "=."}], ";", 
  RowBox[{"K1", "=."}], ";", 
  RowBox[{"D1", "=."}], ";", 
  RowBox[{"N2", "=."}], ";", 
  RowBox[{"tm", "=."}], ";"}]], "Input",
 CellChangeTimes->{3.748536170789968*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ImposedModel", "[", 
   RowBox[{
   "s1_", ",", "s2_", ",", "m12_", ",", "m21_", ",", "p1_", ",", "p2_", ",", 
    "K1_", " ", ",", "D1_", ",", "N2_", ",", "tm_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"w1A", "=", "1"}], ",", 
      RowBox[{"w1a", "=", 
       RowBox[{"1", "-", "s1"}]}], ",", 
      RowBox[{"w2A", "=", 
       RowBox[{"1", "-", "s2"}]}], ",", 
      RowBox[{"w2a", "=", "1"}]}], "}"}], ",", 
    RowBox[{"NestList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m12"}], ")"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{"m21", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "N2"}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m12"}], ")"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{"m21", " ", "N2"}]}]], "*", 
          RowBox[{"(", 
           RowBox[{"w1A", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "N2"}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m21", " ", "N2"}]}], ")"}]}], ")"}], "*", "w1A"}],
               "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "N2"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", " ", "N2"}]}], ")"}]}]}], ")"}], "*", 
               "w1a"}]}], ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m21"}], ")"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "N2"}], "+", 
            RowBox[{"m12", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m21"}], ")"}], "N2"}], "+", 
            RowBox[{"m12", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}]],
           "*", 
          RowBox[{"(", 
           RowBox[{"w2A", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "N2"}], "+", 
                   RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], "N2"}], "+", 
                   RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}], ")"}], "*", 
               "w2A"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "N2"}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], "N2"}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}]}], ")"}], "*", 
               "w2a"}]}], ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]], " ",
            "2", "D1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}],
           "+", "1"}]}], "}"}], " ", "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2", ",", 
        RowBox[{"K1", "+", "D1"}], ",", "1"}], "}"}], ",", "tm"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.740310571014292*^9, 3.740310679344697*^9}, {
   3.740310736685593*^9, 3.740310756720042*^9}, {3.7403113064955497`*^9, 
   3.7403113200289135`*^9}, {3.7403120416092386`*^9, 
   3.7403120786461415`*^9}, {3.7403222278966594`*^9, 3.740322253214445*^9}, 
   3.740322390275234*^9, {3.740322557103999*^9, 3.740322559200736*^9}, {
   3.7403232349526606`*^9, 3.7403232389848385`*^9}, {3.7485361740169296`*^9, 
   3.7485361898083673`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ImposedModelLast", "[", 
   RowBox[{
   "s1_", ",", "s2_", ",", "m12_", ",", "m21_", ",", "p1_", ",", "p2_", ",", 
    "K1_", " ", ",", "D1_", ",", "N2_", ",", "tm_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"w1A", "=", "1"}], ",", 
      RowBox[{"w1a", "=", 
       RowBox[{"1", "-", "s1"}]}], ",", 
      RowBox[{"w2A", "=", 
       RowBox[{"1", "-", "s2"}]}], ",", 
      RowBox[{"w2a", "=", "1"}]}], "}"}], ",", 
    RowBox[{"Nest", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m12"}], ")"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{"m21", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "N2"}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m12"}], ")"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{"m21", " ", "N2"}]}]], "*", 
          RowBox[{"(", 
           RowBox[{"w1A", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "N2"}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m21", " ", "N2"}]}], ")"}]}], ")"}], "*", "w1A"}],
               "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "N2"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", " ", "N2"}]}], ")"}]}]}], ")"}], "*", 
               "w1a"}]}], ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m21"}], ")"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "N2"}], "+", 
            RowBox[{"m12", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m21"}], ")"}], "N2"}], "+", 
            RowBox[{"m12", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}]],
           "*", 
          RowBox[{"(", 
           RowBox[{"w2A", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "N2"}], "+", 
                   RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], "N2"}], "+", 
                   RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}], ")"}], "*", 
               "w2A"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "N2"}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], "N2"}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}]}], ")"}], "*", 
               "w2a"}]}], ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]], " ",
            "2", "D1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}],
           "+", "1"}]}], "}"}], " ", "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2", ",", 
        RowBox[{"K1", "+", "D1"}], ",", "1"}], "}"}], ",", "tm"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7485362102807903`*^9, 3.748536221433649*^9}}],

Cell["\<\
The simulations for the branching diagrams are now easier than they were \
before. It suffices to run the computations for increasing values of the \
fluctuation size D1.\
\>", "Text",
 CellChangeTimes->{
  3.74031099728038*^9, 3.7403111930809937`*^9, {3.740311229540433*^9, 
   3.7403112917897425`*^9}, {3.7403113250607653`*^9, 3.740311325904949*^9}, {
   3.740320274586294*^9, 3.740320283072338*^9}, {3.7486067687509556`*^9, 
   3.7486067814102774`*^9}}],

Cell[TextData[{
 StyleBox["Fig. 3C, D",
  FontWeight->"Bold"],
 " (blue, orange):"
}], "Text",
 CellChangeTimes->{{3.7403109179838667`*^9, 3.740310920359729*^9}, {
  3.748535384729521*^9, 3.748535388775155*^9}, {3.7605221582543287`*^9, 
  3.760522166974121*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=", "0.1"}], ";", " ", 
  RowBox[{"s2", "=", "0.1"}], ";", " ", 
  RowBox[{"m", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p1", "=", "0.5"}], ";", " ", 
  RowBox[{"p2", "=", "0.5"}], ";", " ", 
  RowBox[{"K1", "=", "1000"}], ";", " ", 
  RowBox[{"N2", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D1", "=."}], ";", " ", 
   RowBox[{"tm", "=", "500"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s01m005LongtermImposed", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"D1", ",", "D1", ",", "D1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ImposedModelLast", "[", 
              RowBox[{
              "s1", ",", "s2", ",", "m", ",", "m", ",", "p1", ",", "p2", ",", 
               "K1", " ", ",", "D1", ",", "N2", ",", 
               RowBox[{"tm", "+", 
                RowBox[{"RandomInteger", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            RowBox[{
             RowBox[{"ImposedModelLast", "[", 
              RowBox[{
              "s1", ",", "s2", ",", "m", ",", "m", ",", "p1", ",", "p2", ",", 
               "K1", " ", ",", "D1", ",", "N2", ",", 
               RowBox[{"tm", "+", 
                RowBox[{"RandomInteger", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], "]"}], 
             "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            RowBox[{
             RowBox[{"ImposedModelLast", "[", 
              RowBox[{
              "s1", ",", "s2", ",", "m", ",", "m", ",", "p1", ",", "p2", ",", 
               "K1", " ", ",", "D1", ",", "N2", ",", 
               RowBox[{"tm", "+", 
                RowBox[{"RandomInteger", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], "]"}], 
             "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
           "}"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"D1", ",", "1", ",", "K1", ",", "1"}], "}"}]}], "]"}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.7403111215704317`*^9, 3.740311128196661*^9}, {
  3.7403113306867924`*^9, 3.7403114142796917`*^9}, {3.740311477732552*^9, 
  3.7403114853284907`*^9}, {3.7485355735035715`*^9, 3.748535576028101*^9}, {
  3.748536240867738*^9, 3.7485362568541603`*^9}}],

Cell[BoxData[
 RowBox[{"GraphicsGrid", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "s01m005LongtermImposed", "\[LeftDoubleBracket]", "3", 
            "\[RightDoubleBracket]"}], "/", "N1"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.005", "]"}], ",", 
             RowBox[{"Darker", "[", "Blue", "]"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"N2", "/", "N2"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
             RowBox[{"Lighter", "[", "Orange", "]"}]}], "}"}]}]}], "]"}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "/", "N1"}], ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             "}"}], "&"}], "/@", 
           RowBox[{
           "s01m005LongtermImposed", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", " ", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.005", "]"}], ",", 
             RowBox[{"Darker", "[", "Blue", "]"}]}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "/", "N1"}], ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             "}"}], "&"}], "/@", 
           RowBox[{
           "s01m005LongtermImposed", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], ",", " ", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.005", "]"}], ",", 
             RowBox[{"Lighter", "[", "Orange", "]"}]}], "}"}]}]}], "]"}]}], 
       "]"}]}], "}"}], "}"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7485356916431255`*^9, 3.7485357396810713`*^9}, {
  3.748535776452076*^9, 3.748535827634198*^9}, {3.7485358647666273`*^9, 
  3.748535873913644*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["(Mean) backward migration rates", "Section",
 CellChangeTimes->{{3.740145261881398*^9, 3.740145269194948*^9}, {
  3.7605222461338477`*^9, 3.7605222554058146`*^9}}],

Cell[CellGroupData[{

Cell["Ricker Model", "Subsection",
 CellChangeTimes->{{3.7605239517907934`*^9, 3.7605239546783123`*^9}}],

Cell["\<\
To compute the average backward migration over the generations tm1 to tm2, we \
need two functions. First, \[OpenCurlyDoubleQuote]FirstPartNest\
\[CloseCurlyDoubleQuote] does the same as \
\[OpenCurlyDoubleQuote]CompleteModelLast\[CloseCurlyDoubleQuote] (see above): \
it calculates allele frequencies and population densities after tm1 \
generations (saves only the last). Next, \
\[OpenCurlyDoubleQuote]SecondPartNestList\[CloseCurlyDoubleQuote] computes \
the allele frequencies, population densities and - importantly - backward \
migration rates up to generation tm2 (and saves the whole list). When we \
apply \[OpenCurlyDoubleQuote]SecondPartNestList\[CloseCurlyDoubleQuote] to \
the result of \[OpenCurlyDoubleQuote]FirstPartNest\[CloseCurlyDoubleQuote] we \
obtain a list of all allele frequencies, population densities and backward \
migration rates from generation tm1 up to generation tm1 + tm2.\
\>", "Text",
 CellChangeTimes->{{3.7605240769953623`*^9, 3.7605243472161746`*^9}, {
  3.7605244649112854`*^9, 3.7605244656399755`*^9}, {3.760524835891207*^9, 
  3.760524841790262*^9}, {3.761918917031681*^9, 3.7619189386579046`*^9}, {
  3.761919006405735*^9, 3.761919102300642*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"s1", "=."}], ";", 
   RowBox[{"s2", "=."}], ";", 
   RowBox[{"m12", "=."}], ";", " ", 
   RowBox[{"m21", "=."}], ";", 
   RowBox[{"p1", "=."}], ";", 
   RowBox[{"p2", "=."}], ";", 
   RowBox[{"N1", "=."}], ";", 
   RowBox[{"N2", "=."}], ";", 
   RowBox[{"K1", "=."}], ";", " ", 
   RowBox[{"K2", "=."}], ";", 
   RowBox[{"r1", "=."}], ";", 
   RowBox[{"r2", "=."}], ";", 
   RowBox[{"tm", "=."}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FirstPartNest", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tm", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"s1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"s2", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m12", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m21", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"K1", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"K2", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r2", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p2", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"N1", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"N2", ",", "_Integer"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"w1A", "=", "1"}], ",", 
          RowBox[{"w1a", "=", 
           RowBox[{"1", "-", "s1"}]}], ",", 
          RowBox[{"w2A", "=", 
           RowBox[{"1", "-", "s2"}]}], ",", 
          RowBox[{"w2a", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Nest", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m12"}], ")"}], 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{"m21", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "4", 
                  "\[RightDoubleBracket]"}]}]}], 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m12"}], ")"}], 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{"m21", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "4", 
                  "\[RightDoubleBracket]"}]}]}]], "*", 
              RowBox[{"(", 
               RowBox[{"w1A", "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}]], "*", "w1A"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}]]}], ")"}], "*", "w1a"}]}], 
                 ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m21"}], ")"}], 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "4", 
                  "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{"m12", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}]}]}], 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m21"}], ")"}], 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "4", 
                  "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{"m12", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}]}]}]], "*", 
              RowBox[{"(", 
               RowBox[{"w2A", "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]], "*", "w2A"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]]}], ")"}], "*", "w2a"}]}], 
                 ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m12"}], ")"}], 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{"m21", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "4", 
                  "\[RightDoubleBracket]"}]}]}], ")"}], 
              RowBox[{"Exp", "[", " ", 
               RowBox[{"r1", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], "K1"]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}]], "*", "w1A"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}]]}], ")"}], "*", "w1a"}]}], 
                 ")"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m21"}], ")"}], 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "4", 
                  "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{"m12", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}]}]}], ")"}], " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"r2", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], "K2"]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]], "*", "w2A"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]]}], ")"}], "*", "w2a"}]}], 
                 ")"}]}], "]"}]}]}], "}"}], " ", "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"p1", ",", "p2", ",", "N1", ",", "N2"}], "}"}], ",", 
          "tm"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SecondPartNestList", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tm", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s1", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s2", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m12", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m21", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"K1", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"K2", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"r1", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"r2", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p2", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"N1", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"N2", ",", "_Real"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"w1A", "=", "1"}], ",", 
         RowBox[{"w1a", "=", 
          RowBox[{"1", "-", "s1"}]}], ",", 
         RowBox[{"w2A", "=", 
          RowBox[{"1", "-", "s2"}]}], ",", 
         RowBox[{"w2a", "=", "1"}], ",", 
         RowBox[{"m1", "=", 
          FractionBox[
           RowBox[{"1", "-", "m12"}], "m21"]}], ",", 
         RowBox[{"m2", "=", 
          FractionBox["m12", 
           RowBox[{"1", "-", "m21"}]]}], ",", 
         RowBox[{"D1", "=", 
          RowBox[{"Abs", "[", 
           RowBox[{"N1", "-", "K1"}], "]"}]}], ",", 
         RowBox[{"M1", "=", 
          FractionBox["1", 
           RowBox[{"1", "+", 
            RowBox[{
             FractionBox[
              RowBox[{"1", "-", "m12"}], "m21"], "*", 
             FractionBox["N1", "N2"]}]}]]}], ",", 
         RowBox[{"M2", "=", 
          FractionBox[
           RowBox[{
            FractionBox["m12", 
             RowBox[{"1", "-", "m21"}]], "*", 
            FractionBox["N1", "N2"]}], 
           RowBox[{"1", "+", 
            RowBox[{
             FractionBox["m12", 
              RowBox[{"1", "-", "m21"}]], "*", 
             FractionBox["N1", "N2"]}]}]]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"NestList", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m12"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m21", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", 
                 "\[RightDoubleBracket]"}]}]}], 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m12"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m21", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", 
                 "\[RightDoubleBracket]"}]}]}]], "*", 
             RowBox[{"(", 
              RowBox[{"w1A", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}]], "*", "w1A"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}]]}], ")"}], "*", "w1a"}]}], 
                ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m21"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m12", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}]}], 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m21"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m12", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}]}]], "*", 
             RowBox[{"(", 
              RowBox[{"w2A", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]], "*", "w2A"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]]}], ")"}], "*", "w2a"}]}], 
                ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m12"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m21", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", 
                 "\[RightDoubleBracket]"}]}]}], ")"}], 
             RowBox[{"Exp", "[", " ", 
              RowBox[{"r1", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], "K1"]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}]], "*", "w1A"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}]]}], ")"}], "*", "w1a"}]}], 
                ")"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m21"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m12", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}]}], ")"}], " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"r2", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], "K2"]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]], "*", "w2A"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]]}], ")"}], "*", "w2a"}]}], 
                ")"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            FractionBox["1", 
             RowBox[{"1", "+", 
              RowBox[{"m1", "*", 
               FractionBox[
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", 
                 "\[RightDoubleBracket]"}]]}]}]], ",", 
            FractionBox[
             RowBox[{"m2", "*", 
              FractionBox[
               RowBox[{
               "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]]}], 
             RowBox[{"1", "+", 
              RowBox[{"m2", "*", 
               FractionBox[
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", 
                 "\[RightDoubleBracket]"}]]}]}]], ",", 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              "-", "K1"}], "]"}]}], "}"}], " ", "&"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "p1", ",", "p2", ",", "N1", ",", "N2", ",", "M1", ",", "M2", ",", 
           "D1"}], "}"}], ",", "tm"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.7395906758412375`*^9, {3.7395907535601254`*^9, 3.739590754606947*^9}, {
   3.7540341082302065`*^9, 3.754034182262243*^9}, 3.7540342251926394`*^9, {
   3.754034279866971*^9, 3.754034291494175*^9}, {3.75403437634054*^9, 
   3.7540343979384203`*^9}, {3.754034465685337*^9, 3.7540345612388153`*^9}, {
   3.754034626144186*^9, 3.754034693264222*^9}, {3.754034737491291*^9, 
   3.754034764996891*^9}, {3.7540348491535892`*^9, 3.7540348581547704`*^9}, {
   3.7540349965949154`*^9, 3.7540349984703646`*^9}, {3.7540350730694003`*^9, 
   3.7540351109979477`*^9}, {3.7540440703869405`*^9, 3.754044073028144*^9}, {
   3.7540441186947656`*^9, 3.7540441434058847`*^9}, {3.7540443415948205`*^9, 
   3.754044379372037*^9}, {3.7540444116947155`*^9, 3.754044568700226*^9}, {
   3.7540448945461364`*^9, 3.7540448982658167`*^9}, {3.760524019336349*^9, 
   3.7605240346518707`*^9}}],

Cell["\<\
\[OpenCurlyDoubleQuote]MeanBackwardMigration1\[CloseCurlyDoubleQuote] gives \
the average of all backward migration rates to niche 1 over generations tm1 \
to tm2 (\[OpenCurlyDoubleQuote]MeanBackwardMigration2\[CloseCurlyDoubleQuote] \
does the same for the backward migration rates to niche 2):\
\>", "Text",
 CellChangeTimes->{{3.7605244875402193`*^9, 3.760524577914791*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MeanBackwardMigration1", "[", 
    RowBox[{
    "tm1_", ",", "tm2_", ",", "s1_", ",", "s2_", ",", "m12_", ",", "m21_", 
     ",", "K1_", ",", "K2_", ",", "r1_", ",", "r2_", ",", "p1_", ",", "p2_", 
     ",", "N1_", ",", "N2_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Mean", "[", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"SecondPartNestList", "[", 
        RowBox[{
        "tm2", ",", "s1", ",", "s2", ",", "m12", ",", "m21", ",", "K1", ",", 
         "K2", ",", "r1", ",", "r2", ",", 
         RowBox[{
          RowBox[{"FirstPartNest", "[", 
           RowBox[{
           "tm1", ",", "s1", ",", "s2", ",", "m12", ",", "m21", ",", "K1", 
            ",", "K2", ",", "r1", ",", "r2", ",", "p1", ",", "p2", ",", "N1", 
            ",", "N2"}], "]"}], "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FirstPartNest", "[", 
           RowBox[{
           "tm1", ",", "s1", ",", "s2", ",", "m12", ",", "m21", ",", "K1", 
            ",", "K2", ",", "r1", ",", "r2", ",", "p1", ",", "p2", ",", "N1", 
            ",", "N2"}], "]"}], "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{
          RowBox[{"FirstPartNest", "[", 
           RowBox[{
           "tm1", ",", "s1", ",", "s2", ",", "m12", ",", "m21", ",", "K1", 
            ",", "K2", ",", "r1", ",", "r2", ",", "p1", ",", "p2", ",", "N1", 
            ",", "N2"}], "]"}], "\[LeftDoubleBracket]", "3", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{
          RowBox[{"FirstPartNest", "[", 
           RowBox[{
           "tm1", ",", "s1", ",", "s2", ",", "m12", ",", "m21", ",", "K1", 
            ",", "K2", ",", "r1", ",", "r2", ",", "p1", ",", "p2", ",", "N1", 
            ",", "N2"}], "]"}], "\[LeftDoubleBracket]", "4", 
          "\[RightDoubleBracket]"}]}], "]"}], ",", "1"}], "]"}], 
     "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "5"}], "\[RightDoubleBracket]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MeanBackwardMigration2", "[", 
   RowBox[{
   "tm1_", ",", "tm2_", ",", "s1_", ",", "s2_", ",", "m12_", ",", "m21_", ",",
     "K1_", ",", "K2_", ",", "r1_", ",", "r2_", ",", "p1_", ",", "p2_", ",", 
    "N1_", ",", "N2_"}], "]"}], ":=", 
  RowBox[{"Mean", "[", 
   RowBox[{
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{"SecondPartNestList", "[", 
       RowBox[{
       "tm2", ",", "s1", ",", "s2", ",", "m12", ",", "m21", ",", "K1", ",", 
        "K2", ",", "r1", ",", "r2", ",", 
        RowBox[{
         RowBox[{"FirstPartNest", "[", 
          RowBox[{
          "tm1", ",", "s1", ",", "s2", ",", "m12", ",", "m21", ",", "K1", ",",
            "K2", ",", "r1", ",", "r2", ",", "p1", ",", "p2", ",", "N1", ",", 
           "N2"}], "]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FirstPartNest", "[", 
          RowBox[{
          "tm1", ",", "s1", ",", "s2", ",", "m12", ",", "m21", ",", "K1", ",",
            "K2", ",", "r1", ",", "r2", ",", "p1", ",", "p2", ",", "N1", ",", 
           "N2"}], "]"}], "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
         RowBox[{"FirstPartNest", "[", 
          RowBox[{
          "tm1", ",", "s1", ",", "s2", ",", "m12", ",", "m21", ",", "K1", ",",
            "K2", ",", "r1", ",", "r2", ",", "p1", ",", "p2", ",", "N1", ",", 
           "N2"}], "]"}], "\[LeftDoubleBracket]", "3", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
         RowBox[{"FirstPartNest", "[", 
          RowBox[{
          "tm1", ",", "s1", ",", "s2", ",", "m12", ",", "m21", ",", "K1", ",",
            "K2", ",", "r1", ",", "r2", ",", "p1", ",", "p2", ",", "N1", ",", 
           "N2"}], "]"}], "\[LeftDoubleBracket]", "4", 
         "\[RightDoubleBracket]"}]}], "]"}], ",", "1"}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "6"}], "\[RightDoubleBracket]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.754046586392708*^9, 3.7540467261642027`*^9}, {
   3.7540468022923326`*^9, 3.7540469933068666`*^9}, {3.7605244341111345`*^9, 
   3.760524434862338*^9}, 3.7605245927466736`*^9}],

Cell["\<\

Now, when we run simulations for many different initial conditions, we obtain \
the mean backward migration as a function of the intrinsic rate of increase \
r1 (Fig. 4B, dark blue and dark orange):\
\>", "Text",
 CellChangeTimes->{{3.7605246340647182`*^9, 3.760524712994805*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tm1", "=", "1000"}], ";", " ", 
  RowBox[{"tm2", "=", "300"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", "0.1"}], ";", 
  RowBox[{"s2", "=", "s1"}], ";", 
  RowBox[{"m12", "=", "0.05"}], ";", 
  RowBox[{"m21", "=", "m12"}], ";", 
  RowBox[{"K1", "=", "1000"}], ";", 
  RowBox[{"K2", "=", "K1"}], ";", 
  RowBox[{"r1", "=."}], ";", 
  RowBox[{"r2", "=", "1"}], ";", " ", 
  RowBox[{"rmax", "=", "4.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p1", "=", "0.5"}], ";", 
   RowBox[{"p2", "=", "0.5"}], ";", 
   RowBox[{"N1", "=."}], ";", 
   RowBox[{"N2", "=", "10"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MBMRicker", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"r1", ",", "r1"}], "}"}], ",", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"MeanBackwardMigration1", "[", 
               RowBox[{
               "tm1", ",", "tm2", ",", "s1", ",", "s2", ",", "m12", ",", 
                "m21", ",", "K1", ",", "K2", ",", "r1", ",", "r2", ",", "p1", 
                ",", "p2", ",", "N1", ",", "N2"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"MeanBackwardMigration2", "[", 
               RowBox[{
               "tm1", ",", "tm2", ",", "s1", ",", "s2", ",", "m12", ",", 
                "m21", ",", "K1", ",", "K2", ",", "r1", ",", "r2", ",", "p1", 
                ",", "p2", ",", "N1", ",", "N2"}], "]"}]}], "}"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"r1", ",", "0.01", ",", "rmax", ",", "0.01"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"N1", ",", 
          RowBox[{"Round", "[", 
           RowBox[{"K1", "/", "10"}], "]"}], ",", "K1", ",", "13"}], "}"}]}], 
       "]"}], ",", "1"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.758366570412305*^9, 3.75836658886854*^9}, 
   3.7605247513212433`*^9, 3.7619216787787886`*^9, {3.7619376852385063`*^9, 
   3.7619376857229023`*^9}}],

Cell["\<\

To compute the light lines in Fig. 4B, we do not average the backward \
migration rates but run simulations for a broad range of initial conditions \
and save the corresponding backward migration rates after tm generations.
The function reads:\
\>", "Text",
 CellChangeTimes->{{3.760524904183807*^9, 3.760525055777609*^9}, {
  3.761919258363496*^9, 3.7619192927389765`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BackwardMigrationLast", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tm", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s1", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s2", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m12", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m21", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"K1", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"K2", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"r1", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"r2", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p2", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"N1", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"N2", ",", "_Real"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"w1A", "=", "1"}], ",", 
         RowBox[{"w1a", "=", 
          RowBox[{"1", "-", "s1"}]}], ",", 
         RowBox[{"w2A", "=", 
          RowBox[{"1", "-", "s2"}]}], ",", 
         RowBox[{"w2a", "=", "1"}], ",", 
         RowBox[{"m1", "=", 
          FractionBox[
           RowBox[{"1", "-", "m12"}], "m21"]}], ",", 
         RowBox[{"m2", "=", 
          FractionBox["m12", 
           RowBox[{"1", "-", "m21"}]]}], ",", 
         RowBox[{"M1", "=", 
          FractionBox["1", 
           RowBox[{"1", "+", 
            RowBox[{
             FractionBox[
              RowBox[{"1", "-", "m12"}], "m21"], "*", 
             FractionBox["N1", "N2"]}]}]]}], ",", 
         RowBox[{"M2", "=", 
          FractionBox[
           RowBox[{
            FractionBox["m12", 
             RowBox[{"1", "-", "m21"}]], "*", 
            FractionBox["N1", "N2"]}], 
           RowBox[{"1", "+", 
            RowBox[{
             FractionBox["m12", 
              RowBox[{"1", "-", "m21"}]], "*", 
             FractionBox["N1", "N2"]}]}]]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Nest", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m12"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m21", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", 
                 "\[RightDoubleBracket]"}]}]}], 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m12"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m21", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", 
                 "\[RightDoubleBracket]"}]}]}]], "*", 
             RowBox[{"(", 
              RowBox[{"w1A", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}]], "*", "w1A"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}]]}], ")"}], "*", "w1a"}]}], 
                ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m21"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m12", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}]}], 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m21"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m12", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}]}]], "*", 
             RowBox[{"(", 
              RowBox[{"w2A", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]], "*", "w2A"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]]}], ")"}], "*", "w2a"}]}], 
                ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m12"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m21", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", 
                 "\[RightDoubleBracket]"}]}]}], ")"}], 
             RowBox[{"Exp", "[", " ", 
              RowBox[{"r1", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], "K1"]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}]], "*", "w1A"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}]]}], ")"}], "*", "w1a"}]}], 
                ")"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m21"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m12", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}]}], ")"}], " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"r2", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], "K2"]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]], "*", "w2A"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]]}], ")"}], "*", "w2a"}]}], 
                ")"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            FractionBox["1", 
             RowBox[{"1", "+", 
              RowBox[{"m1", "*", 
               FractionBox[
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", 
                 "\[RightDoubleBracket]"}]]}]}]], ",", 
            FractionBox[
             RowBox[{"m2", "*", 
              FractionBox[
               RowBox[{
               "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]]}], 
             RowBox[{"1", "+", 
              RowBox[{"m2", "*", 
               FractionBox[
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", 
                 "\[RightDoubleBracket]"}]]}]}]]}], "}"}], " ", "&"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "p1", ",", "p2", ",", "N1", ",", "N2", ",", "M1", ",", "M2"}], 
          "}"}], ",", "tm"}], "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7583706086783714`*^9, 3.7583706374346056`*^9}, {
   3.7583706848070726`*^9, 3.758370701950252*^9}, 3.758371356442149*^9}],

Cell["The corresponding simulations read:", "Text",
 CellChangeTimes->{{3.760525062216976*^9, 3.7605250698329153`*^9}, {
  3.76191929657034*^9, 3.7619193107778845`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m12", "=", "0.05"}], ";", 
  RowBox[{"m21", "=", "0.05"}], ";", 
  RowBox[{"s1", "=", "0.1"}], ";", 
  RowBox[{"s2", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"K1", "=", "1000"}], ";", 
  RowBox[{"K2", "=", "K1"}], ";", 
  RowBox[{"r1", "=."}], ";", 
  RowBox[{"r2", "=", "1"}], ";", 
  RowBox[{"N1", "=."}], ";", 
  RowBox[{"N2", "=", "10"}], ";", 
  RowBox[{"p1", "=", "0.5"}], ";", 
  RowBox[{"p2", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rmax", "=", "4.5"}], ";", 
   RowBox[{"tm", "=", 
    SuperscriptBox["2", "10"]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BMs01m005", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"r1", ",", "r1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"BackwardMigrationLast", "[", 
                RowBox[{
                 RowBox[{"tm", "+", 
                  RowBox[{"RandomInteger", "[", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "10"}], "}"}], "]"}]}], ",", "s1", ",", 
                 "s2", ",", "m12", ",", "m21", ",", "K1", ",", "K2", ",", 
                 "r1", ",", "r2", ",", "p1", ",", "p2", ",", "N1", ",", 
                 "N2"}], "]"}], "\[LeftDoubleBracket]", "5", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
               RowBox[{"BackwardMigrationLast", "[", 
                RowBox[{
                 RowBox[{"tm", "+", 
                  RowBox[{"RandomInteger", "[", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "10"}], "}"}], "]"}]}], ",", "s1", ",", 
                 "s2", ",", "m12", ",", "m21", ",", "K1", ",", "K2", ",", 
                 "r1", ",", "r2", ",", "p1", ",", "p2", ",", "N1", ",", 
                 "N2"}], "]"}], "\[LeftDoubleBracket]", "6", 
               "\[RightDoubleBracket]"}]}], "}"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"r1", ",", "0.01", ",", "rmax", ",", "0.001"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"N1", ",", 
          RowBox[{"Round", "[", 
           RowBox[{"K1", "/", "10"}], "]"}], ",", "K1", ",", "13"}], "}"}]}], 
       "]"}], ",", "1"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.668247611774255*^9, 3.668247680347452*^9}, 
   3.668248009885859*^9, {3.668249842597147*^9, 3.668249842824551*^9}, {
   3.668249881908647*^9, 3.668249885994525*^9}, {3.66824995057749*^9, 
   3.668249952468*^9}, {3.668249993913989*^9, 3.668249997217602*^9}, {
   3.668250323638916*^9, 3.66825032643571*^9}, {3.668272683110195*^9, 
   3.668272685388937*^9}, {3.668318388404237*^9, 3.668318388853776*^9}, {
   3.668318453332698*^9, 3.668318465917828*^9}, {3.6683185134351273`*^9, 
   3.6683185661453753`*^9}, {3.66831867230735*^9, 3.66831868996415*^9}, {
   3.668319886411665*^9, 3.6683199308039093`*^9}, {3.668320041120126*^9, 
   3.668320041584485*^9}, {3.668320296513914*^9, 3.66832029914552*^9}, {
   3.668320676584034*^9, 3.6683206800970507`*^9}, {3.668332560168075*^9, 
   3.6683325827200813`*^9}, {3.668759885307485*^9, 3.668759887868658*^9}, {
   3.6687727396108723`*^9, 3.6687727412987022`*^9}, 3.668772881229979*^9, 
   3.6687741245052*^9, 3.668774512250002*^9, {3.668835400569859*^9, 
   3.668835403788492*^9}, {3.668835778682171*^9, 3.668835781548473*^9}, {
   3.673116353806315*^9, 3.673116423201285*^9}, {3.673116820169943*^9, 
   3.673116882362191*^9}, {3.6731171665683603`*^9, 3.673117167211566*^9}, 
   3.673117250321622*^9, 3.673117319611435*^9, {3.6731175705036182`*^9, 
   3.6731175746854563`*^9}, {3.673117809310817*^9, 3.673117822695628*^9}, 
   3.673118106787122*^9, {3.673600097323572*^9, 3.673600103666769*^9}, {
   3.6736011604887037`*^9, 3.673601163279442*^9}, {3.6736023201948147`*^9, 
   3.673602320544965*^9}, {3.673750642160931*^9, 3.673750659904001*^9}, {
   3.685870751459997*^9, 3.6858707683717623`*^9}, 3.6858711673167562`*^9, {
   3.685878563907333*^9, 3.68587860099335*^9}, {3.690032450951326*^9, 
   3.69003245304758*^9}, {3.690035489119985*^9, 3.690035518211035*^9}, {
   3.690118434969019*^9, 3.6901184616030807`*^9}, 3.690273707394239*^9, 
   3.690274087454783*^9, 3.690637876917818*^9, {3.690698093611862*^9, 
   3.690698093866952*^9}, {3.690698146060611*^9, 3.690698147460474*^9}, 
   3.6907001136001787`*^9, {3.690705357605842*^9, 3.690705360651349*^9}, {
   3.691989771228038*^9, 3.6919897725487137`*^9}, 3.692274711812112*^9, {
   3.692274853893281*^9, 3.692274854068811*^9}, 3.69227499246307*^9, 
   3.6922751122173967`*^9, 3.692275198850553*^9, {3.692276348378009*^9, 
   3.692276348625821*^9}, {3.692277747614298*^9, 3.6922777602779913`*^9}, 
   3.6923594936185093`*^9, {3.698567289366884*^9, 3.698567300197225*^9}, {
   3.698567423980288*^9, 3.698567426092099*^9}, {3.7583708563126984`*^9, 
   3.758370952597309*^9}, {3.7583710525580945`*^9, 3.7583711766913395`*^9}, {
   3.7583712158232074`*^9, 3.758371218323949*^9}, {3.7583712593461466`*^9, 
   3.7583713057294865`*^9}, {3.7583713923173075`*^9, 3.758371449046218*^9}, {
   3.7583762492169824`*^9, 3.7583762695035553`*^9}, {3.7605250815135565`*^9, 
   3.76052508190027*^9}}],

Cell[TextData[StyleBox["\nFig. 4B:",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.7605250925053387`*^9, 3.7605251050708747`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{
      "BMs01m005", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PointSize", "[", "0.0035", "]"}], ",", 
         RowBox[{"Blend", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Lighter", "[", "Orange", "]"}], ",", "White"}], "}"}], 
           ",", "0.7"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Intrinsic rate of increase \!\(\*SubscriptBox[\(r\), \
\(1\)]\)\>\"", ",", "\"\<Mean backward migration\>\""}], "}"}]}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", "16"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1.5", ",", "4.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0.46"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"LabelStyle", "\[Rule]", 
       RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{
      "BMs01m005", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PointSize", "[", "0.0035", "]"}], ",", 
         RowBox[{"Blend", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Darker", "[", "Blue", "]"}], ",", "White"}], "}"}], ",",
            "0.75"}], "]"}]}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{
      "MBMRicker", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PointSize", "[", "0.0048", "]"}], ",", 
         RowBox[{"Lighter", "[", "Orange", "]"}]}], "}"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{
      "MBMRicker", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PointSize", "[", "0.0048", "]"}], ",", 
         RowBox[{"Darker", "[", "Blue", "]"}]}], "}"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", 
     RowBox[{"{", 
      RowBox[{"Inset", "[", 
       RowBox[{"\"\<B\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"1.64", ",", "0.44"}], "}"}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Bold", ",", 
           RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
           RowBox[{"FontColor", "\[Rule]", " ", "Black"}]}], "}"}]}]}], "]"}],
       "}"}], "]"}]}], "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.7605250844404707`*^9, {3.7605251398374233`*^9, 3.760525156124713*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Imposed fluctuations", "Subsection",
 CellChangeTimes->{{3.7605239517907934`*^9, 3.7605239546783123`*^9}, {
  3.7605251871459503`*^9, 3.7605251942645044`*^9}}],

Cell["\<\
Plotting the (mean) backward migration rates under imposed fluctuations is \
much easier, because we have an explicit formula for it:\
\>", "Text",
 CellChangeTimes->{{3.760525215864897*^9, 3.7605252655845385`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M1MeanBackward", "[", 
   RowBox[{"m12_", ",", "m21_", ",", "K_", ",", "D_", ",", "N2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m1", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "m12"}], ")"}], "/", "m21"}]}], "}"}], ",", 
    RowBox[{
     FractionBox["1", "2"], "*", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "+", 
         RowBox[{"m1", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"K", "+", "D"}], ")"}], "/", "N2"}]}]}]], "+", 
       FractionBox["1", 
        RowBox[{"1", "+", 
         RowBox[{"m1", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"K", "-", "D"}], ")"}], "/", "N2"}]}]}]]}], ")"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M2MeanBackward", "[", 
   RowBox[{"m12_", ",", "m21_", ",", "K_", ",", "D_", ",", "N2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m2", "=", 
      RowBox[{"m12", "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", "m21"}], ")"}]}]}], "}"}], ",", 
    RowBox[{
     FractionBox["1", "2"], "*", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"m2", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"K", "+", "D"}], ")"}], "/", "N2"}]}], 
        RowBox[{"1", "+", 
         RowBox[{"m2", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"K", "+", "D"}], ")"}], "/", "N2"}]}]}]], "+", 
       FractionBox[
        RowBox[{"m2", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"K", "-", "D"}], ")"}], "/", "N2"}]}], 
        RowBox[{"1", "+", 
         RowBox[{"m2", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"K", "-", "D"}], ")"}], "/", "N2"}]}]}]]}], ")"}]}]}], 
   "]"}]}]}], "Input"],

Cell["\<\
How strong are the fluctuations in the backward migration rates? - Plot the \
light lines in Fig. 4A (assuming that niche 2 maintains a constant density N2 \
= 1, and niche 1 fluctuates around N1 = K = 1 with an amplitude of DK): \
\>", "Text",
 CellChangeTimes->{{3.7619195095861263`*^9, 3.761919510879218*^9}, {
  3.7619385693885703`*^9, 3.761938587173264*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"M1up", "[", 
    RowBox[{"m12_", ",", "m21_", ",", "DK_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m1", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "m12"}], ")"}], "/", "m21"}]}], "}"}], ",", 
     FractionBox["1", 
      RowBox[{"1", "+", 
       RowBox[{"m1", 
        RowBox[{"(", 
         RowBox[{"1", "+", "DK"}], ")"}]}]}]]}], "]"}]}], "   ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Backward", " ", "migration", " ", "to", " ", "niche", " ", "1", " ", 
     "when", " ", "the", " ", "local", " ", "population", " ", "density", " ",
      "is", " ", "low"}], " ", "-", " ", "\"\<fluctuations up\>\""}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M1down", "[", 
    RowBox[{"m12_", ",", "m21_", ",", "DK_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m1", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "m12"}], ")"}], "/", "m21"}]}], "}"}], ",", 
     FractionBox["1", 
      RowBox[{"1", "+", 
       RowBox[{"m1", 
        RowBox[{"(", 
         RowBox[{"1", "-", "DK"}], ")"}]}]}]]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M2up", "[", 
   RowBox[{"m12_", ",", "m21_", ",", "DK_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m2", "=", 
      RowBox[{"m12", "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", "m21"}], ")"}]}]}], "}"}], ",", 
    FractionBox[
     RowBox[{"m2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "DK"}], ")"}]}], 
     RowBox[{"1", "+", 
      RowBox[{"m2", 
       RowBox[{"(", 
        RowBox[{"1", "+", "DK"}], ")"}]}]}]]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M2down", "[", 
   RowBox[{"m12_", ",", "m21_", ",", "DK_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m2", "=", 
      RowBox[{"m12", "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", "m21"}], ")"}]}]}], "}"}], ",", 
    FractionBox[
     RowBox[{"m2", 
      RowBox[{"(", 
       RowBox[{"1", "-", "DK"}], ")"}]}], 
     RowBox[{"1", "+", 
      RowBox[{"m2", 
       RowBox[{"(", 
        RowBox[{"1", "-", "DK"}], ")"}]}]}]]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7573285984654107`*^9, 3.7573286328180113`*^9}, {
  3.760525406321065*^9, 3.7605254114805727`*^9}, {3.7619194704644847`*^9, 
  3.7619194855468993`*^9}, {3.7619195161019917`*^9, 3.761919578552186*^9}, {
  3.7619384711007123`*^9, 3.761938564230961*^9}}],

Cell[TextData[StyleBox["\nFig. 4A:",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.760525427639495*^9, 3.760525440685142*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m12", "=", "0.05"}], ";", 
  RowBox[{"m21", "=", "m12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"M1up", "[", 
      RowBox[{"m12", ",", "m21", ",", "DK"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"DK", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Thick", ",", 
        RowBox[{"Blend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Darker", "[", "Blue", "]"}], ",", "White"}], "}"}], ",", 
          "0.77"}], "]"}]}], "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0.975"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.37"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Relative imposed fluctuations \!\(\*SubscriptBox[\(D\), \(1\)]\)/\
\!\(\*SubscriptBox[\(K\), \(1\)]\)\>\"", ",", 
        "\"\<Mean backward migration\>\""}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", "16"}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"M1down", "[", 
      RowBox[{"m12", ",", "m21", ",", "DK"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"DK", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Thick", ",", 
        RowBox[{"Blend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Darker", "[", "Blue", "]"}], ",", "White"}], "}"}], ",", 
          "0.77"}], "]"}]}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"M2up", "[", 
      RowBox[{"m12", ",", "m21", ",", "DK"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"DK", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Thick", ",", 
        RowBox[{"Blend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Lighter", "[", "Orange", "]"}], ",", "White"}], "}"}], 
          ",", "0.67"}], "]"}]}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"M2down", "[", 
      RowBox[{"m12", ",", "m21", ",", "DK"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"DK", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Thick", ",", 
        RowBox[{"Blend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Lighter", "[", "Orange", "]"}], ",", "White"}], "}"}], 
          ",", "0.67"}], "]"}]}], "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"M2MeanBackward", "[", 
      RowBox[{"m12", ",", "m21", ",", "1", ",", "D", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"D", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Thick", ",", 
        RowBox[{"Lighter", "[", "Orange", "]"}]}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"M1MeanBackward", "[", 
      RowBox[{"m12", ",", "m21", ",", "1", ",", "D", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"D", ",", "0", ",", "1.2"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Thick", ",", 
        RowBox[{"Darker", "[", "Blue", "]"}]}], "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Inset", "[", 
      RowBox[{"\"\<A\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"0.045", ",", "0.353"}], "}"}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Bold", ",", 
          RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
          RowBox[{"FontColor", "\[Rule]", " ", "Black"}]}], "}"}]}]}], "]"}], 
     "}"}], "]"}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7605254659651403`*^9, 3.7605254912471123`*^9}, 
   3.76193791656223*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Using the mean as an approximation for the density fluctuations\
\>", "Subsection",
 CellChangeTimes->{{3.7605239517907934`*^9, 3.7605239546783123`*^9}, {
  3.7605251871459503`*^9, 3.7605251942645044`*^9}, {3.760525564336114*^9, 
  3.7605255808386765`*^9}}],

Cell["\<\
First, we need a function that computes the allele frequencies after tm \
generations in a model that is as follows:
- no ecological dynamics (evolution only)
- constant backward migration rates of mM1 and mM2

This function is called \[OpenCurlyDoubleQuote]ConstBackwardMigrationLast\
\[CloseCurlyDoubleQuote]:\
\>", "Text",
 CellChangeTimes->{{3.760526580227396*^9, 3.7605267799474163`*^9}, {
  3.761919623652193*^9, 3.761919626637134*^9}, {3.7619215613300233`*^9, 
  3.761921561488227*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=."}], ";", 
  RowBox[{"s2", "=."}], ";", 
  RowBox[{"mM1", "=."}], ";", 
  RowBox[{"mM2", "=."}], ";", 
  RowBox[{"p1", "=."}], ";", 
  RowBox[{"p2", "=."}], ";", 
  RowBox[{"tm", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConstBackwardMigrationLast", "[", 
   RowBox[{
   "s1_", ",", "s2_", ",", "mM1_", ",", "mM2_", ",", "p1_", ",", "p2_", ",", 
    "tm_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"w1A", "=", "1"}], ",", 
      RowBox[{"w1a", "=", 
       RowBox[{"1", "-", "s1"}]}], ",", 
      RowBox[{"w2A", "=", 
       RowBox[{"1", "-", "s2"}]}], ",", 
      RowBox[{"w2a", "=", "1"}]}], "}"}], ",", 
    RowBox[{"Nest", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "mM1"}], ")"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{"mM1", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
           ")"}], "*", 
          FractionBox["w1A", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "mM1"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"mM1", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}]}], ")"}], "*", "w1A"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "mM1"}], ")"}], 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "+", 
                 RowBox[{"mM1", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}]}], ")"}]}], ")"}], "*", 
             "w1a"}]}]]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"mM2", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "mM2"}], ")"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
           ")"}], "*", 
          FractionBox["w2A", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"mM2", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "mM2"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}]}], ")"}], "*", "w2A"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"mM2", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "mM2"}], ")"}], 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}]}], ")"}]}], ")"}], "*", 
             "w2a"}]}]]}]}], "}"}], " ", "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2"}], "}"}], ",", "tm"}], "]"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.753601767902158*^9, 3.753601791149621*^9}, {
  3.7566384706423793`*^9, 3.756638475772396*^9}, {3.7605267835094476`*^9, 
  3.760526784478781*^9}}],

Cell[TextData[{
 "\n\n",
 StyleBox["Approximation for equilibrium frequencies under Ricker\
\[CloseCurlyQuote]s model:",
  FontVariations->{"Underline"->True}]
}], "Text",
 CellChangeTimes->{{3.7605268752008963`*^9, 3.760526920583257*^9}}],

Cell["\<\
We use the average of the mean backward migration rates that were calculated \
above for many different initial conditions:\
\>", "Text",
 CellChangeTimes->{{3.760527102481872*^9, 3.7605271322083654`*^9}, {
  3.7619215816985903`*^9, 3.761921581894741*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MBMniche1", "=", 
    RowBox[{"Mean", "/@", " ", 
     RowBox[{"Split", "[", 
      RowBox[{
       RowBox[{
       "MBMRicker", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "#1", "]"}], "\[Equal]", 
         RowBox[{"First", "[", "#2", "]"}]}], "&"}]}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Mean", " ", "of", " ", "the", " ", "mean", " ", "backward", " ", 
     "migration", " ", "rates", " ", "to", " ", "niche", " ", "1"}], " ", "-",
     " ", 
    RowBox[{
    "one", " ", "mean", " ", "for", " ", "each", " ", "value", " ", "of", " ",
      "r1"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MBMniche2", "=", 
    RowBox[{"Mean", "/@", " ", 
     RowBox[{"Split", "[", 
      RowBox[{
       RowBox[{
       "MBMRicker", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "#1", "]"}], "\[Equal]", 
         RowBox[{"First", "[", "#2", "]"}]}], "&"}]}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Mean", " ", "of", " ", "the", " ", "mean", " ", "backward", " ", 
     "migration", " ", "rates", " ", "to", " ", "niche", " ", "2"}], " ", "-",
     " ", 
    RowBox[{
    "one", " ", "mean", " ", "for", " ", "each", " ", "value", " ", "of", " ",
      "r1"}]}], " ", "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.760526948028757*^9, 3.760526972806758*^9}, 
   3.7619216010590315`*^9}],

Cell["\<\
Simulations - calculate equilibrium allele frequencies under constant \
backward migration rates which equal these means:\
\>", "Text",
 CellChangeTimes->{{3.7605271412558784`*^9, 3.760527150001399*^9}, {
  3.761938120580968*^9, 3.7619381774087143`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=", "0.1"}], ";", 
  RowBox[{"s2", "=", "0.1"}], ";", 
  RowBox[{"m12", "=", "0.05"}], ";", 
  RowBox[{"m21", "=", "0.05"}], ";", 
  RowBox[{"p1", "=", "0.5"}], ";", 
  RowBox[{"p2", "=", "0.5"}], ";", 
  RowBox[{"tm", "=", "2500"}], ";", 
  RowBox[{"rmax", "=", "4.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MBMs01m005Ricker", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r1", ",", "r1"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ConstBackwardMigrationLast", "[", 
              RowBox[{"s1", ",", "s2", ",", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"Select", "[", 
                  RowBox[{"MBMniche1", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], "\[Equal]", "r1"}], 
                    "&"}]}], "]"}], "]"}], "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"Select", "[", 
                  RowBox[{"MBMniche2", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], "\[Equal]", "r1"}], 
                    "&"}]}], "]"}], "]"}], "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], ",", "p1", ",", "p2", ",", 
               RowBox[{"tm", "+", 
                RowBox[{"RandomInteger", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ConstBackwardMigrationLast", "[", 
              RowBox[{"s1", ",", "s2", ",", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"Select", "[", 
                  RowBox[{"MBMniche1", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], "\[Equal]", "r1"}], 
                    "&"}]}], "]"}], "]"}], "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"Select", "[", 
                  RowBox[{"MBMniche2", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], "\[Equal]", "r1"}], 
                    "&"}]}], "]"}], "]"}], "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], ",", "p1", ",", "p2", ",", 
               RowBox[{"tm", "+", 
                RowBox[{"RandomInteger", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], "]"}], 
             "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           "}"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"r1", ",", "0.01", ",", "rmax", ",", "0.01"}], "}"}]}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.760527056570501*^9, 3.7605270737300663`*^9}, 
   3.760527153034191*^9, {3.761937599388278*^9, 3.761937601669936*^9}}],

Cell["\<\
Take out some points of this list (otherwise, one does not see much on Fig. \
3B) :\
\>", "Text",
 CellChangeTimes->{{3.7605271686826572`*^9, 3.7605271812651606`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MBMs01m005Ricker", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{
        "MBMs01m005Ricker", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "MBMs01m005Ricker", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "]"}], ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{
        "MBMs01m005Ricker", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "MBMs01m005Ricker", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "]"}], ",", "3"}], "}"}]}], "]"}]}], 
     "}"}]}], ";", " ", 
   RowBox[{"MBMs01m005Ricker", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{
        "MBMs01m005Ricker", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "MBMs01m005Ricker", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "]"}], ",", "2"}], "}"}]}], "]"}], ",", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{
        "MBMs01m005Ricker", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "MBMs01m005Ricker", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "]"}], ",", "2"}], "}"}]}], "]"}]}], 
     "}"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MBMs01m005Ricker", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{
       "MBMs01m005Ricker", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{
          "MBMs01m005Ricker", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "]"}], ",", "2"}], "}"}]}], "]"}], ",", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{
       "MBMs01m005Ricker", "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{
          "MBMs01m005Ricker", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "]"}], ",", "2"}], "}"}]}], "]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MBMs01m005Ricker", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{
        "MBMs01m005Ricker", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
              "MBMs01m005Ricker", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "]"}], "/", "2"}], "]"}], "-", 
           "3"}], ",", "2"}], "}"}]}], "]"}], ",", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{
        "MBMs01m005Ricker", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "MBMs01m005Ricker", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "]"}], ",", "2"}], "}"}]}], "]"}]}], 
     "}"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MBMs01m005Ricker", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{
        "MBMs01m005Ricker", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
            "MBMs01m005Ricker", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "]"}], "-", "10"}], ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "MBMs01m005Ricker", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "]"}], ",", "2"}], "}"}]}], "]"}], ",", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{
        "MBMs01m005Ricker", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
            "MBMs01m005Ricker", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], "]"}], "-", "10"}], ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "MBMs01m005Ricker", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "]"}], ",", "2"}], "}"}]}], "]"}]}], 
     "}"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MBMs01m005Ricker", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Delete", "[", 
       RowBox[{
        RowBox[{
        "MBMs01m005Ricker", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"-", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "7"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "9"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "11"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "13"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "15"}], "}"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{
        "MBMs01m005Ricker", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"-", "5"}]}], "]"}]}], "}"}]}], ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.756647527149981*^9, 3.7566475519195423`*^9}, {
   3.75666475819345*^9, 3.7566647844198694`*^9}, {3.7566650340013866`*^9, 
   3.7566650516329327`*^9}, {3.756665568505104*^9, 3.7566655742406664`*^9}, {
   3.756665606999609*^9, 3.756665607671502*^9}, {3.756665947998069*^9, 
   3.756665983491886*^9}, {3.7566660863092227`*^9, 3.75666620170972*^9}, {
   3.75666624696702*^9, 3.7566663082912483`*^9}, {3.7566663636424246`*^9, 
   3.7566663731750355`*^9}, {3.7566664066968403`*^9, 3.756666884574966*^9}, {
   3.7566669319111185`*^9, 3.756666982924823*^9}, 3.7566670264614534`*^9, {
   3.756667664272087*^9, 3.756667684869608*^9}, {3.7566677180482254`*^9, 
   3.756667790488456*^9}, {3.756667914779089*^9, 3.7566679185296793`*^9}}],

Cell[TextData[{
 "\n",
 StyleBox["Approximation for equilibrium frequencies under imposed \
fluctuations:",
  FontVariations->{"Underline"->True}]
}], "Text",
 CellChangeTimes->{{3.760526239707858*^9, 3.7605262440371323`*^9}, {
   3.760526282684001*^9, 3.7605262879558883`*^9}, 3.7605268002951965`*^9, {
   3.7605270013505573`*^9, 3.760527009624628*^9}}],

Cell["\<\
Simulations - calculate equilibrium allele frequencies under constant \
backward migration rates which equal these means:\
\>", "Text",
 CellChangeTimes->{3.7619382320372376`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=", "0.1"}], ";", 
  RowBox[{"s2", "=", "0.1"}], ";", 
  RowBox[{"m12", "=", "0.05"}], ";", 
  RowBox[{"m21", "=", "0.05"}], ";", 
  RowBox[{"p1", "=", "0.5"}], ";", 
  RowBox[{"p2", "=", "0.5"}], ";", 
  RowBox[{"tm", "=", "2500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mM1", "[", "DK_", "]"}], ":=", 
  RowBox[{"M1MeanBackward", "[", 
   RowBox[{"m12", ",", "m21", ",", "1", ",", "D", ",", "1"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mM2", "[", "DK_", "]"}], ":=", 
   RowBox[{"M2MeanBackward", "[", 
    RowBox[{"m12", ",", "m21", ",", "1", ",", "D", ",", "1"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MBMs01m005Imposed", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"D", ",", "D"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ConstBackwardMigrationLast", "[", 
              RowBox[{"s1", ",", "s2", ",", 
               RowBox[{"mM1", "[", "D", "]"}], ",", 
               RowBox[{"mM2", "[", "D", "]"}], ",", "p1", ",", "p2", ",", 
               "tm"}], "]"}], "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
             RowBox[{"ConstBackwardMigrationLast", "[", 
              RowBox[{"s1", ",", "s2", ",", 
               RowBox[{"mM1", "[", "D", "]"}], ",", 
               RowBox[{"mM2", "[", "D", "]"}], ",", "p1", ",", "p2", ",", 
               "tm"}], "]"}], "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], "}"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"D", ",", "0", ",", "1", ",", "0.015"}], "}"}]}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.760526235333325*^9, {3.760526268260672*^9, 3.760526272133078*^9}, {
   3.760526791930273*^9, 3.7605267940721855`*^9}, {3.7619387018038282`*^9, 
   3.7619387873852353`*^9}, {3.761938883855976*^9, 3.7619388855751495`*^9}}],

Cell["\<\
Take out some points of this list (otherwise, one does not see much on Fig. \
3D):\
\>", "Text",
 CellChangeTimes->{{3.760526302899642*^9, 3.7605263609392977`*^9}, {
  3.760526804927316*^9, 3.7605268093694553`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MBMs01m005Imposed", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{
       "MBMs01m005Imposed", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "49", ",", "2"}], "}"}]}], "]"}], ",", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{
       "MBMs01m005Imposed", "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "53", ",", "2"}], "}"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MBMs01m005Imposed", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{
       "MBMs01m005Imposed", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{
           "MBMs01m005Imposed", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "]"}], "-", "7"}], ",", 
         RowBox[{"Length", "[", 
          RowBox[{
          "MBMs01m005Imposed", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "]"}], ",", "2"}], "}"}]}], "]"}], ",", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{
       "MBMs01m005Imposed", "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{
           "MBMs01m005Imposed", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "]"}], "-", "7"}], ",", 
         RowBox[{"Length", "[", 
          RowBox[{
          "MBMs01m005Imposed", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "]"}], ",", "2"}], "}"}]}], "]"}]}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7605262762220945`*^9, 3.7605262776076393`*^9}, {
  3.761938818656478*^9, 3.7619388200941615`*^9}}],

Cell[TextData[{
 "\n",
 StyleBox["Fig. 3B and D (gray dots):",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.7605272330538416`*^9, 3.760527254535676*^9}}],

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
         "s01m005Longterm", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "0.001"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameLabel", "->", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Intrinsic rate of increase \!\(\*SubscriptBox[\(r\), \(1\)]\)\
\>\"", ",", "\"\<\!\(\*
StyleBox[SubscriptBox[\"p\", \"1\"],
FontColor->RGBColor[0., 0., 0.8352941176470589]]\),  \!\(\*
StyleBox[SubscriptBox[\"p\", \"2\"],
FontColor->RGBColor[0.9607843137254902, 0.6823529411764706, \
0.0392156862745098]]\)\>\""}], "}"}]}], ",", 
         RowBox[{"FrameTicks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "\"\<0\>\""}], "}"}], ",", "0.2", ",", 
                "0.4", ",", "0.6", ",", "0.8", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "\"\<1.0\>\""}], "}"}]}], "}"}], ",", 
              "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "0", ",", "1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}],
               ",", "None"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.005", "]"}], ",", 
            RowBox[{"Darker", "[", "Blue", "]"}]}], "}"}]}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"FontSize", "\[Rule]", "16"}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
         "s01m005Longterm", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.005", "]"}], ",", 
            RowBox[{"Lighter", "[", "Orange", "]"}]}], "}"}]}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"FontSize", "\[Rule]", "16"}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
         "MBMs01m005Ricker", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.012", "]"}], ",", "Gray"}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
         "MBMs01m005Ricker", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.012", "]"}], ",", "Gray"}], 
           "}"}]}]}], "]"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "450"}]}], "]"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "/", "1000"}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "}"}], "&"}], "/@", 
          RowBox[{
          "s01m005LongtermImposed", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Relative (imposed) fluctuations \!\(\*SubscriptBox[\(D\), \(1\
\)]\) / K\>\"", ",", "\"\<\!\(\*
StyleBox[SubscriptBox[\"p\", \"1\"],
FontColor->RGBColor[0., 0., 0.8352941176470589]]\),  \!\(\*
StyleBox[SubscriptBox[\"p\", \"2\"],
FontColor->RGBColor[0.9607843137254902, 0.6823529411764706, \
0.0392156862745098]]\)\>\""}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "0.005"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"FontSize", "\[Rule]", "16"}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.005", "]"}], ",", 
            RowBox[{"Darker", "[", "Blue", "]"}]}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "/", "1000"}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "}"}], "&"}], "/@", 
          RowBox[{
          "s01m005LongtermImposed", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}], ",", " ", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.005", "]"}], ",", 
            RowBox[{"Lighter", "[", "Orange", "]"}]}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
         "MBMs01m005Imposed", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.012", "]"}], ",", "Gray"}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
         "MBMs01m005Imposed", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.012", "]"}], ",", "Gray"}], 
           "}"}]}]}], "]"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "450"}]}], "]"}], "}"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.76052731788173*^9, 3.760527393435215*^9}, {
  3.760527506362998*^9, 3.7605275112337465`*^9}, {3.760527574044572*^9, 
  3.760527665503768*^9}, {3.76052769654388*^9, 3.7605277265407395`*^9}, {
  3.761938956217826*^9, 3.7619389612814255`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Residual effect (SI)", "Subsection",
 CellChangeTimes->{{3.7605239517907934`*^9, 3.7605239546783123`*^9}, {
  3.7605251871459503`*^9, 3.7605251942645044`*^9}, {3.760525564336114*^9, 
  3.7605255808386765`*^9}, {3.7605256450551834`*^9, 3.7605256529747887`*^9}}],

Cell["\<\
To measure the effect of fluctuations in backward migration rates, we can \
impose such fluctuations around a constant mean -- and calculate the \
resulting equilibrium allele frequencies.\
\>", "Text",
 CellChangeTimes->{{3.760525802983392*^9, 3.7605258913587465`*^9}, {
  3.761938052571703*^9, 3.7619380605579567`*^9}}],

Cell["\<\
Function (model with evolution only, but imposed fluctuations D1 in backward \
migration):\
\>", "Text",
 CellChangeTimes->{{3.7605257856060457`*^9, 3.7605257872940345`*^9}, {
  3.761939038857751*^9, 3.7619391192129335`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ImpFlucBackwardMigrationLast", "[", 
    RowBox[{
    "s1_", ",", "s2_", ",", "M1_", ",", "M2_", ",", "D1_", ",", "p1_", ",", 
     "p2_", ",", "tm_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"w1A", "=", "1"}], ",", 
       RowBox[{"w1a", "=", 
        RowBox[{"1", "-", "s1"}]}], ",", 
       RowBox[{"w2A", "=", 
        RowBox[{"1", "-", "s2"}]}], ",", 
       RowBox[{"w2a", "=", "1"}]}], "}"}], ",", 
     RowBox[{"Nest", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
                ")"}], 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "+", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}],
             ")"}], "*", 
           FractionBox["w1A", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], ")"}], 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}]}], ")"}], "*", "w1A"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], ")"}], 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "+", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}], ")"}], "*", 
              "w1a"}]}]]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"M2", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "M2"}], ")"}], 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}],
             ")"}], "*", 
           FractionBox["w2A", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"M2", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "M2"}], ")"}], 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}]}], ")"}], "*", "w2A"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"M2", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "M2"}], ")"}], 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}], ")"}], "*", 
              "w2a"}]}]]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]], 
            " ", "2", "D1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], "+", 
           "1"}]}], "}"}], " ", "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "p2", ",", 
         RowBox[{"M1", "+", "D1"}], ",", "1"}], "}"}], ",", "tm"}], "]"}]}], 
    "]"}]}], ";"}]], "Input"],

Cell["Simulations:", "Text",
 CellChangeTimes->{{3.7605257439421396`*^9, 3.7605257460392275`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"s1", "=", "0.1"}], ";", 
   RowBox[{"s2", "=", "0.1"}], ";", 
   RowBox[{"p1", "=", "0.5"}], ";", 
   RowBox[{"p2", "=", "0.5"}], ";", " ", 
   RowBox[{"tm", "=", "1500"}], ";", 
   RowBox[{"M1", "=", "0.15"}], ";", " ", 
   RowBox[{"M2", "=", "M1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConstantMBMFlucBMs01m015", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"D1", ",", "D1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ImpFlucBackwardMigrationLast", "[", 
              RowBox[{
              "s1", ",", "s2", ",", "M1", ",", "M2", ",", "D1", ",", "p1", 
               ",", "p2", ",", 
               RowBox[{"tm", "+", 
                RowBox[{"RandomInteger", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            RowBox[{
             RowBox[{"ImpFlucBackwardMigrationLast", "[", 
              RowBox[{
              "s1", ",", "s2", ",", "M1", ",", "M2", ",", "D1", ",", "p1", 
               ",", "p2", ",", 
               RowBox[{"tm", "+", 
                RowBox[{"RandomInteger", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], "]"}], 
             "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           "}"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"D1", ",", "0", ",", "M1", ",", "0.0001"}], "}"}]}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.757005459215463*^9, 3.7570054678305945`*^9}, 
   3.7570056580239134`*^9, {3.760525749440047*^9, 3.760525751575734*^9}}],

Cell[TextData[StyleBox["\nFig. S6:",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.760525697438037*^9, 3.760525709303275*^9}, 
   3.7605257549801025`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"M1", "=", "0.15"}], ";", " ", 
  RowBox[{"M2", "=", "M1"}], ";", 
  RowBox[{"GraphicsGrid", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"M1", "+", "D1"}], ",", 
           RowBox[{"{", 
            RowBox[{"D1", ",", "0", ",", "M1"}], "}"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<(Imposed) fluctuations\>\"", ",", 
              "\"\<Backward migration  \!\(\*SubscriptBox[
StyleBox[\"\[ScriptCapitalM]\",
FontColor->RGBColor[0., 0., 0.7019607843137254]], \"1\"]\), \!\(\*SubscriptBox[
StyleBox[\"\[ScriptCapitalM]\",
FontColor->RGBColor[0.9299305714503701, 0.5673151750972762, \
0.032166018158236054`]], 
StyleBox[\"2\",
FontColor->RGBColor[0.9299305714503701, 0.5673151750972762, \
0.032166018158236054`]]]\)\>\""}], "}"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "0.005", "]"}], ",", 
              RowBox[{"Darker", "[", "Blue", "]"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "M1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.5"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"BaseStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"FontSize", "\[Rule]", "16"}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"M1", "-", "D1"}], ",", 
           RowBox[{"{", 
            RowBox[{"D1", ",", "0", ",", "M1"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "0.005", "]"}], ",", 
              RowBox[{"Darker", "[", "Blue", "]"}]}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{"M2", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
              RowBox[{"Lighter", "[", "Orange", "]"}]}], "}"}]}]}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Epilog", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<A\>\"", ",", "Bold", ",", "Italic", ",", 
               RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.007", ",", "0.48"}], "}"}]}], "]"}], "}"}]}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
           "ConstantMBMFlucBMs01m015", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{"Frame", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<(Imposed) fluctuations in backward migration\>\"", ",", 
              "\"\<\!\(\*
StyleBox[SubscriptBox[\"p\", \"1\"],
FontColor->RGBColor[0., 0., 0.8352941176470589]]\),  \!\(\*
StyleBox[SubscriptBox[\"p\", \"2\"],
FontColor->RGBColor[0.9607843137254902, 0.6823529411764706, \
0.0392156862745098]]\)\>\""}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "M1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", " ", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "0.005", "]"}], ",", 
              RowBox[{"Darker", "[", "Blue", "]"}]}], "}"}]}], ",", 
           RowBox[{"BaseStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"FontSize", "\[Rule]", "16"}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
           "ConstantMBMFlucBMs01m015", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "0.005", "]"}], ",", 
              RowBox[{"Lighter", "[", "Orange", "]"}]}], "}"}]}]}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Epilog", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<B\>\"", ",", "Bold", ",", "Italic", ",", 
               RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.007", ",", "0.95"}], "}"}]}], "]"}], "}"}]}]}], 
        "]"}]}], "}"}], "}"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.760525691831092*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Stability Analysis (Imposed fluctuations)", "Section",
 CellChangeTimes->{{3.740145261881398*^9, 3.740145269194948*^9}, {
  3.760522225710832*^9, 3.760522236573876*^9}}],

Cell["\<\
As we are not able to solve for the equilibrium frequency, we analyze the \
stability of the polymorphic equilibrium again by evaluating the conditions \
for a protected polymorphism.
To capture the fluctuations in population size, we consider two consecutive \
generations:\
\>", "Text",
 CellChangeTimes->{{3.7403118369782705`*^9, 3.7403119746419077`*^9}, {
  3.740312134485058*^9, 3.7403121629412346`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"s1", "=."}], ";", 
  RowBox[{"s2", "=."}], ";", 
  RowBox[{"m12", "=."}], ";", 
  RowBox[{"m21", "=."}], ";", 
  RowBox[{"p1", "=."}], ";", 
  RowBox[{"p2", "=."}], ";", 
  RowBox[{"KK", "=."}], ";", 
  RowBox[{"D1", "=."}], ";", 
  RowBox[{"N2", "=."}], ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NextGenerationUp", "[", 
    RowBox[{
    "s1_", ",", "s2_", ",", "m12_", ",", "m21_", ",", "p1_", ",", "p2_", ",", 
     "KK_", " ", ",", "D1_", ",", "N2_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"w1A", "=", "1"}], ",", 
       RowBox[{"w1a", "=", 
        RowBox[{"1", "-", "s1"}]}], ",", 
       RowBox[{"w2A", "=", 
        RowBox[{"1", "-", "s2"}]}], ",", 
       RowBox[{"w2a", "=", "1"}], ",", 
       RowBox[{"N1", "=", 
        RowBox[{"KK", "+", "D1"}]}]}], "}"}], ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "m12"}], ")"}], "p1", " ", "N1"}], "+", 
          RowBox[{"m21", " ", "p2", " ", "N2"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "m12"}], ")"}], "N1"}], "+", 
          RowBox[{"m21", " ", "N2"}]}]], "*", 
        RowBox[{"(", 
         RowBox[{"w1A", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m12"}], ")"}], "p1", " ", "N1"}], "+", 
               RowBox[{"m21", " ", "p2", " ", "N2"}]}], 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m12"}], ")"}], "N1"}], "+", 
               RowBox[{"m21", " ", "N2"}]}]], "*", "w1A"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "m12"}], ")"}], "p1", " ", "N1"}], "+", 
                 RowBox[{"m21", " ", "p2", " ", "N2"}]}], 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "m12"}], ")"}], "N1"}], "+", 
                 RowBox[{"m21", " ", "N2"}]}]]}], ")"}], "*", "w1a"}]}], 
           ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "m21"}], ")"}], "p2", " ", "N2"}], "+", 
          RowBox[{"m12", " ", "p1", " ", "N1"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "m21"}], ")"}], "N2"}], "+", 
          RowBox[{"m12", " ", "N1"}]}]], "*", 
        RowBox[{"(", 
         RowBox[{"w2A", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m21"}], ")"}], "p2", " ", "N2"}], "+", 
               RowBox[{"m12", " ", "p1", " ", "N1"}]}], 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m21"}], ")"}], "N2"}], "+", 
               RowBox[{"m12", " ", "N1"}]}]], "*", "w2A"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "m21"}], ")"}], "p2", " ", "N2"}], "+", 
                 RowBox[{"m12", " ", "p1", " ", "N1"}]}], 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "m21"}], ")"}], "N2"}], "+", 
                 RowBox[{"m12", " ", "N1"}]}]]}], ")"}], "*", "w2a"}]}], 
           ")"}]}], ")"}]}]}], "}"}]}], " ", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NextGenerationDown", "[", 
   RowBox[{
   "s1_", ",", "s2_", ",", "m12_", ",", "m21_", ",", "p1_", ",", "p2_", ",", 
    "KK_", " ", ",", "D1_", ",", "N2_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"w1A", "=", "1"}], ",", 
      RowBox[{"w1a", "=", 
       RowBox[{"1", "-", "s1"}]}], ",", 
      RowBox[{"w2A", "=", 
       RowBox[{"1", "-", "s2"}]}], ",", 
      RowBox[{"w2a", "=", "1"}], ",", 
      RowBox[{"N1", "=", 
       RowBox[{"KK", "-", "D1"}]}]}], "}"}], ",", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "m12"}], ")"}], "p1", " ", "N1"}], "+", 
         RowBox[{"m21", " ", "p2", " ", "N2"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "m12"}], ")"}], "N1"}], "+", 
         RowBox[{"m21", " ", "N2"}]}]], "*", 
       RowBox[{"(", 
        RowBox[{"w1A", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "m12"}], ")"}], "p1", " ", "N1"}], "+", 
              RowBox[{"m21", " ", "p2", " ", "N2"}]}], 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "m12"}], ")"}], "N1"}], "+", 
              RowBox[{"m21", " ", "N2"}]}]], "*", "w1A"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m12"}], ")"}], "p1", " ", "N1"}], "+", 
                RowBox[{"m21", " ", "p2", " ", "N2"}]}], 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m12"}], ")"}], "N1"}], "+", 
                RowBox[{"m21", " ", "N2"}]}]]}], ")"}], "*", "w1a"}]}], 
          ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "m21"}], ")"}], "p2", " ", "N2"}], "+", 
         RowBox[{"m12", " ", "p1", " ", "N1"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "m21"}], ")"}], "N2"}], "+", 
         RowBox[{"m12", " ", "N1"}]}]], "*", 
       RowBox[{"(", 
        RowBox[{"w2A", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "m21"}], ")"}], "p2", " ", "N2"}], "+", 
              RowBox[{"m12", " ", "p1", " ", "N1"}]}], 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "m21"}], ")"}], "N2"}], "+", 
              RowBox[{"m12", " ", "N1"}]}]], "*", "w2A"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m21"}], ")"}], "p2", " ", "N2"}], "+", 
                RowBox[{"m12", " ", "p1", " ", "N1"}]}], 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m21"}], ")"}], "N2"}], "+", 
                RowBox[{"m12", " ", "N1"}]}]]}], ")"}], "*", "w2a"}]}], 
          ")"}]}], ")"}]}]}], "}"}]}], " ", "]"}]}]}], "Input",
 CellChangeTimes->{{3.740312090102042*^9, 3.7403121095118*^9}, {
  3.740323710257157*^9, 3.740323712023204*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TwoGenerationsUpDown", "[", 
    RowBox[{
    "s1_", ",", "s2_", ",", "m12_", ",", "m21_", ",", "p1_", ",", "p2_", ",", 
     "KK_", " ", ",", "D1_", ",", "N2_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"NextGenerationDown", "[", 
    RowBox[{"s1", ",", "s2", ",", "m12", ",", "m21", ",", 
     RowBox[{
      RowBox[{"NextGenerationUp", "[", 
       RowBox[{
       "s1", ",", "s2", ",", "m12", ",", "m21", ",", "p1", ",", "p2", ",", 
        "KK", ",", "D1", ",", "N2"}], "]"}], "\[LeftDoubleBracket]", "1", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
      RowBox[{"NextGenerationUp", "[", 
       RowBox[{
       "s1", ",", "s2", ",", "m12", ",", "m21", ",", "p1", ",", "p2", ",", 
        "KK", ",", "D1", ",", "N2"}], "]"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], ",", "KK", ",", "D1", ",", "N2"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TwoGenerationsDownUp", "[", 
   RowBox[{
   "s1_", ",", "s2_", ",", "m12_", ",", "m21_", ",", "p1_", ",", "p2_", ",", 
    "KK_", " ", ",", "D1_", ",", "N2_"}], "]"}], ":=", 
  RowBox[{"NextGenerationUp", "[", 
   RowBox[{"s1", ",", "s2", ",", "m12", ",", "m21", ",", 
    RowBox[{
     RowBox[{"NextGenerationDown", "[", 
      RowBox[{
      "s1", ",", "s2", ",", "m12", ",", "m21", ",", "p1", ",", "p2", ",", 
       "KK", ",", "D1", ",", "N2"}], "]"}], "\[LeftDoubleBracket]", "1", 
     "\[RightDoubleBracket]"}], ",", 
    RowBox[{
     RowBox[{"NextGenerationDown", "[", 
      RowBox[{
      "s1", ",", "s2", ",", "m12", ",", "m21", ",", "p1", ",", "p2", ",", 
       "KK", ",", "D1", ",", "N2"}], "]"}], "\[LeftDoubleBracket]", "2", 
     "\[RightDoubleBracket]"}], ",", "KK", ",", "D1", ",", "N2"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.7267522799895563`*^9, 3.7267524777029843`*^9}, {
   3.7279733205506325`*^9, 3.727973333637884*^9}, {3.7403121990608025`*^9, 
   3.7403122312858396`*^9}, 3.7403125488050556`*^9, 3.740312581307878*^9}],

Cell["\<\
Remark: The results are the same no matter if we consider N1 + D1 or N1 - D1 \
in the first generation. We choose to run the computations for \
TwoGenerationsUpDown[s1, s2, m12, m21, p1, p2, KK, D1, N2] (i.e. for N1 + D1 \
in the first and N1 - D1 in the subsequent generation):\
\>", "Text",
 CellChangeTimes->{{3.740312606382017*^9, 3.740312623226726*^9}, {
  3.7403127009178243`*^9, 3.740312840135955*^9}, {3.7403129159293327`*^9, 
  3.740312964697779*^9}, {3.74031306941424*^9, 3.740313105683607*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"jacImposedUpDown", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"TwoGenerationsUpDown", "[", 
         RowBox[{
         "s1", ",", "s2", ",", "m12", ",", "m21", ",", "p1", ",", "p2", ",", 
          "KK", ",", "D1", ",", "N2"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2"}], "}"}]}], "//", "Simplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.740313139485759*^9, 3.740313154814989*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"jacImposedUpDownZero", "=", 
   RowBox[{
    RowBox[{"jacImposedUpDown", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", "\[Rule]", "0"}], ",", 
       RowBox[{"p2", "\[Rule]", "0"}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EVImposedUpDownZero", "=", 
   RowBox[{
    RowBox[{"Eigenvalues", "[", "jacImposedUpDownZero", "]"}], "//", 
    "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7403131801139803`*^9, 3.740313218697419*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"jacImposedUpDownOne", "=", 
   RowBox[{
    RowBox[{"jacImposedUpDown", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", "\[Rule]", "1"}], ",", 
       RowBox[{"p2", "\[Rule]", "1"}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EVImposedUpDownOne", "=", 
   RowBox[{
    RowBox[{"Eigenvalues", "[", "jacImposedUpDownOne", "]"}], "//", 
    "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7403132362778177`*^9, 3.740313252424614*^9}}],

Cell["\<\
In both cases, the second eigenvalue of the Jacobi matrix is the leading \
eigenvalue (again, we assessed that by visual analysis). These two leading \
eigenvalues -- EVImposedUpDownZero[[2]] and EVImposedUpDownOne[[2]] -- \
determine the stable region of the monomorphisms 0 and 1, respectively.
The polymorphism is stable when both monomorphisms are unstable. I.e. the \
region where both, EVImposedUpDownZero[[2]] and EVImposedUpDownOne[[2]], are \
in absolute value larger than 1, leads to a stable polymorphic equilibrium.
\
\>", "Text",
 CellChangeTimes->{{3.74031350714249*^9, 3.7403136755711713`*^9}, {
   3.740313728488945*^9, 3.740313799400061*^9}, {3.7403138312495165`*^9, 
   3.740313937067114*^9}, {3.740313971188861*^9, 3.7403140006159563`*^9}, {
   3.7403203835621405`*^9, 3.7403204396698956`*^9}, 3.7403240442987795`*^9}],

Cell[TextData[{
 StyleBox["Fig. 6",
  FontWeight->"Bold"],
 ":"
}], "Text",
 CellChangeTimes->{{3.7403140127129297`*^9, 3.7403140149168262`*^9}, 
   3.748536094868762*^9, 3.7605223774774284`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=."}], ";", 
  RowBox[{"s2", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=."}], ";", 
  RowBox[{"m12", "=", "m"}], ";", " ", 
  RowBox[{"m21", "=", "m"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KK", "=", "100"}], ";", 
  RowBox[{"D1", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N2", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsGrid", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RegionPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "EVImposedUpDownOne", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"m", "\[Rule]", " ", "0.1"}], ",", 
                RowBox[{"D1", "\[Rule]", "90"}]}], "}"}]}], ")"}], ">", "1"}],
            "&&", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "EVUpDownZero", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"m", "\[Rule]", " ", "0.1"}], ",", 
                RowBox[{"D1", "\[Rule]", "90"}]}], "}"}]}], ")"}], ">", 
            "1"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"s1", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s2", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "LightGray"}], ",", 
          RowBox[{"BoundaryStyle", "\[Rule]", "None"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ContourPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "EVImposedUpDownOne", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"m", "\[Rule]", " ", "0.1"}], ",", 
                RowBox[{"D1", "\[Rule]", "0"}]}], "}"}]}], ")"}], "\[Equal]", 
            "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s1", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s2", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"ContourStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Gray", ",", 
             RowBox[{"Dashing", "[", 
              RowBox[{"{", 
               RowBox[{"0.01", ",", "0.045"}], "}"}], "]"}]}], "}"}]}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ContourPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "EVImposedUpDownZero", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"m", "\[Rule]", " ", "0.1"}], ",", 
                RowBox[{"D1", "\[Rule]", "0"}]}], "}"}]}], ")"}], "\[Equal]", 
            "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s1", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s2", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"ContourStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Gray", ",", 
             RowBox[{"Dashing", "[", 
              RowBox[{"{", 
               RowBox[{"0.01", ",", "0.045"}], "}"}], "]"}]}], "}"}]}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ContourPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "EVImposedUpDownOne", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"m", "\[Rule]", " ", "0.1"}], ",", 
                RowBox[{"D1", "\[Rule]", "90"}]}], "}"}]}], ")"}], "\[Equal]",
             "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s1", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s2", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"ContourStyle", "\[Rule]", "Gray"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ContourPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "EVImposedUpDownZero", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"m", "\[Rule]", " ", "0.1"}], ",", 
                RowBox[{"D1", "\[Rule]", "90"}]}], "}"}]}], ")"}], "\[Equal]",
             "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s1", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s2", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"ContourStyle", "\[Rule]", "Gray"}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RegionPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "EVImposedUpDownOne", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"m", "\[Rule]", " ", "0.4"}], ",", 
                RowBox[{"D1", "\[Rule]", "90"}]}], "}"}]}], ")"}], ">", "1"}],
            "&&", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "EVUpDownZero", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"m", "\[Rule]", " ", "0.4"}], ",", 
                RowBox[{"D1", "\[Rule]", "90"}]}], "}"}]}], ")"}], ">", 
            "1"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"s1", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s2", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "LightGray"}], ",", 
          RowBox[{"BoundaryStyle", "\[Rule]", "None"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ContourPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "EVImposedUpDownOne", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"m", "\[Rule]", " ", "0.4"}], ",", 
                RowBox[{"D1", "\[Rule]", "0"}]}], "}"}]}], ")"}], "\[Equal]", 
            "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s1", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s2", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"ContourStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Gray", ",", 
             RowBox[{"Dashing", "[", 
              RowBox[{"{", 
               RowBox[{"0.01", ",", "0.045"}], "}"}], "]"}]}], "}"}]}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ContourPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "EVImposedUpDownZero", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"m", "\[Rule]", " ", "0.4"}], ",", 
                RowBox[{"D1", "\[Rule]", "0"}]}], "}"}]}], ")"}], "\[Equal]", 
            "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s1", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s2", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"ContourStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Gray", ",", 
             RowBox[{"Dashing", "[", 
              RowBox[{"{", 
               RowBox[{"0.01", ",", "0.045"}], "}"}], "]"}]}], "}"}]}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ContourPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "EVImposedUpDownOne", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"m", "\[Rule]", " ", "0.4"}], ",", 
                RowBox[{"D1", "\[Rule]", "90"}]}], "}"}]}], ")"}], "\[Equal]",
             "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s1", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s2", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"ContourStyle", "\[Rule]", "Gray"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ContourPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "EVImposedUpDownZero", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"m", "\[Rule]", " ", "0.4"}], ",", 
                RowBox[{"D1", "\[Rule]", "90"}]}], "}"}]}], ")"}], "\[Equal]",
             "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s1", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s2", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"ContourStyle", "\[Rule]", "Gray"}]}], "]"}]}], "]"}]}], 
     "}"}], "}"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7403141254561205`*^9, 3.740314255623596*^9}, {
  3.740323803946727*^9, 3.740323809307833*^9}, {3.740324464796936*^9, 
  3.7403244700006647`*^9}}],

Cell[TextData[{
 "\n",
 StyleBox["Fig. 7B",
  FontWeight->"Bold"],
 ":"
}], "Text",
 CellChangeTimes->{{3.740317894317947*^9, 3.740317905382537*^9}, 
   3.748536662480606*^9, 3.7605224004870043`*^9}],

Cell["\<\
The above computations are also used to generate Fig. 7B. Namely, we plot the \
eigenvalue that describes the (in)stability of 0 (monomorphism where focal \
type dies out). It is visualized as a function of the symmetric migration \
rate and the relative fluctuation size.\
\>", "Text",
 CellChangeTimes->{
  3.7403180973357234`*^9, {3.7403185350026445`*^9, 3.7403186305720015`*^9}, {
   3.7403186705018578`*^9, 3.7403186891013527`*^9}, {3.7403187206556087`*^9, 
   3.740318735862089*^9}, {3.740319019012415*^9, 3.7403190325613213`*^9}, {
   3.748536834868001*^9, 3.748536947574589*^9}, {3.748537197525159*^9, 
   3.7485372136117744`*^9}, {3.7485372667260294`*^9, 3.7485372960759673`*^9}, 
   3.76052240945398*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s", "=."}], ";", 
  RowBox[{"s1", "=", "s"}], ";", 
  RowBox[{"s2", "=", "s"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=."}], ";", 
  RowBox[{"m12", "=", "m"}], ";", " ", 
  RowBox[{"m21", "=", "m"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KK", "=", "1"}], ";", 
  RowBox[{"D1", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N2", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
         "EVImposedUpDownZero", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"s", "\[Rule]", " ", "0.1"}], "}"}]}], ")"}], "\[Equal]", 
       "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "0", ",", 
       RowBox[{"1", "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"D1", ",", "0", ",", "KK"}], "}"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"Blue", ",", 
         RowBox[{"Thickness", "[", "0.0045", "]"}]}], "}"}], "}"}]}], ",", 
     RowBox[{"ContourShading", "\[Rule]", "None"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
         "EVImposedUpDownZero", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"s", "\[Rule]", " ", "0.2"}], "}"}]}], ")"}], "\[Equal]", 
       "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "0", ",", 
       RowBox[{"1", "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"D1", ",", "0", ",", "KK"}], "}"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"Orange", ",", 
         RowBox[{"Thickness", "[", "0.0045", "]"}]}], "}"}], "}"}]}], ",", 
     RowBox[{"ContourShading", "\[Rule]", "None"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
         "EVImposedUpDownZero", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"s", "\[Rule]", " ", "0.3"}], "}"}]}], ")"}], "\[Equal]", 
       "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "0", ",", 
       RowBox[{"1", "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"D1", ",", "0", ",", "KK"}], "}"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Darker", "[", "Green", "]"}], ",", 
         RowBox[{"Thickness", "[", "0.0045", "]"}]}], "}"}], "}"}]}], ",", 
     RowBox[{"ContourShading", "\[Rule]", "None"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.748537017397983*^9, {3.7485370605571575`*^9, 3.748537173254056*^9}}],

Cell[CellGroupData[{

Cell["Continent-island model", "Subsection",
 CellChangeTimes->{{3.740311758652424*^9, 3.740311770529539*^9}}],

Cell["\<\
Finally, we analyze the continent-island model with imposed fluctuations on \
the island. M21 denotes the number of immigrants (per generation) arriving on \
the island.\
\>", "Text",
 CellChangeTimes->{{3.740314816447505*^9, 3.740314840373474*^9}, {
  3.740314915078973*^9, 3.740314992844025*^9}}],

Cell["\<\
First, we compute the equilibrium frequency (more precisely: the two-cycle) \
of the resident type, again by considering two consecutive generations:\
\>", "Text",
 CellChangeTimes->{{3.740315012644869*^9, 3.7403153514273615`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"K1", "=."}], ";", 
  RowBox[{"D1", "=."}], ";", " ", 
  RowBox[{"s1", "=."}], ";", 
  RowBox[{"M21", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p1t0", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N1t0", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N1t1", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N2", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p2", "=."}], ";", "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "\"\<fixed allele frequency of the focal type on the continent\>\"", " ", 
     "->", " ", 
     RowBox[{"will", " ", "be", " ", "set", " ", "to", " ", "zero"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"p1t1", "=", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"p1t0", " ", "N1t0"}], "+", 
       RowBox[{"p2", " ", "M21"}]}], 
      RowBox[{"N1t0", "+", "M21"}]], "*", 
     RowBox[{"(", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"p1t0", " ", "N1t0"}], "+", 
           RowBox[{"p2", " ", "M21"}]}], 
          RowBox[{"N1t0", "+", "M21"}]], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{
              RowBox[{"p1t0", " ", "N1t0"}], "+", 
              RowBox[{"p2", " ", "M21"}]}], 
             RowBox[{"N1t0", "+", "M21"}]]}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "s1"}], ")"}]}]}], ")"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p1t2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"p1t1", " ", "N1t1"}], "+", " ", 
      RowBox[{"p2", " ", "M21"}]}], 
     RowBox[{"N1t1", "+", "M21"}]], "*", 
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"p1t1", " ", "N1t1"}], "+", " ", 
          RowBox[{"p2", " ", "M21"}]}], 
         RowBox[{"N1t1", "+", "M21"}]], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"p1t1", " ", "N1t1"}], "+", " ", 
             RowBox[{"p2", " ", "M21"}]}], 
            RowBox[{"N1t1", "+", "M21"}]]}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "s1"}], ")"}]}]}], ")"}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7194021525010133`*^9, 3.7194021934372373`*^9}, {
   3.7194022282112045`*^9, 3.719402230511837*^9}, {3.7194022887667284`*^9, 
   3.71940233793642*^9}, {3.719402376405111*^9, 3.7194024375684576`*^9}, {
   3.719407691592746*^9, 3.71940769223344*^9}, {3.71941164242037*^9, 
   3.719411646876735*^9}, {3.719412089592142*^9, 3.719412090150854*^9}, {
   3.723377692954031*^9, 3.7233777314140987`*^9}, {3.723377779370385*^9, 
   3.7233778038878465`*^9}, {3.7403145164631867`*^9, 3.740314564256943*^9}, {
   3.7403146165170393`*^9, 3.7403146244250546`*^9}, {3.7403155914886646`*^9, 
   3.740315613851055*^9}, {3.7403160691738396`*^9, 3.7403161345165544`*^9}, {
   3.7403170405775146`*^9, 3.74031706216064*^9}, 3.740318756947122*^9}],

Cell[TextData[{
 "We obtain two solutions: one for generations where the local population \
density is low, the other for generations where the local population density \
is high. The allele frequency of the resident type ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],
  FormatType->"TraditionalForm"],
 " at equilibrium exhibits small fluctuations:"
}], "Text",
 CellChangeTimes->{{3.7403153565534906`*^9, 3.7403154240087285`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"N1t0", "=", 
   RowBox[{"K1", "-", "D1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N1t1", "=", 
   RowBox[{"K1", "+", "D1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"p1t2", "-", "p1t0"}], "\[Equal]", "0"}], "  ", "&&", " ", 
    RowBox[{"0", "<", "s1", "<", "1"}], "&&", 
    RowBox[{"0", "<", "M21"}], "&&", 
    RowBox[{"0", "<", "D1", "<", "K1"}], "&&", 
    RowBox[{"0", "<", "p2", "<", "1"}]}], ",", "p1t0", ",", "Reals"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7194021525010133`*^9, 3.7194021934372373`*^9}, {
   3.7194022282112045`*^9, 3.719402230511837*^9}, {3.7194022887667284`*^9, 
   3.71940233793642*^9}, {3.719402376405111*^9, 3.7194024375684576`*^9}, {
   3.719407691592746*^9, 3.71940769223344*^9}, {3.71941164242037*^9, 
   3.719411646876735*^9}, {3.719412089592142*^9, 3.719412090150854*^9}, {
   3.723377692954031*^9, 3.7233777314140987`*^9}, {3.723377779370385*^9, 
   3.7233778038878465`*^9}, {3.7403145164631867`*^9, 3.740314564256943*^9}, {
   3.740314626581559*^9, 3.740314678106764*^9}, {3.74031473087072*^9, 
   3.7403147452953615`*^9}, 3.740315622540177*^9, {3.740318766573567*^9, 
   3.7403187709189415`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"K1", ">", "0"}], "&&", 
  RowBox[{"0", "<", "D1", "<", "K1"}], "&&", 
  RowBox[{"M21", ">", "0"}], "&&", 
  RowBox[{"0", "<", "p2", "<", "1"}], "&&", 
  RowBox[{"0", "<", "s1", "<", "1"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"p1t0", "\[Equal]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "K1", " ", "M21"}], "-", 
         SuperscriptBox["M21", "2"], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["D1", "2"], " ", "s1"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["K1", "2"], " ", "s1"}], "+", 
         RowBox[{"4", " ", "K1", " ", "M21", " ", "s1"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["M21", "2"], " ", "s1"}], "-", 
         RowBox[{"2", " ", "D1", " ", "M21", " ", "p2", " ", "s1"}], "-", 
         RowBox[{"2", " ", "K1", " ", "M21", " ", "p2", " ", "s1"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["M21", "2"], " ", "p2", " ", "s1"}], "+", 
         RowBox[{
          SuperscriptBox["D1", "2"], " ", 
          SuperscriptBox["s1", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["K1", "2"], " ", 
          SuperscriptBox["s1", "2"]}], "-", 
         RowBox[{"2", " ", "K1", " ", "M21", " ", 
          SuperscriptBox["s1", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["M21", "2"], " ", 
          SuperscriptBox["s1", "2"]}], "+", 
         RowBox[{"2", " ", "K1", " ", "M21", " ", "p2", " ", 
          SuperscriptBox["s1", "2"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["M21", "2"], " ", "p2", " ", 
          SuperscriptBox["s1", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["M21", "2"], " ", 
          SuperscriptBox["p2", "2"], " ", 
          SuperscriptBox["s1", "2"]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"D1", "-", "K1"}], ")"}], " ", "s1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "D1"}], "-", 
           RowBox[{"2", " ", "K1"}], "-", "M21", "+", 
           RowBox[{"D1", " ", "s1"}], "+", 
           RowBox[{"K1", " ", "s1"}], "+", 
           RowBox[{"M21", " ", "s1"}], "-", 
           RowBox[{"M21", " ", "p2", " ", "s1"}]}], ")"}]}], ")"}]}], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"]}], "+", 
            RowBox[{"4", " ", "K1", " ", 
             SuperscriptBox["M21", "3"]}], "+", 
            SuperscriptBox["M21", "4"], "+", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "s1"}], 
            "-", 
            RowBox[{"8", " ", 
             SuperscriptBox["K1", "3"], " ", "M21", " ", "s1"}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "s1"}], "-", 
            RowBox[{"20", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "s1"}], "-", 
            RowBox[{"16", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", "s1"}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", "s1"}], "-", 
            RowBox[{"16", " ", 
             SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "p2", " ",
              "s1"}], "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["K1", "3"], " ", "M21", " ", "p2", " ", "s1"}], 
            "-", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", "s1"}], "+", 
            RowBox[{"24", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", "s1"}], "+", 
            RowBox[{"16", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", "p2", " ", "s1"}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", "p2", " ", "s1"}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "4"], " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["K1", "4"], " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"20", " ", 
             SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"20", " ", 
             SuperscriptBox["K1", "3"], " ", "M21", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"10", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"34", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"24", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"24", " ", 
             SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"24", " ", 
             SuperscriptBox["K1", "3"], " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"56", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"44", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"12", " ", 
             SuperscriptBox["M21", "4"], " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"20", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"20", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "4"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["K1", "4"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"16", " ", 
             SuperscriptBox["K1", "3"], " ", "M21", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"24", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"16", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"16", " ", 
             SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["K1", "3"], " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"12", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"44", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"40", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"12", " ", 
             SuperscriptBox["M21", "4"], " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"20", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"32", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"12", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"8", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "3"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "3"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{
             SuperscriptBox["D1", "4"], " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{
             SuperscriptBox["K1", "4"], " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["K1", "3"], " ", "M21", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"4", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["K1", "3"], " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"12", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"12", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"12", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "3"], " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "3"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "4"], " ", 
             SuperscriptBox["s1", "4"]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"D1", "-", "K1"}], ")"}], "2"], " ", 
            SuperscriptBox["s1", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "D1"}], "-", 
               RowBox[{"2", " ", "K1"}], "-", "M21", "+", 
               RowBox[{"D1", " ", "s1"}], "+", 
               RowBox[{"K1", " ", "s1"}], "+", 
               RowBox[{"M21", " ", "s1"}], "-", 
               RowBox[{"M21", " ", "p2", " ", "s1"}]}], ")"}], "2"]}], 
           ")"}]}], ")"}]}]}]}]}], "||", 
    RowBox[{"p1t0", "\[Equal]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "K1", " ", "M21"}], "-", 
         SuperscriptBox["M21", "2"], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["D1", "2"], " ", "s1"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["K1", "2"], " ", "s1"}], "+", 
         RowBox[{"4", " ", "K1", " ", "M21", " ", "s1"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["M21", "2"], " ", "s1"}], "-", 
         RowBox[{"2", " ", "D1", " ", "M21", " ", "p2", " ", "s1"}], "-", 
         RowBox[{"2", " ", "K1", " ", "M21", " ", "p2", " ", "s1"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["M21", "2"], " ", "p2", " ", "s1"}], "+", 
         RowBox[{
          SuperscriptBox["D1", "2"], " ", 
          SuperscriptBox["s1", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["K1", "2"], " ", 
          SuperscriptBox["s1", "2"]}], "-", 
         RowBox[{"2", " ", "K1", " ", "M21", " ", 
          SuperscriptBox["s1", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["M21", "2"], " ", 
          SuperscriptBox["s1", "2"]}], "+", 
         RowBox[{"2", " ", "K1", " ", "M21", " ", "p2", " ", 
          SuperscriptBox["s1", "2"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["M21", "2"], " ", "p2", " ", 
          SuperscriptBox["s1", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["M21", "2"], " ", 
          SuperscriptBox["p2", "2"], " ", 
          SuperscriptBox["s1", "2"]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"D1", "-", "K1"}], ")"}], " ", "s1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "D1"}], "-", 
           RowBox[{"2", " ", "K1"}], "-", "M21", "+", 
           RowBox[{"D1", " ", "s1"}], "+", 
           RowBox[{"K1", " ", "s1"}], "+", 
           RowBox[{"M21", " ", "s1"}], "-", 
           RowBox[{"M21", " ", "p2", " ", "s1"}]}], ")"}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"]}], "+", 
            RowBox[{"4", " ", "K1", " ", 
             SuperscriptBox["M21", "3"]}], "+", 
            SuperscriptBox["M21", "4"], "+", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "s1"}], 
            "-", 
            RowBox[{"8", " ", 
             SuperscriptBox["K1", "3"], " ", "M21", " ", "s1"}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "s1"}], "-", 
            RowBox[{"20", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "s1"}], "-", 
            RowBox[{"16", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", "s1"}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", "s1"}], "-", 
            RowBox[{"16", " ", 
             SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "p2", " ",
              "s1"}], "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["K1", "3"], " ", "M21", " ", "p2", " ", "s1"}], 
            "-", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", "s1"}], "+", 
            RowBox[{"24", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", "s1"}], "+", 
            RowBox[{"16", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", "p2", " ", "s1"}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", "p2", " ", "s1"}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "4"], " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["K1", "4"], " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"20", " ", 
             SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"20", " ", 
             SuperscriptBox["K1", "3"], " ", "M21", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"10", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"34", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"24", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"24", " ", 
             SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"24", " ", 
             SuperscriptBox["K1", "3"], " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"56", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"44", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"12", " ", 
             SuperscriptBox["M21", "4"], " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"20", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"20", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "4"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["K1", "4"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"16", " ", 
             SuperscriptBox["K1", "3"], " ", "M21", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"24", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"16", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"16", " ", 
             SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["K1", "3"], " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"12", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"44", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"40", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"12", " ", 
             SuperscriptBox["M21", "4"], " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"20", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"32", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"12", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"8", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "3"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "3"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{
             SuperscriptBox["D1", "4"], " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{
             SuperscriptBox["K1", "4"], " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["K1", "3"], " ", "M21", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"4", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["K1", "3"], " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"12", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"12", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["K1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"12", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", "K1", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "3"], " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "3"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "4"], " ", 
             SuperscriptBox["s1", "4"]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"D1", "-", "K1"}], ")"}], "2"], " ", 
            SuperscriptBox["s1", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "D1"}], "-", 
               RowBox[{"2", " ", "K1"}], "-", "M21", "+", 
               RowBox[{"D1", " ", "s1"}], "+", 
               RowBox[{"K1", " ", "s1"}], "+", 
               RowBox[{"M21", " ", "s1"}], "-", 
               RowBox[{"M21", " ", "p2", " ", "s1"}]}], ")"}], "2"]}], 
           ")"}]}], ")"}]}]}]}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.7403147699241247`*^9, 3.740318780642393*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"N1t0", "=", 
   RowBox[{"K1", "+", "D1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N1t1", "=", 
   RowBox[{"K1", "-", "D1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"p1t2", "-", "p1t0"}], "\[Equal]", "0"}], "  ", "&&", " ", 
    RowBox[{"0", "<", "s1", "<", "1"}], "&&", 
    RowBox[{"0", "<", "M21"}], "&&", 
    RowBox[{"0", "<", "D1", "<", "K1"}], "&&", 
    RowBox[{"0", "<", "p2", "<", "1"}]}], ",", "p1t0", ",", "Reals"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.719412121687104*^9, 3.7194121263619356`*^9}, {
   3.7233778276577215`*^9, 3.7233778325277386`*^9}, {3.740314659603237*^9, 
   3.7403147106322136`*^9}, {3.740314748561881*^9, 3.7403147595327296`*^9}, 
   3.7403156259000473`*^9, {3.740318772719408*^9, 3.740318785706005*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"KK", ">", "0"}], "&&", 
  RowBox[{"0", "<", "D1", "<", "KK"}], "&&", 
  RowBox[{"M21", ">", "0"}], "&&", 
  RowBox[{"0", "<", "p2", "<", "1"}], "&&", 
  RowBox[{"0", "<", "s1", "<", "1"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"p1t0", "\[Equal]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "KK", " ", "M21"}], "-", 
         SuperscriptBox["M21", "2"], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["D1", "2"], " ", "s1"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["KK", "2"], " ", "s1"}], "+", 
         RowBox[{"4", " ", "KK", " ", "M21", " ", "s1"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["M21", "2"], " ", "s1"}], "+", 
         RowBox[{"2", " ", "D1", " ", "M21", " ", "p2", " ", "s1"}], "-", 
         RowBox[{"2", " ", "KK", " ", "M21", " ", "p2", " ", "s1"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["M21", "2"], " ", "p2", " ", "s1"}], "+", 
         RowBox[{
          SuperscriptBox["D1", "2"], " ", 
          SuperscriptBox["s1", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["KK", "2"], " ", 
          SuperscriptBox["s1", "2"]}], "-", 
         RowBox[{"2", " ", "KK", " ", "M21", " ", 
          SuperscriptBox["s1", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["M21", "2"], " ", 
          SuperscriptBox["s1", "2"]}], "+", 
         RowBox[{"2", " ", "KK", " ", "M21", " ", "p2", " ", 
          SuperscriptBox["s1", "2"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["M21", "2"], " ", "p2", " ", 
          SuperscriptBox["s1", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["M21", "2"], " ", 
          SuperscriptBox["p2", "2"], " ", 
          SuperscriptBox["s1", "2"]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"D1", "+", "KK"}], ")"}], " ", "s1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "D1"}], "+", 
           RowBox[{"2", " ", "KK"}], "+", "M21", "+", 
           RowBox[{"D1", " ", "s1"}], "-", 
           RowBox[{"KK", " ", "s1"}], "-", 
           RowBox[{"M21", " ", "s1"}], "+", 
           RowBox[{"M21", " ", "p2", " ", "s1"}]}], ")"}]}], ")"}]}], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"]}], "+", 
            RowBox[{"4", " ", "KK", " ", 
             SuperscriptBox["M21", "3"]}], "+", 
            SuperscriptBox["M21", "4"], "+", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", "KK", " ", "M21", " ", "s1"}], 
            "-", 
            RowBox[{"8", " ", 
             SuperscriptBox["KK", "3"], " ", "M21", " ", "s1"}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "s1"}], "-", 
            RowBox[{"20", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "s1"}], "-", 
            RowBox[{"16", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", "s1"}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", "s1"}], "-", 
            RowBox[{"16", " ", 
             SuperscriptBox["D1", "2"], " ", "KK", " ", "M21", " ", "p2", " ",
              "s1"}], "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["KK", "3"], " ", "M21", " ", "p2", " ", "s1"}], 
            "-", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", "s1"}], "+", 
            RowBox[{"24", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", "s1"}], "+", 
            RowBox[{"16", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", "p2", " ", "s1"}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", "p2", " ", "s1"}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "4"], " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["KK", "4"], " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"20", " ", 
             SuperscriptBox["D1", "2"], " ", "KK", " ", "M21", " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"20", " ", 
             SuperscriptBox["KK", "3"], " ", "M21", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"10", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"34", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"24", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"24", " ", 
             SuperscriptBox["D1", "2"], " ", "KK", " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"24", " ", 
             SuperscriptBox["KK", "3"], " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"56", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"44", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"12", " ", 
             SuperscriptBox["M21", "4"], " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"20", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"20", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "4"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["KK", "4"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["D1", "2"], " ", "KK", " ", "M21", " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"16", " ", 
             SuperscriptBox["KK", "3"], " ", "M21", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"24", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"16", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"16", " ", 
             SuperscriptBox["D1", "2"], " ", "KK", " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["KK", "3"], " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"12", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"44", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"40", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"12", " ", 
             SuperscriptBox["M21", "4"], " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"20", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"32", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"12", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"8", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "3"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "3"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{
             SuperscriptBox["D1", "4"], " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{
             SuperscriptBox["KK", "4"], " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", "KK", " ", "M21", " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["KK", "3"], " ", "M21", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"4", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", "KK", " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["KK", "3"], " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"12", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"12", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"12", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "3"], " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "3"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "4"], " ", 
             SuperscriptBox["s1", "4"]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"D1", "+", "KK"}], ")"}], "2"], " ", 
            SuperscriptBox["s1", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "D1"}], "+", 
               RowBox[{"2", " ", "KK"}], "+", "M21", "+", 
               RowBox[{"D1", " ", "s1"}], "-", 
               RowBox[{"KK", " ", "s1"}], "-", 
               RowBox[{"M21", " ", "s1"}], "+", 
               RowBox[{"M21", " ", "p2", " ", "s1"}]}], ")"}], "2"]}], 
           ")"}]}], ")"}]}]}]}]}], "||", 
    RowBox[{"p1t0", "\[Equal]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "KK", " ", "M21"}], "-", 
         SuperscriptBox["M21", "2"], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["D1", "2"], " ", "s1"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["KK", "2"], " ", "s1"}], "+", 
         RowBox[{"4", " ", "KK", " ", "M21", " ", "s1"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["M21", "2"], " ", "s1"}], "+", 
         RowBox[{"2", " ", "D1", " ", "M21", " ", "p2", " ", "s1"}], "-", 
         RowBox[{"2", " ", "KK", " ", "M21", " ", "p2", " ", "s1"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["M21", "2"], " ", "p2", " ", "s1"}], "+", 
         RowBox[{
          SuperscriptBox["D1", "2"], " ", 
          SuperscriptBox["s1", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["KK", "2"], " ", 
          SuperscriptBox["s1", "2"]}], "-", 
         RowBox[{"2", " ", "KK", " ", "M21", " ", 
          SuperscriptBox["s1", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["M21", "2"], " ", 
          SuperscriptBox["s1", "2"]}], "+", 
         RowBox[{"2", " ", "KK", " ", "M21", " ", "p2", " ", 
          SuperscriptBox["s1", "2"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["M21", "2"], " ", "p2", " ", 
          SuperscriptBox["s1", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["M21", "2"], " ", 
          SuperscriptBox["p2", "2"], " ", 
          SuperscriptBox["s1", "2"]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"D1", "+", "KK"}], ")"}], " ", "s1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "D1"}], "+", 
           RowBox[{"2", " ", "KK"}], "+", "M21", "+", 
           RowBox[{"D1", " ", "s1"}], "-", 
           RowBox[{"KK", " ", "s1"}], "-", 
           RowBox[{"M21", " ", "s1"}], "+", 
           RowBox[{"M21", " ", "p2", " ", "s1"}]}], ")"}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"]}], "+", 
            RowBox[{"4", " ", "KK", " ", 
             SuperscriptBox["M21", "3"]}], "+", 
            SuperscriptBox["M21", "4"], "+", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", "KK", " ", "M21", " ", "s1"}], 
            "-", 
            RowBox[{"8", " ", 
             SuperscriptBox["KK", "3"], " ", "M21", " ", "s1"}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "s1"}], "-", 
            RowBox[{"20", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "s1"}], "-", 
            RowBox[{"16", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", "s1"}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", "s1"}], "-", 
            RowBox[{"16", " ", 
             SuperscriptBox["D1", "2"], " ", "KK", " ", "M21", " ", "p2", " ",
              "s1"}], "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["KK", "3"], " ", "M21", " ", "p2", " ", "s1"}], 
            "-", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", "s1"}], "+", 
            RowBox[{"24", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", "s1"}], "+", 
            RowBox[{"16", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", "p2", " ", "s1"}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", "p2", " ", "s1"}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "4"], " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["KK", "4"], " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"20", " ", 
             SuperscriptBox["D1", "2"], " ", "KK", " ", "M21", " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"20", " ", 
             SuperscriptBox["KK", "3"], " ", "M21", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"10", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"34", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"24", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"24", " ", 
             SuperscriptBox["D1", "2"], " ", "KK", " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"24", " ", 
             SuperscriptBox["KK", "3"], " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"56", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"44", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"12", " ", 
             SuperscriptBox["M21", "4"], " ", "p2", " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"20", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"20", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "2"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "4"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["KK", "4"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["D1", "2"], " ", "KK", " ", "M21", " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"16", " ", 
             SuperscriptBox["KK", "3"], " ", "M21", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"8", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"24", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"16", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"16", " ", 
             SuperscriptBox["D1", "2"], " ", "KK", " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["KK", "3"], " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"12", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"44", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"40", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"12", " ", 
             SuperscriptBox["M21", "4"], " ", "p2", " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"20", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"32", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "-", 
            RowBox[{"12", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"8", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "3"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "3"], " ", 
             SuperscriptBox["s1", "3"]}], "+", 
            RowBox[{
             SuperscriptBox["D1", "4"], " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{
             SuperscriptBox["KK", "4"], " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", "KK", " ", "M21", " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["KK", "3"], " ", "M21", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"4", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", "KK", " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["KK", "3"], " ", "M21", " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"12", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"12", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", "p2", " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["D1", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["KK", "2"], " ", 
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"12", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "2"], " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", "KK", " ", 
             SuperscriptBox["M21", "3"], " ", 
             SuperscriptBox["p2", "3"], " ", 
             SuperscriptBox["s1", "4"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "3"], " ", 
             SuperscriptBox["s1", "4"]}], "+", 
            RowBox[{
             SuperscriptBox["M21", "4"], " ", 
             SuperscriptBox["p2", "4"], " ", 
             SuperscriptBox["s1", "4"]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"D1", "+", "KK"}], ")"}], "2"], " ", 
            SuperscriptBox["s1", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "D1"}], "+", 
               RowBox[{"2", " ", "KK"}], "+", "M21", "+", 
               RowBox[{"D1", " ", "s1"}], "-", 
               RowBox[{"KK", " ", "s1"}], "-", 
               RowBox[{"M21", " ", "s1"}], "+", 
               RowBox[{"M21", " ", "p2", " ", "s1"}]}], ")"}], "2"]}], 
           ")"}]}], ")"}]}]}]}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.74031476628341*^9}]
}, Closed]],

Cell["\<\

Take the relevant solution from both computations (second one in both cases):\
\>", "Text",
 CellChangeTimes->{{3.7403154890840807`*^9, 3.7403155075713325`*^9}, {
  3.7403161740854225`*^9, 3.7403161931041737`*^9}, {3.740316440037754*^9, 
  3.7403164545715265`*^9}, {3.740316904621421*^9, 3.7403169379232287`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"p1EquilibriumIslandPoly", "[", 
   RowBox[{"s1_", ",", "D1_", ",", "K1_", ",", "M21_", ",", "p2_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "K1", " ", "M21"}], "-", 
        SuperscriptBox["M21", "2"], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["D1", "2"], " ", "s1"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["K1", "2"], " ", "s1"}], "+", 
        RowBox[{"4", " ", "K1", " ", "M21", " ", "s1"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["M21", "2"], " ", "s1"}], "-", 
        RowBox[{"2", " ", "D1", " ", "M21", " ", "p2", " ", "s1"}], "-", 
        RowBox[{"2", " ", "K1", " ", "M21", " ", "p2", " ", "s1"}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["M21", "2"], " ", "p2", " ", "s1"}], "+", 
        RowBox[{
         SuperscriptBox["D1", "2"], " ", 
         SuperscriptBox["s1", "2"]}], "-", 
        RowBox[{
         SuperscriptBox["K1", "2"], " ", 
         SuperscriptBox["s1", "2"]}], "-", 
        RowBox[{"2", " ", "K1", " ", "M21", " ", 
         SuperscriptBox["s1", "2"]}], "-", 
        RowBox[{
         SuperscriptBox["M21", "2"], " ", 
         SuperscriptBox["s1", "2"]}], "+", 
        RowBox[{"2", " ", "K1", " ", "M21", " ", "p2", " ", 
         SuperscriptBox["s1", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["M21", "2"], " ", "p2", " ", 
         SuperscriptBox["s1", "2"]}], "-", 
        RowBox[{
         SuperscriptBox["M21", "2"], " ", 
         SuperscriptBox["p2", "2"], " ", 
         SuperscriptBox["s1", "2"]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"D1", "-", "K1"}], ")"}], " ", "s1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "D1"}], "-", 
          RowBox[{"2", " ", "K1"}], "-", "M21", "+", 
          RowBox[{"D1", " ", "s1"}], "+", 
          RowBox[{"K1", " ", "s1"}], "+", 
          RowBox[{"M21", " ", "s1"}], "-", 
          RowBox[{"M21", " ", "p2", " ", "s1"}]}], ")"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"1", "/", "2"}], 
      RowBox[{"\[Sqrt]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"]}], "+", 
           RowBox[{"4", " ", "K1", " ", 
            SuperscriptBox["M21", "3"]}], "+", 
           SuperscriptBox["M21", "4"], "+", 
           RowBox[{"8", " ", 
            SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "s1"}], 
           "-", 
           RowBox[{"8", " ", 
            SuperscriptBox["K1", "3"], " ", "M21", " ", "s1"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "s1"}], "-", 
           RowBox[{"20", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "s1"}], "-", 
           RowBox[{"16", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", "s1"}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["M21", "4"], " ", "s1"}], "-", 
           RowBox[{"16", " ", 
            SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "p2", " ", 
            "s1"}], "+", 
           RowBox[{"16", " ", 
            SuperscriptBox["K1", "3"], " ", "M21", " ", "p2", " ", "s1"}], 
           "-", 
           RowBox[{"8", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "p2", " ", "s1"}], "+", 
           RowBox[{"24", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "p2", " ", "s1"}], "+", 
           RowBox[{"16", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", "p2", " ", "s1"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["M21", "4"], " ", "p2", " ", "s1"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["D1", "4"], " ", 
            SuperscriptBox["s1", "2"]}], "-", 
           RowBox[{"8", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["K1", "4"], " ", 
            SuperscriptBox["s1", "2"]}], "-", 
           RowBox[{"20", " ", 
            SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"20", " ", 
            SuperscriptBox["K1", "3"], " ", "M21", " ", 
            SuperscriptBox["s1", "2"]}], "-", 
           RowBox[{"10", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"34", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"24", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"6", " ", 
            SuperscriptBox["M21", "4"], " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"24", " ", 
            SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "p2", " ", 
            SuperscriptBox["s1", "2"]}], "-", 
           RowBox[{"24", " ", 
            SuperscriptBox["K1", "3"], " ", "M21", " ", "p2", " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"16", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "p2", " ", 
            SuperscriptBox["s1", "2"]}], "-", 
           RowBox[{"56", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "p2", " ", 
            SuperscriptBox["s1", "2"]}], "-", 
           RowBox[{"44", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", "p2", " ", 
            SuperscriptBox["s1", "2"]}], "-", 
           RowBox[{"12", " ", 
            SuperscriptBox["M21", "4"], " ", "p2", " ", 
            SuperscriptBox["s1", "2"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"20", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"20", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"6", " ", 
            SuperscriptBox["M21", "4"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "2"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["D1", "4"], " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"8", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["K1", "4"], " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"16", " ", 
            SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"16", " ", 
            SuperscriptBox["K1", "3"], " ", "M21", " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"8", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"24", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"16", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["M21", "4"], " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"16", " ", 
            SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "p2", " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"16", " ", 
            SuperscriptBox["K1", "3"], " ", "M21", " ", "p2", " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"12", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "p2", " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"44", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "p2", " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"40", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", "p2", " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"12", " ", 
            SuperscriptBox["M21", "4"], " ", "p2", " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"20", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"32", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"12", " ", 
            SuperscriptBox["M21", "4"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"8", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", 
            SuperscriptBox["p2", "3"], " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["M21", "4"], " ", 
            SuperscriptBox["p2", "3"], " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{
            SuperscriptBox["D1", "4"], " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{
            SuperscriptBox["K1", "4"], " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["K1", "3"], " ", "M21", " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{"6", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{"4", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{
            SuperscriptBox["M21", "4"], " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "p2", " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["K1", "3"], " ", "M21", " ", "p2", " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "p2", " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"12", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "p2", " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"12", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", "p2", " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["M21", "4"], " ", "p2", " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{"6", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{"12", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{"6", " ", 
            SuperscriptBox["M21", "4"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"4", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", 
            SuperscriptBox["p2", "3"], " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["M21", "4"], " ", 
            SuperscriptBox["p2", "3"], " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{
            SuperscriptBox["M21", "4"], " ", 
            SuperscriptBox["p2", "4"], " ", 
            SuperscriptBox["s1", "4"]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"D1", "-", "K1"}], ")"}], "2"], " ", 
           SuperscriptBox["s1", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "D1"}], "-", 
              RowBox[{"2", " ", "K1"}], "-", "M21", "+", 
              RowBox[{"D1", " ", "s1"}], "+", 
              RowBox[{"K1", " ", "s1"}], "+", 
              RowBox[{"M21", " ", "s1"}], "-", 
              RowBox[{"M21", " ", "p2", " ", "s1"}]}], ")"}], "2"]}], ")"}]}],
         ")"}]}]}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "K1", " ", "M21"}], "-", 
        SuperscriptBox["M21", "2"], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["D1", "2"], " ", "s1"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["K1", "2"], " ", "s1"}], "+", 
        RowBox[{"4", " ", "K1", " ", "M21", " ", "s1"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["M21", "2"], " ", "s1"}], "+", 
        RowBox[{"2", " ", "D1", " ", "M21", " ", "p2", " ", "s1"}], "-", 
        RowBox[{"2", " ", "K1", " ", "M21", " ", "p2", " ", "s1"}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["M21", "2"], " ", "p2", " ", "s1"}], "+", 
        RowBox[{
         SuperscriptBox["D1", "2"], " ", 
         SuperscriptBox["s1", "2"]}], "-", 
        RowBox[{
         SuperscriptBox["K1", "2"], " ", 
         SuperscriptBox["s1", "2"]}], "-", 
        RowBox[{"2", " ", "K1", " ", "M21", " ", 
         SuperscriptBox["s1", "2"]}], "-", 
        RowBox[{
         SuperscriptBox["M21", "2"], " ", 
         SuperscriptBox["s1", "2"]}], "+", 
        RowBox[{"2", " ", "K1", " ", "M21", " ", "p2", " ", 
         SuperscriptBox["s1", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["M21", "2"], " ", "p2", " ", 
         SuperscriptBox["s1", "2"]}], "-", 
        RowBox[{
         SuperscriptBox["M21", "2"], " ", 
         SuperscriptBox["p2", "2"], " ", 
         SuperscriptBox["s1", "2"]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"D1", "+", "K1"}], ")"}], " ", "s1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "D1"}], "+", 
          RowBox[{"2", " ", "K1"}], "+", "M21", "+", 
          RowBox[{"D1", " ", "s1"}], "-", 
          RowBox[{"K1", " ", "s1"}], "-", 
          RowBox[{"M21", " ", "s1"}], "+", 
          RowBox[{"M21", " ", "p2", " ", "s1"}]}], ")"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"1", "/", "2"}], 
      RowBox[{"\[Sqrt]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"]}], "+", 
           RowBox[{"4", " ", "K1", " ", 
            SuperscriptBox["M21", "3"]}], "+", 
           SuperscriptBox["M21", "4"], "+", 
           RowBox[{"8", " ", 
            SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "s1"}], 
           "-", 
           RowBox[{"8", " ", 
            SuperscriptBox["K1", "3"], " ", "M21", " ", "s1"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "s1"}], "-", 
           RowBox[{"20", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "s1"}], "-", 
           RowBox[{"16", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", "s1"}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["M21", "4"], " ", "s1"}], "-", 
           RowBox[{"16", " ", 
            SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "p2", " ", 
            "s1"}], "+", 
           RowBox[{"16", " ", 
            SuperscriptBox["K1", "3"], " ", "M21", " ", "p2", " ", "s1"}], 
           "-", 
           RowBox[{"8", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "p2", " ", "s1"}], "+", 
           RowBox[{"24", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "p2", " ", "s1"}], "+", 
           RowBox[{"16", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", "p2", " ", "s1"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["M21", "4"], " ", "p2", " ", "s1"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["D1", "4"], " ", 
            SuperscriptBox["s1", "2"]}], "-", 
           RowBox[{"8", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["K1", "4"], " ", 
            SuperscriptBox["s1", "2"]}], "-", 
           RowBox[{"20", " ", 
            SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"20", " ", 
            SuperscriptBox["K1", "3"], " ", "M21", " ", 
            SuperscriptBox["s1", "2"]}], "-", 
           RowBox[{"10", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"34", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"24", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"6", " ", 
            SuperscriptBox["M21", "4"], " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"24", " ", 
            SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "p2", " ", 
            SuperscriptBox["s1", "2"]}], "-", 
           RowBox[{"24", " ", 
            SuperscriptBox["K1", "3"], " ", "M21", " ", "p2", " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"16", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "p2", " ", 
            SuperscriptBox["s1", "2"]}], "-", 
           RowBox[{"56", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "p2", " ", 
            SuperscriptBox["s1", "2"]}], "-", 
           RowBox[{"44", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", "p2", " ", 
            SuperscriptBox["s1", "2"]}], "-", 
           RowBox[{"12", " ", 
            SuperscriptBox["M21", "4"], " ", "p2", " ", 
            SuperscriptBox["s1", "2"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"20", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"20", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "2"]}], "+", 
           RowBox[{"6", " ", 
            SuperscriptBox["M21", "4"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "2"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["D1", "4"], " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"8", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["K1", "4"], " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"16", " ", 
            SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"16", " ", 
            SuperscriptBox["K1", "3"], " ", "M21", " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"8", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"24", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"16", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["M21", "4"], " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"16", " ", 
            SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "p2", " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"16", " ", 
            SuperscriptBox["K1", "3"], " ", "M21", " ", "p2", " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"12", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "p2", " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"44", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "p2", " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"40", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", "p2", " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"12", " ", 
            SuperscriptBox["M21", "4"], " ", "p2", " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"20", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"32", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "3"]}], "-", 
           RowBox[{"12", " ", 
            SuperscriptBox["M21", "4"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"8", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", 
            SuperscriptBox["p2", "3"], " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["M21", "4"], " ", 
            SuperscriptBox["p2", "3"], " ", 
            SuperscriptBox["s1", "3"]}], "+", 
           RowBox[{
            SuperscriptBox["D1", "4"], " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{
            SuperscriptBox["K1", "4"], " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["K1", "3"], " ", "M21", " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{"6", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{"4", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{
            SuperscriptBox["M21", "4"], " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["D1", "2"], " ", "K1", " ", "M21", " ", "p2", " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["K1", "3"], " ", "M21", " ", "p2", " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "p2", " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"12", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", "p2", " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"12", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", "p2", " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["M21", "4"], " ", "p2", " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["D1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{"6", " ", 
            SuperscriptBox["K1", "2"], " ", 
            SuperscriptBox["M21", "2"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{"12", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{"6", " ", 
            SuperscriptBox["M21", "4"], " ", 
            SuperscriptBox["p2", "2"], " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"4", " ", "K1", " ", 
            SuperscriptBox["M21", "3"], " ", 
            SuperscriptBox["p2", "3"], " ", 
            SuperscriptBox["s1", "4"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["M21", "4"], " ", 
            SuperscriptBox["p2", "3"], " ", 
            SuperscriptBox["s1", "4"]}], "+", 
           RowBox[{
            SuperscriptBox["M21", "4"], " ", 
            SuperscriptBox["p2", "4"], " ", 
            SuperscriptBox["s1", "4"]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"D1", "+", "K1"}], ")"}], "2"], " ", 
           SuperscriptBox["s1", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "D1"}], "+", 
              RowBox[{"2", " ", "K1"}], "+", "M21", "+", 
              RowBox[{"D1", " ", "s1"}], "-", 
              RowBox[{"K1", " ", "s1"}], "-", 
              RowBox[{"M21", " ", "s1"}], "+", 
              RowBox[{"M21", " ", "p2", " ", "s1"}]}], ")"}], "2"]}], ")"}]}],
         ")"}]}]}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7194115147301445`*^9, 3.719411631199973*^9}, {
   3.719411670736065*^9, 3.719411737592677*^9}, 3.719412356089347*^9, {
   3.722368378443425*^9, 3.7223683910083027`*^9}, {3.7233778760179005`*^9, 
   3.7233779351537867`*^9}, {3.723378054081828*^9, 3.7233780545098205`*^9}, 
   3.723378199338349*^9, {3.7233786851835265`*^9, 3.723378700492754*^9}, {
   3.740315518149954*^9, 3.7403155216821203`*^9}, 3.7403163664489937`*^9, 
   3.7403164316772604`*^9, {3.7403164794182425`*^9, 3.7403165170372133`*^9}, {
   3.7403166256523314`*^9, 3.740316640811842*^9}, {3.7403166782283506`*^9, 
   3.7403166803224645`*^9}, {3.7403167161418376`*^9, 3.740316721049389*^9}, {
   3.7403167809981303`*^9, 3.7403167930474424`*^9}, {3.7403169621831675`*^9, 
   3.740316987143016*^9}, {3.7403187950984674`*^9, 3.7403189452459917`*^9}}],

Cell["Set  p2 = 0 (monomorphic immigration from the continent):", "Text",
 CellChangeTimes->{{3.7403170100089655`*^9, 3.740317035107849*^9}, {
  3.740317074038121*^9, 3.7403170768041067`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"p1EquilibriumIsland", "[", 
   RowBox[{"s1_", ",", "D1_", ",", "K1_", ",", "M21_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"p1EquilibriumIslandPoly", "[", 
    RowBox[{"s1", ",", "D1", ",", "K1", ",", "M21", ",", "0"}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.7403165311797776`*^9, 3.7403165501206946`*^9}, {
  3.740316837416783*^9, 3.740316839448466*^9}, {3.7403189629403567`*^9, 
  3.7403189640966682`*^9}}],

Cell["\<\

Finally, we obtain conditions for persistence of the resident type by setting \
its equilibrium frequency to zero and then reversing the unequal signs:\
\>", "Text",
 CellChangeTimes->{{3.740317101544381*^9, 3.7403171039826555`*^9}, {
   3.740317206396619*^9, 3.740317315010909*^9}, {3.740317401703065*^9, 
   3.740317434005328*^9}, 3.7403205270064926`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Reduce", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"p1EquilibriumIsland", "[", 
       RowBox[{"s1", ",", "D1", ",", "K1", ",", "M21"}], "]"}], "\[Equal]", 
      "0"}], "&&", " ", 
     RowBox[{"0", "<", "s1", "<", "1"}], "&&", 
     RowBox[{"0", "<", "M21"}], "&&", 
     RowBox[{"0", "<", "D1", "<", "K1"}]}], ",", "D1", ",", "Reals"}], "]"}], 
  "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.7403174665108705`*^9, 3.740317498157919*^9}, {
  3.740318973160499*^9, 3.740318975457641*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"M21", ">", "0"}], "&&", 
  RowBox[{"K1", ">", "0"}], "&&", 
  RowBox[{"D1", "<", "K1"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"0", "<", "D1"}], "&&", 
      RowBox[{"0", "<", "s1"}], "&&", 
      RowBox[{"s1", "\[LessEqual]", 
       FractionBox["M21", 
        RowBox[{"K1", "+", "M21"}]]}]}], ")"}], "||", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["M21", 
        RowBox[{"K1", "+", "M21"}]], "<", "s1"}], "&&", 
      RowBox[{"s1", "<", "1"}], "&&", 
      RowBox[{
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "K1", " ", "M21", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "s1"}], ")"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["M21", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "s1"}], ")"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["K1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "s1"}], ")"}], " ", "s1"}]}], ")"}], 
          "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "s1"}], ")"}], " ", "s1"}], ")"}]}], 
         ")"}]}], "\[LessEqual]", "D1"}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.740317485233614*^9, 3.740317499032968*^9}, 
   3.740318976989425*^9}]
}, Open  ]],

Cell[TextData[{
 "Simplify   ",
 Cell[BoxData[
  RowBox[{"D1", " ", "<", " ", 
   SqrtBox[
    FractionBox[
     RowBox[{
      RowBox[{"2", " ", "K1", " ", "M21", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "s1"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["M21", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "s1"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["K1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "s1"}], ")"}], " ", "s1"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "s1"}], ")"}], " ", "s1"}]]]}]],
  CellChangeTimes->{{3.740317485233614*^9, 3.740317499032968*^9}}],
 "   to obtain condition (8) in the main text."
}], "Text",
 CellChangeTimes->{{3.7403177072209244`*^9, 3.7403178030344524`*^9}, {
  3.7403189820526342`*^9, 3.74031898474065*^9}, {3.7403205484148636`*^9, 
  3.7403205496339545`*^9}}],

Cell[TextData[{
 "\n",
 StyleBox["Fig. 7A",
  FontWeight->"Bold"],
 ":"
}], "Text",
 CellChangeTimes->{{3.740317553798067*^9, 3.740317558095891*^9}, 
   3.7403176223269033`*^9, 3.7485365095130596`*^9, 3.760522449981091*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=."}], ";", " ", 
  RowBox[{"MM", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DD", "=", "   ", 
    RowBox[{"\[Sqrt]", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "-", "s1"}], ")"}], " ", "s1"}]], "  ", "-", "  ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "-", "s1"}], ")"}], " ", "s1"}]], " ", "-", " ", 
          "1"}], ")"}], "*", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "MM"}], ")"}], "2"]}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"DD", "/.", 
      RowBox[{"s1", "\[Rule]", "0.1"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"MM", ",", "0", ",", "0.45"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Blue"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"DD", "/.", 
      RowBox[{"s1", "\[Rule]", "0.2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"MM", ",", "0", ",", "0.5"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Orange"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"DD", "/.", 
      RowBox[{"s1", "\[Rule]", "0.3"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"MM", ",", "0", ",", "0.5"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Darker", "[", "Green", "]"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", "#"}], ")"}]}], ",", "0"}], "}"}], "}"}], "&"}],
       "/@", 
      RowBox[{"{", 
       RowBox[{"0.1", ",", "0.2", ",", "0.3"}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"PointSize", "[", "0.02", "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"Blue", ",", "Orange", ",", 
          RowBox[{"Darker", "[", "Green", "]"}]}], "}"}]}], "}"}]}]}], 
    "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7403178373049507`*^9, 3.740317878065178*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Supporting Information", "Section",
 CellChangeTimes->{{3.7485330836450863`*^9, 3.7485330965529995`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Stability analysis with density-dependent population dynamics\
\>", "Subsection",
 CellChangeTimes->{{3.740145565926059*^9, 3.740145600182223*^9}, {
  3.748533137602827*^9, 3.748533159424987*^9}, {3.7485332284009495`*^9, 
  3.7485332360171766`*^9}}],

Cell[TextData[{
 "To simplify the long and extensive computations, we restrict this analysis \
to the case of symmetric migration, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "12"], "=", 
    RowBox[{
     SubscriptBox["m", "21"], "=", "m"}]}], TraditionalForm]]],
 ", and symmetric niche sizes, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["K", "1"], "=", 
    RowBox[{
     SubscriptBox["K", "2"], "=", 
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", "K", "  ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"which", " ", "corresponds", " ", "to", "  ", 
          SubscriptBox["K", "1"]}], "+", 
         SubscriptBox["K", "2"]}], "=", 
        RowBox[{
         RowBox[{"K", " ", "and", " ", 
          SubscriptBox["c", "i"]}], "=", 
         RowBox[{
          RowBox[{
           SubscriptBox["K", "i"], "/", "K"}], "=", 
          RowBox[{"1", "/", "2"}]}]}]}]}]}]}]}], TraditionalForm]]],
 Cell[BoxData[
  FormBox[
   RowBox[{")", "."}], TraditionalForm]]],
 "\n\nAs long as the growth rates are small enough, such that the ecological \
dynamics lead to constant population sizes, the population densities converge \
to ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["K", "1"], "=", 
    RowBox[{
     SubscriptBox["c", "1"], "K"}]}], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["K", "2"], "=", " "}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["c", "2"], "K"}], TraditionalForm]]],
 ", in niche 1 and 2 respectively. In this regime (without  fluctuations, and \
for symmetric migration), the values of selection determine whether the \
evolutionary dynamics lead to a polymorphic equilibrium or to fixation of one \
of the two types. Hence, we conduct the stability analysis for the following \
equilibria and combine the results as needed.\n-   ( p1p2Equilibrium[s1, s2, \
m12, m21, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["c", "1"], TraditionalForm]]],
 "], ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["c", "1"], TraditionalForm]]],
 "K, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["c", "2"], TraditionalForm]]],
 "K )\n-   ( 1, 1, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["c", "1"], TraditionalForm]]],
 "K, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["c", "2"], TraditionalForm]]],
 "K )\n-   ( 0, 0, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["c", "1"], TraditionalForm]]],
 "K, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["c", "2"], TraditionalForm]]],
 "K )"
}], "Text",
 CellChangeTimes->{{3.7402440870070686`*^9, 3.7402441785553827`*^9}, {
   3.740244213586492*^9, 3.740244307207987*^9}, 3.7402832179386907`*^9, {
   3.7402834138030715`*^9, 3.740283420976519*^9}, {3.7402836950618515`*^9, 
   3.740283749351734*^9}, {3.740283908492844*^9, 3.7402840651475935`*^9}, {
   3.74028412986086*^9, 3.7402841364555817`*^9}, {3.7402841721810875`*^9, 
   3.7402843110693836`*^9}, {3.7402843569687395`*^9, 
   3.7402843920579777`*^9}, {3.740284492840307*^9, 3.7402846996306515`*^9}, {
   3.740284753018307*^9, 3.7402848571356907`*^9}, {3.740284890188546*^9, 
   3.740284892157686*^9}, {3.748533443057846*^9, 3.748533603490177*^9}, {
   3.7485336464185667`*^9, 3.7485337485986776`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"c1", "=", 
   RowBox[{"1", "/", "2"}]}], ";", 
  RowBox[{"c2", "=", 
   RowBox[{"1", "-", "c1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CompleteModel1Generation", "[", 
    RowBox[{
    "s1_", ",", "s2_", ",", "m_", ",", "p1_", ",", "p2_", ",", "N1_", ",", 
     "N2_", " ", ",", "r1_", ",", "r2_", ",", "kk_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "m"}], ")"}], "p1", " ", "N1"}], "+", 
         RowBox[{"m", " ", "p2", " ", "N2"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "m"}], ")"}], "N1"}], "+", 
         RowBox[{"m", " ", "N2"}]}]], "*", 
       FractionBox["w1A", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m"}], ")"}], "p1", " ", "N1"}], "+", 
            RowBox[{"m", " ", "p2", " ", "N2"}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m"}], ")"}], "N1"}], "+", 
            RowBox[{"m", " ", "N2"}]}]], "*", "w1A"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "m"}], ")"}], "p1", " ", "N1"}], "+", 
              RowBox[{"m", " ", "p2", " ", "N2"}]}], 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "m"}], ")"}], "N1"}], "+", 
              RowBox[{"m", " ", "N2"}]}]]}], ")"}], "*", "w1a"}]}]]}], ",", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "m"}], ")"}], "p2", " ", "N2"}], "+", 
         RowBox[{"m", " ", "p1", " ", "N1"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "m"}], ")"}], "N2"}], "+", 
         RowBox[{"m", " ", "N1"}]}]], "*", 
       FractionBox["w2A", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m"}], ")"}], "p2", " ", "N2"}], "+", 
            RowBox[{"m", " ", "p1", " ", "N1"}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m"}], ")"}], "N2"}], "+", 
            RowBox[{"m", " ", "N1"}]}]], "*", "w2A"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "m"}], ")"}], "p2", " ", "N2"}], "+", 
              RowBox[{"m", " ", "p1", " ", "N1"}]}], 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "m"}], ")"}], "N2"}], "+", 
              RowBox[{"m", " ", "N1"}]}]]}], ")"}], "*", "w2a"}]}]]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "m"}], ")"}], "N1"}], "+", 
         RowBox[{"m", " ", "N2"}]}], ")"}], 
       RowBox[{"Exp", "[", " ", 
        RowBox[{"r1", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "m"}], ")"}], "N1"}], "+", 
             RowBox[{"m", " ", "N2"}]}], 
            RowBox[{"c1", " ", "kk"}]]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "m"}], ")"}], "p1", " ", "N1"}], "+", 
              RowBox[{"m", " ", "p2", " ", "N2"}]}], 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "m"}], ")"}], "N1"}], "+", 
              RowBox[{"m", " ", "N2"}]}]], "*", "w1A"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m"}], ")"}], "p1", " ", "N1"}], "+", 
                RowBox[{"m", " ", "p2", " ", "N2"}]}], 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m"}], ")"}], "N1"}], "+", 
                RowBox[{"m", " ", "N2"}]}]]}], ")"}], "*", "w1a"}]}], ")"}]}],
         "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "m"}], ")"}], "N2"}], "+", 
         RowBox[{"m", " ", "N1"}]}], ")"}], " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"r2", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "m"}], ")"}], " ", "N2"}], "+", 
             RowBox[{"m", " ", "N1"}]}], 
            RowBox[{"c2", " ", "kk"}]]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "m"}], ")"}], "p2", " ", "N2"}], "+", 
              RowBox[{"m", " ", "p1", " ", "N1"}]}], 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "m"}], ")"}], "N2"}], "+", 
              RowBox[{"m", " ", "N1"}]}]], "*", "w2A"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m"}], ")"}], "p2", " ", "N2"}], "+", 
                RowBox[{"m", " ", "p1", " ", "N1"}]}], 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m"}], ")"}], "N2"}], "+", 
                RowBox[{"m", " ", "N1"}]}]]}], ")"}], "*", "w2a"}]}], ")"}]}],
         "]"}]}]}], "}"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"w1A", "\[Rule]", "1"}], ",", 
      RowBox[{"w1a", "\[Rule]", 
       RowBox[{"1", "-", "s1"}]}], ",", 
      RowBox[{"w2A", "\[Rule]", 
       RowBox[{"1", "-", "s2"}]}], ",", 
      RowBox[{"w2a", "\[Rule]", "1"}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7402834448708267`*^9, 3.7402834720206175`*^9}}],

Cell["Start by computing the Jacobian matrix:", "Text",
 CellChangeTimes->{{3.7402835710731125`*^9, 3.740283582450068*^9}, 
   3.7403220126608973`*^9, 3.7403242100171456`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=."}], ";", 
  RowBox[{"s2", "=."}], ";", 
  RowBox[{"m", "=."}], ";", 
  RowBox[{"p1", "=."}], ";", 
  RowBox[{"p2", "=."}], ";", 
  RowBox[{"N1", "=."}], ";", 
  RowBox[{"N2", "=."}], ";", 
  RowBox[{"r1", "=."}], ";", 
  RowBox[{"r2", "=."}], ";", 
  RowBox[{"kk", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jac", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"CompleteModel1Generation", "[", 
         RowBox[{
         "s1", ",", "s2", ",", "m", ",", "p1", ",", "p2", ",", "N1", ",", 
          "N2", ",", "r1", ",", "r2", ",", "kk"}], "]"}], ",", "#"}], "]"}], 
      "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2", ",", "N1", ",", "N2"}], "}"}]}], "//", 
    "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.74028358907635*^9, 3.7402836389862556`*^9}, 
   3.7402849934286337`*^9}],

Cell["1. Stability of 1/2K with polymorphic equilibrium:", "Text",
 CellChangeTimes->{
  3.740244236851494*^9, {3.7402443846138935`*^9, 3.7402443890520334`*^9}, {
   3.740283415772091*^9, 3.740283417038186*^9}, {3.7402850256530848`*^9, 
   3.740285057736701*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"jacPoly", "=", 
   RowBox[{
    RowBox[{"jac", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", "\[Rule]", 
        RowBox[{
        "p1p2Equilibrium", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"p2", "\[Rule]", 
        RowBox[{
        "p1p2Equilibrium", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"N1", "\[Rule]", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "kk"}]}], ",", 
       RowBox[{"N2", "\[Rule]", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "kk"}]}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EVcompletePoly", "=", 
   RowBox[{
    RowBox[{"Eigenvalues", "[", "jacPoly", "]"}], "//", "Simplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7402851214837914`*^9, 3.7402852156396427`*^9}, {
  3.7402852681184993`*^9, 3.7402853286041307`*^9}, {3.740295170261036*^9, 
  3.7402951747303905`*^9}}],

Cell["2. Stability of 1/2K with monomorphic equilibria:", "Text",
 CellChangeTimes->{
  3.740285062612488*^9, {3.7402854027117376`*^9, 3.7402854189796195`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"jacOne", "=", 
   RowBox[{
    RowBox[{"jac", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", "\[Rule]", "1"}], ",", 
       RowBox[{"p2", "\[Rule]", "1"}], ",", 
       RowBox[{"N1", "\[Rule]", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "kk"}]}], ",", 
       RowBox[{"N2", "\[Rule]", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "kk"}]}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EVcompleteOne", "=", 
   RowBox[{
    RowBox[{"Eigenvalues", "[", "jacOne", "]"}], "//", "Simplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7402854523610573`*^9, 3.7402854774937305`*^9}, {
  3.7402855087488475`*^9, 3.7402855254392796`*^9}, {3.740285586480404*^9, 
  3.7402855890599537`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"jacZero", "=", 
   RowBox[{
    RowBox[{"jac", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", "\[Rule]", "0"}], ",", 
       RowBox[{"p2", "\[Rule]", "0"}], ",", 
       RowBox[{"N1", "\[Rule]", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "kk"}]}], ",", 
       RowBox[{"N2", "\[Rule]", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "kk"}]}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EVcompleteZero", "=", 
   RowBox[{
    RowBox[{"Eigenvalues", "[", "jacZero", "]"}], "//", "Simplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7402855586009655`*^9, 3.7402856140326786`*^9}}],

Cell[TextData[{
 "Any of these computations yields extremely long and complex expression for \
four eigenvalues. Thus, we choose to analyze them visually using the \
ContourPlot function. When doing so, we see that there are two leading \
eigenvalues per equilibrium:\n- in EVcompletePoly only second and third \
eigenvalue are of interest\n- in EVcompleteOne it\[CloseCurlyQuote]s the \
first and third eigenvalue\n- and in EVcompleteZero only first and third \
eigenvalue are important.\n\nNow, these eigenvalues describe different \
effects:\n",
 StyleBox["EVcompletePoly[[2]]",
  FontVariations->{"Underline"->True}],
 ", ",
 StyleBox["EVcompleteOne[[3]]",
  FontVariations->{"Underline"->True}],
 " and ",
 StyleBox["EVcompleteZero[[3]]",
  FontVariations->{"Underline"->True}],
 " determine the stability of the evolutionary equilibrium as a function of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["s", "1"], ",", " ", 
    SubscriptBox["s", "2"]}], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]]],
 " given that the ecological dynamics lead to stable population sizes 1/2K: \
these eigenvalues capture the direct effects of selection and migration on \
polymorphism/monomorphism. I.e.\n- as long as | EVcompletePoly[[2]] | < 1, \
polymorphism is stable\n- when | EVcompleteOne[[3]] | < 1, then 1 (fixation \
of ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]]],
 ") is stable\n- | EVcompleteZero[[3]] | < 1 implies stability of 0 (fixation \
of ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]]],
 ")\nEVcompleteOne[[3]] and EVcompleteZero[[3]] combined, yield the same \
picture as EVcompletePoly[[2]]: here, instability of the monomorphisms is \
equivalent to stability of the polymorphism (system of haploids in two demes: \
protected polymorphism <=> stable polymorphism). So, for the further analysis \
it suffices to consider EVcompletePoly[[2]]."
}], "Text",
 CellChangeTimes->{{3.7402859412421923`*^9, 3.7402860657817755`*^9}, {
   3.7402862126747384`*^9, 3.7402862283347473`*^9}, {3.7402863209484644`*^9, 
   3.7402864792967167`*^9}, {3.7402871027399797`*^9, 3.740287108194248*^9}, {
   3.7402871646452007`*^9, 3.7402871664890385`*^9}, {3.740287254884645*^9, 
   3.7402872776081066`*^9}, {3.74028731134888*^9, 3.7402874547695684`*^9}, {
   3.74028748938352*^9, 3.7402875289578733`*^9}, {3.7402875783597045`*^9, 
   3.74028763943175*^9}, {3.740287913785874*^9, 3.740287945837696*^9}, 
   3.7402879773584146`*^9, {3.740288039759884*^9, 3.7402881157940674`*^9}, {
   3.7402881476272593`*^9, 3.740288154597416*^9}, {3.7402881854463577`*^9, 
   3.7402882148261404`*^9}, {3.7402883052510757`*^9, 
   3.7402883274890585`*^9}, {3.740288506744499*^9, 3.740288537765437*^9}, {
   3.7402885709433327`*^9, 3.7402886577744846`*^9}, {3.740288915015895*^9, 
   3.740288945165245*^9}, {3.7402889805153484`*^9, 3.740289429915993*^9}, {
   3.7402894791124873`*^9, 3.740289539079132*^9}, {3.7402895850088224`*^9, 
   3.740289774845314*^9}, {3.7402898051016345`*^9, 3.7402898244023995`*^9}, {
   3.7402898960519753`*^9, 3.740289896348813*^9}, {3.7402899533770113`*^9, 
   3.74029007080819*^9}, {3.740290161619874*^9, 3.7402901904995832`*^9}, {
   3.7402902906294947`*^9, 3.740290300615713*^9}, {3.7402903340432525`*^9, 
   3.7402904247503557`*^9}, {3.7402904618971324`*^9, 3.740290481195373*^9}, {
   3.7402920908240285`*^9, 3.7402921398731847`*^9}, {3.740292319812454*^9, 
   3.7402923231094446`*^9}, {3.7402932574523153`*^9, 
   3.7402932593898115`*^9}, {3.7403199781016045`*^9, 3.7403199907443485`*^9}}],

Cell["\<\
Remark: EVcompletePoly[[2]] coincides with the leading eigenvalue of the \
\[OpenCurlyDoubleQuote]evolution only\[CloseCurlyDoubleQuote] Jacobi matrix \
(see above):\
\>", "Text",
 CellChangeTimes->{{3.740290491321845*^9, 3.7402904977442713`*^9}, {
  3.740320066589758*^9, 3.74032007406028*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=."}], ";", 
  RowBox[{"s2", "=."}], ";", 
  RowBox[{"m", "=."}], ";", 
  RowBox[{"m12", "=", "m"}], ";", 
  RowBox[{"m21", "=", "m"}], ";", 
  RowBox[{"c1", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EVEvoOnly", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Eigenvalues", "[", 
       RowBox[{"jacobi", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"p1", "\[Rule]", 
           RowBox[{
           "p1p2Equilibrium", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"p2", "\[Rule]", 
           RowBox[{
           "p1p2Equilibrium", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], 
      "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "//", 
     "Simplify"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
    "EVcompletePoly", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
    "\[Equal]", "EVEvoOnly"}], "&&", 
   RowBox[{"0", "<", "s1", "<", "1"}], "&&", 
   RowBox[{"0", "<", "s2", "<", "1"}], "&&", 
   RowBox[{"0", "<", "m", "<", 
    RowBox[{"1", "/", "2"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7208528539580493`*^9, 3.720852879449691*^9}, {
   3.720852914828968*^9, 3.7208529955024157`*^9}, 3.7402976307773256`*^9, {
   3.740297674269251*^9, 3.7402976928036594`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"0", "<", "m", "<", 
   FractionBox["1", "2"]}], "&&", 
  RowBox[{"0", "<", "s2", "<", "1"}], "&&", 
  RowBox[{"0", "<", "s1", "<", "1"}]}]], "Output",
 CellChangeTimes->{3.720852909702737*^9, 3.7208530319174547`*^9, 
  3.7402925017254763`*^9, 3.7402936036014767`*^9, 3.740297063255637*^9, 
  3.7402976539506583`*^9}]
}, Open  ]],

Cell[TextData[{
 StyleBox["Fig. S1",
  FontWeight->"Bold"],
 " is a visualization of EVcompletePoly[[2]] (and the simple condition \
obtained with evolution only):"
}], "Text",
 CellChangeTimes->{{3.7402958804666133`*^9, 3.740295882279457*^9}, {
  3.7402959825431595`*^9, 3.740296124568136*^9}, {3.748533218116415*^9, 
  3.7485332187343063`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=."}], ";", 
  RowBox[{"s2", "=."}], ";", 
  RowBox[{"m", "=."}], ";", 
  RowBox[{"r1", "=", "1"}], ";", 
  RowBox[{"r2", "=", "1"}], ";", 
  RowBox[{"kk", "=", "50"}], ";", " ", 
  RowBox[{"c1", "=", 
   RowBox[{"1", "/", "2"}]}], ";", " ", 
  RowBox[{"m01", "=", "0.1"}], ";", " ", 
  RowBox[{"m04", "=", "0.4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsGrid", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"ContourPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
            "EVcompletePoly", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], "/.", 
            RowBox[{"{", 
             RowBox[{"m", "\[Rule]", " ", "0.1"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s1", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s2", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"ContourStyle", "\[Rule]", "None"}], ",", 
          RowBox[{"Contours", "\[Rule]", 
           RowBox[{"{", "1", "}"}]}], ",", " ", 
          RowBox[{"ContourShading", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"LightGray", ",", "White"}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ContourPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "EVcompletePoly", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"m", "\[Rule]", " ", "0.1"}], "}"}]}], ")"}], 
            "\[Equal]", "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s1", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s2", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"ContourStyle", "\[Rule]", "Gray"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ContourPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"m01", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1", "/", "s1"}], "-", 
               RowBox[{"1", "/", "s2"}]}], ")"}]}], "]"}], "\[Equal]", 
           RowBox[{"1", "-", "m01"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"s1", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s2", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"ContourStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Black", ",", 
             RowBox[{"Dashing", "[", "Large", "]"}]}], "}"}]}]}], "]"}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"ContourPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
            "EVcompletePoly", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], "/.", 
            RowBox[{"{", 
             RowBox[{"m", "\[Rule]", " ", "0.4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s1", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s2", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"ContourStyle", "\[Rule]", "None"}], ",", 
          RowBox[{"Contours", "\[Rule]", 
           RowBox[{"{", "1", "}"}]}], ",", " ", 
          RowBox[{"ContourShading", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"LightGray", ",", "White"}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ContourPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "EVcompletePoly", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"m", "\[Rule]", " ", "0.4"}], "}"}]}], ")"}], 
            "\[Equal]", "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s1", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s2", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"ContourStyle", "\[Rule]", "Gray"}]}], "]"}], ",", 
        RowBox[{"ContourPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"m04", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1", "/", "s1"}], "-", 
               RowBox[{"1", "/", "s2"}]}], ")"}]}], "]"}], "\[Equal]", 
           RowBox[{"1", "-", "m04"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"s1", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s2", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"ContourStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Black", ",", 
             RowBox[{"Dashing", "[", "Large", "]"}]}], "}"}]}]}], "]"}]}], 
       "]"}]}], "}"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7402983394083195`*^9, 3.7402984080486126`*^9}, {
  3.7402984413666763`*^9, 3.740298527411987*^9}}],

Cell[TextData[{
 "\n",
 StyleBox["EVcompletePoly[[3]]",
  FontVariations->{"Underline"->True}],
 ", ",
 StyleBox["EVcompleteOne[[1]]",
  FontVariations->{"Underline"->True}],
 " and ",
 StyleBox["EVcompleteZero[[1]]",
  FontVariations->{"Underline"->True}],
 " determine the stability of 1/2K, i.e. the stability of the population \
dynamics given that the corresponding evolutionary equilibrium (polymorphism, \
one, zero) is stable:\n- when the evolutionary dynamics lead to a polymorphic \
equilibrium, EVcompletePoly[[3]] tells us about the first branching point of \
the population dynamics,\n- when the evolutionary dynamics lead to fixation \
of either allele ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]]],
 " or allele ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]]],
 ", then the stability of the population dynamics is given by \
EVcompleteOne[[1]] or EVcompleteZero[[1]], respectively."
}], "Text",
 CellChangeTimes->{
  3.7402905023542256`*^9, {3.740291949549251*^9, 3.7402919604254284`*^9}, {
   3.74029199216158*^9, 3.740292052258315*^9}, {3.740293332191595*^9, 
   3.7402934620929866`*^9}, {3.740293500833876*^9, 3.7402935190121017`*^9}, {
   3.7403201464807673`*^9, 3.7403201466213803`*^9}}],

Cell[TextData[{
 "This leads us to ",
 StyleBox["Fig. S4",
  FontWeight->"Bold"],
 ":\nIn (A)---(D), the trade-off in selection is symmetric and, thus, \
evolutionary dynamics always converge to a polymorphic equilibrium as long as \
fluctuations are absent. Therefore, it suffices to plot EVcompletePoly[[3]] \
to obtain information about the first branching point of the system."
}], "Text",
 CellChangeTimes->{{3.7402958458206377`*^9, 3.7402958709654446`*^9}, {
  3.740298565966496*^9, 3.740298580562783*^9}, {3.7402986260888977`*^9, 
  3.740298920646032*^9}, {3.748533277798078*^9, 3.748533278362353*^9}}],

Cell["E.g. Fig. S4B:", "Text",
 CellChangeTimes->{{3.740298956631266*^9, 3.7402989763065605`*^9}, {
  3.7485333340047226`*^9, 3.748533334622718*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=", "0.01"}], ";", 
  RowBox[{"s2", "=", "0.01"}], ";", 
  RowBox[{"m", "=", "0.4"}], ";", 
  RowBox[{"r1", "=."}], ";", 
  RowBox[{"r2", "=."}], ";", 
  RowBox[{"kk", "=", "50"}], ";", " ", 
  RowBox[{"c1", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
      "EVcompletePoly", "\[LeftDoubleBracket]", "3", 
       "\[RightDoubleBracket]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"r1", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r2", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"ContourLabels", "\[Rule]", "None"}], ",", 
     RowBox[{"Contours", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"-", "1"}], "}"}]}], ",", " ", 
     RowBox[{"ContourShading", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"White", ",", "LightGray"}], "}"}]}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", "None"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{
       "EVcompletePoly", "\[LeftDoubleBracket]", "3", 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"r1", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r2", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", "Gray"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"r1", "\[Equal]", "2"}], ",", 
     RowBox[{"{", 
      RowBox[{"r1", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r2", ",", "0", ",", "2"}], "}"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Gray", ",", 
        RowBox[{"Thickness", "[", "0.0065", "]"}], ",", 
        RowBox[{"Dashing", "[", 
         RowBox[{"{", 
          RowBox[{"0.01", ",", "0.055"}], "}"}], "]"}]}], "}"}]}]}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"r2", "\[Equal]", "2"}], ",", 
     RowBox[{"{", 
      RowBox[{"r1", ",", "0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r2", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Gray", ",", 
        RowBox[{"Thickness", "[", "0.0065", "]"}], ",", 
        RowBox[{"Dashing", "[", 
         RowBox[{"{", 
          RowBox[{"0.01", ",", "0.055"}], "}"}], "]"}]}], "}"}]}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7402990176908655`*^9, 3.7402990321937714`*^9}, {
  3.7402990637151995`*^9, 3.7402991977890816`*^9}}],

Cell["E.g. Fig. S4D:", "Text",
 CellChangeTimes->{{3.7402993110422163`*^9, 3.7402993141997404`*^9}, {
  3.748533337880966*^9, 3.748533338605939*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=."}], ";", 
  RowBox[{"s2", "=."}], ";", 
  RowBox[{"m", "=."}], ";", 
  RowBox[{"r1", "=."}], ";", 
  RowBox[{"r2", "=."}], ";", 
  RowBox[{"kk", "=."}], ";", " ", 
  RowBox[{"c1", "=."}], ";", " ", 
  RowBox[{"s", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EVcompletePolySymmSel", " ", "=", " ", 
   RowBox[{
    RowBox[{
    "EVcompletePoly", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
    "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"s1", "\[Rule]", " ", "s"}], ",", 
      RowBox[{"s2", "\[Rule]", "s"}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.740299341752534*^9, 3.740299352144727*^9}, {
  3.7402993850428343`*^9, 3.740299409968119*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "0.4"}], ";", " ", 
  RowBox[{"r2", "=", "1"}], ";", 
  RowBox[{"kk", "=", "50"}], ";", " ", 
  RowBox[{"c1", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", "EVcompletePolySymmSel", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r1", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"ContourLabels", "\[Rule]", "None"}], ",", 
     RowBox[{"Contours", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"-", "1"}], "}"}]}], ",", " ", 
     RowBox[{"ContourShading", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"White", ",", "LightGray"}], "}"}]}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", "None"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"EVcompletePolySymmSel", "\[Equal]", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r1", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", "Gray"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7402994227669973`*^9, 3.7402995217832794`*^9}}],

Cell["\<\
In (E) and (F), we keep one of the selection coefficients fixed, while \
varying the other. Therefore, the evolutionary equilibrium does not always \
converge to polymorphism anymore. If the asymmetry in selection is too \
strong, allele frequencies converge to fixation of one type. Hence, we have \
to plot a combination of EVcompletePoly[[3]], EVcompleteOne[[1]] and \
EVcompleteZero[[1]]. Which eigenvalue applies where, is determined by \
EVcompletePoly[[2]] (the stability of the evolutionary dynamics).\
\>", "Text",
 CellChangeTimes->{{3.7402995538054876`*^9, 3.740299605204764*^9}, {
  3.7402996668135023`*^9, 3.740299745515641*^9}, {3.740299778818763*^9, 
  3.74029985524074*^9}, {3.7403000013672404`*^9, 3.740300086259525*^9}, {
  3.740320220403495*^9, 3.7403202315621815`*^9}}],

Cell["E.g. Fig. S4E:", "Text",
 CellChangeTimes->{{3.7403001069822693`*^9, 3.7403001252505865`*^9}, {
  3.748533354224988*^9, 3.748533354949791*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=."}], ";", 
  RowBox[{"s2", "=", "0.3"}], ";", 
  RowBox[{"m", "=", "0.4"}], ";", 
  RowBox[{"kk", "=", "50"}], ";", 
  RowBox[{"c1", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
    "EVcompletePoly", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
    "\[Equal]", "1"}], ",", "s1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.740304955838171*^9, 3.7403049928015623`*^9}, 
   3.7403050324821305`*^9, 3.7403050819156094`*^9, {3.740305152880764*^9, 
   3.7403051538063955`*^9}, 3.7403054142415905`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"s1", "\[Rule]", 
     RowBox[{"-", "0.05327420568864557`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"s1", "\[Rule]", "0.20689655172413954`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"s1", "\[Rule]", "0.5454545454545419`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7403050357010813`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lower", "=", "0.20689655172413"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"upper", "=", "0.54545454545454"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7403051802165213`*^9, 3.7403052412425785`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "EVcompletePoly", "\[LeftDoubleBracket]", "3", 
       "\[RightDoubleBracket]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "\[Rule]", "lower"}], ",", 
        RowBox[{"s2", "\[Rule]", "0.3"}], ",", 
        RowBox[{"m", "\[Rule]", " ", "0.4"}], ",", " ", 
        RowBox[{"r2", "\[Rule]", "1"}]}], "}"}]}], ")"}], "\[Equal]", 
    RowBox[{"-", "1"}]}], ",", "r1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "EVcompletePoly", "\[LeftDoubleBracket]", "3", 
       "\[RightDoubleBracket]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "\[Rule]", "upper"}], ",", 
        RowBox[{"s2", "\[Rule]", "0.3"}], ",", 
        RowBox[{"m", "\[Rule]", " ", "0.4"}], ",", " ", 
        RowBox[{"r2", "\[Rule]", "1"}]}], "}"}]}], ")"}], "\[Equal]", 
    RowBox[{"-", "1"}]}], ",", "r1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7236457821758757`*^9, 3.7236457955374994`*^9}, {
  3.7236458522240086`*^9, 3.723645887637169*^9}, {3.723645950211491*^9, 
  3.7236459747156253`*^9}, {3.7236460268067493`*^9, 3.7236460279005775`*^9}, {
  3.723646103149597*^9, 3.7236461049312725`*^9}, {3.740305412553571*^9, 
  3.7403054412608123`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"r1", "\[Rule]", 
     RowBox[{"-", "1.3877174432892554`*^11"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"r1", "\[Rule]", "3.3623188406304783`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.723646083161442*^9, 3.723646105915608*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r1", "\[Rule]", "2.7878787877539657`"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.723646083161442*^9, 3.7236461060406036`*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Rlower", "=", "3.3623188406304783"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rupper", "=", "2.7878787877539657"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7403054960048237`*^9, 3.740305558801066*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s2", "=", "0.3"}], ";", " ", 
  RowBox[{"m", "=", "0.4"}], ";", " ", 
  RowBox[{"r2", "=", "1"}], ";", 
  RowBox[{"kk", "=", "50"}], ";", 
  RowBox[{"c1", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
      "EVcompletePoly", "\[LeftDoubleBracket]", "3", 
       "\[RightDoubleBracket]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s1", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r1", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", "None"}], ",", 
     RowBox[{"Contours", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"-", "1"}], "}"}]}], ",", " ", 
     RowBox[{"ContourShading", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"White", ",", "LightGray"}], "}"}]}], ",", 
     RowBox[{"RegionFunction", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s1", ",", "r1"}], "}"}], ",", 
        RowBox[{"lower", "<", "s1", "<", "upper"}]}], "]"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{
       "EVcompletePoly", "\[LeftDoubleBracket]", "3", 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s1", ",", "lower", ",", "upper"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r1", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", "Gray"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
      "EVcompleteZero", "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s1", ",", "0", ",", "lower"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r1", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", "None"}], ",", 
     RowBox[{"Contours", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"-", "1"}], "}"}]}], ",", " ", 
     RowBox[{"ContourShading", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"White", ",", "LightGray"}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{
       "EVcompleteZero", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s1", ",", "0", ",", "lower"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r1", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", " ", "Gray"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
      "EVcompleteOne", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s1", ",", "upper", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r1", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", "None"}], ",", 
     RowBox[{"Contours", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"-", "1"}], "}"}]}], ",", " ", 
     RowBox[{"ContourShading", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"White", ",", "LightGray"}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{
       "EVcompleteOne", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s1", ",", "upper", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r1", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", " ", "Gray"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{
       "EVcompletePoly", "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s1", ",", "0", ",", 
       RowBox[{"lower", "+", "0.05"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r1", ",", "0", ",", "Rlower"}], "}"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Gray", ",", 
        RowBox[{"Dashing", "[", 
         RowBox[{"{", 
          RowBox[{"0.05", ",", "0.09"}], "}"}], "]"}]}], "}"}]}]}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{
       "EVcompletePoly", "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s1", ",", 
       RowBox[{"upper", "-", "0.05"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r1", ",", "0", ",", "Rupper"}], "}"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Gray", ",", 
        RowBox[{"Dashing", "[", 
         RowBox[{"{", 
          RowBox[{"0.05", ",", "0.09"}], "}"}], "]"}]}], "}"}]}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.740300170710884*^9, 3.7403003240206327`*^9}, {
   3.7403003916470623`*^9, 3.740300398663666*^9}, {3.7403052554318857`*^9, 
   3.7403053199443045`*^9}, {3.7403055777107925`*^9, 3.7403055833684263`*^9}, 
   3.740306055425288*^9}],

Cell["\<\

Fig. S5 gives an explanation for the shape of the stability region in Fig. \
S4E and F. This is how it is generated:\
\>", "Text",
 CellChangeTimes->{{3.7619464323767586`*^9, 3.7619465034236975`*^9}, {
  3.761946795291148*^9, 3.7619468030115337`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"m", "=."}], ";", 
   RowBox[{"p1", "=."}], ";", 
   RowBox[{"p2", "=."}], ";", 
   RowBox[{"s1", "=."}], ";", 
   RowBox[{"s2", "=."}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"W1", "[", 
     RowBox[{"m_", ",", "p1_", ",", "p2_", ",", "s1_", ",", "s2_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "m"}], ")"}], "p1"}], "+", 
     RowBox[{"m", " ", "p2"}], "  ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "m"}], ")"}], "p1"}], " ", "+", 
          RowBox[{"m", " ", "p2"}]}], " ", ")"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "s1"}], ")"}]}]}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Mean", " ", "fitness", " ", "after", " ", "migration", " ", "in", " ", 
    "niche", " ", "1"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"W2", "[", 
    RowBox[{"m_", ",", "p1_", ",", "p2_", ",", "s1_", ",", "s2_"}], "]"}], ":=",
    " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "m"}], ")"}], "p2"}], " ", "+", 
       RowBox[{"m", " ", "p1"}]}], " ", ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "s2"}], ")"}]}], "  ", "+", "  ", "1", "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "m"}], ")"}], "p2"}], " ", "+", 
      RowBox[{"m", " ", "p1"}]}], " ", ")"}]}]}], ";", "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Mean", " ", "fitness", " ", "after", " ", "migration", " ", "in", " ", 
    "niche", " ", "2"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"P1Poly", "[", 
    RowBox[{"m_", ",", "s1_", ",", "s2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s1", " ", "s2"}], "-", 
      RowBox[{"2", " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "s1"}], ")"}], " ", "s2"}], "+", 
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "s2"}], ")"}]}], "+", 
         RowBox[{"3", " ", "s2"}]}], ")"}]}], "+", 
      RowBox[{"\[Sqrt]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["s1", "2"], " ", 
          SuperscriptBox["s2", "2"]}], "-", 
         RowBox[{"4", " ", "m", " ", 
          SuperscriptBox["s1", "2"], " ", 
          SuperscriptBox["s2", "2"]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["m", "3"], " ", "s1", " ", "s2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "s1", "+", "s2", "-", 
            RowBox[{"s1", " ", "s2"}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["m", "4"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"s1", "+", "s2", "-", 
             RowBox[{"s1", " ", "s2"}]}], ")"}], "2"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["m", "2"], " ", "s1", " ", "s2", " ", 
          RowBox[{"(", 
           RowBox[{"2", "-", "s2", "+", 
            RowBox[{"s1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"3", " ", "s2"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "m"}]}], ")"}], " ", "s1", " ", "s2"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"P2Poly", "[", 
     RowBox[{"m_", ",", "s1_", ",", "s2_"}], "]"}], ":=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"3", " ", "m"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["m", "2"]}]}], ")"}], " ", "s1", " ", "s2"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"m", " ", "s1", " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"4", " ", "s2"}]}], ")"}]}], "+", 
       RowBox[{"s1", " ", "s2"}], "+", 
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "s1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "s2"}], ")"}]}], "+", "s2"}], ")"}]}], 
       "-", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["s1", "2"], " ", 
           SuperscriptBox["s2", "2"]}], "-", 
          RowBox[{"4", " ", "m", " ", 
           SuperscriptBox["s1", "2"], " ", 
           SuperscriptBox["s2", "2"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["m", "3"], " ", "s1", " ", "s2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "s1", "+", "s2", "-", 
             RowBox[{"s1", " ", "s2"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["m", "4"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"s1", "+", "s2", "-", 
              RowBox[{"s1", " ", "s2"}]}], ")"}], "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["m", "2"], " ", "s1", " ", "s2", " ", 
           RowBox[{"(", 
            RowBox[{"2", "-", "s2", "+", 
             RowBox[{"s1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"3", " ", "s2"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
      ")"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Equations", " ", "for", " ", "the", " ", 
     RowBox[{"(", "polymorphic", ")"}], " ", "equilibrium", " ", 
     "frequencies", " ", "of", " ", "the", " ", "focal", " ", "type", " ", 
     "in", " ", "both", " ", "niches", " ", "in", " ", "the", " ", "absence", 
     " ", "of", " ", "population", " ", "dynamics"}], " ", "-", " ", 
    RowBox[{
    "and", " ", "for", " ", "equal", " ", "niche", " ", "sizes", " ", "and", 
     " ", "symmetric", " ", "migration", " ", 
     RowBox[{"rates", ".", " ", "See"}], " ", "p1p2Equilibrium", " ", "in", 
     " ", "the", " ", "very", " ", "beginning", " ", "for", " ", "an", " ", 
     "explanation", " ", "of", " ", "where", " ", "this", " ", "comes", " ", 
     RowBox[{"from", "."}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"W1poly", "[", 
    RowBox[{"m_", ",", "s1_", ",", "s2_"}], "]"}], ":=", 
   RowBox[{"W1", "[", 
    RowBox[{"m", ",", 
     RowBox[{"P1Poly", "[", 
      RowBox[{"m", ",", "s1", ",", "s2"}], "]"}], ",", 
     RowBox[{"P2Poly", "[", 
      RowBox[{"m", ",", "s1", ",", "s2"}], "]"}], ",", "s1", ",", "s2"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"W2poly", "[", 
     RowBox[{"m_", ",", "s1_", ",", "s2_"}], "]"}], ":=", 
    RowBox[{"W2", "[", 
     RowBox[{"m", ",", 
      RowBox[{"P1Poly", "[", 
       RowBox[{"m", ",", "s1", ",", "s2"}], "]"}], ",", 
      RowBox[{"P2Poly", "[", 
       RowBox[{"m", ",", "s1", ",", "s2"}], "]"}], ",", "s1", ",", "s2"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Mean", " ", "fitnesses", " ", "after", " ", "migration", " ", "under", 
    " ", "a", " ", "polymorphic", " ", "equilibrium"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"W1fixed1", "[", 
    RowBox[{"m_", ",", "s1_", ",", "s2_"}], "]"}], ":=", 
   RowBox[{"W1", "[", 
    RowBox[{"m", ",", "1", ",", "1", ",", "s1", ",", "s2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"W2fixed1", "[", 
     RowBox[{"m_", ",", "s1_", ",", "s2_"}], "]"}], ":=", 
    RowBox[{"W2", "[", 
     RowBox[{"m", ",", "1", ",", "1", ",", "s1", ",", "s2"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Mean", " ", "fitnesses", " ", "after", " ", "migration", " ", "under", 
    " ", "fixation", " ", "of", " ", "the", " ", "focal", " ", "type"}], " ", 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"W1fixed0", "[", 
    RowBox[{"m_", ",", "s1_", ",", "s2_"}], "]"}], ":=", 
   RowBox[{"W1", "[", 
    RowBox[{"m", ",", "0", ",", "0", ",", "s1", ",", "s2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"W2fixed0", "[", 
    RowBox[{"m_", ",", "s1_", ",", "s2_"}], "]"}], ":=", 
   RowBox[{"W2", "[", 
    RowBox[{"m", ",", "0", ",", "0", ",", "s1", ",", "s2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Mean", " ", "fitnesses", " ", "after", " ", "migration", " ", "under", 
    " ", "fixation", " ", "of", " ", "the", " ", "other", " ", "type"}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.719387553438114*^9, 3.7193875667160425`*^9}, {
   3.7193876239973135`*^9, 3.7193876255439115`*^9}, {3.719387663920828*^9, 
   3.719387703322958*^9}, {3.71938781595928*^9, 3.7193878666393404`*^9}, {
   3.7193881349306517`*^9, 3.719388175855122*^9}, {3.719388291902507*^9, 
   3.7193883041366973`*^9}, {3.7193884495834465`*^9, 
   3.7193885847861147`*^9}, {3.719388633654217*^9, 3.719388790504529*^9}, {
   3.7193889436041684`*^9, 3.7193890841119785`*^9}, 3.719389128986991*^9, {
   3.7193893170435085`*^9, 3.7193893254692836`*^9}, {3.719389418766185*^9, 
   3.7193894264604826`*^9}, {3.7193894929525137`*^9, 
   3.7193895316226597`*^9}, {3.7619468074653964`*^9, 
   3.7619469199906416`*^9}, {3.761947202554014*^9, 3.7619474499247847`*^9}}],

Cell[TextData[{
 "Plot",
 StyleBox[" Fig. S5:",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.7619466497710176`*^9, 3.761946654463196*^9}, {
  3.7619476719816165`*^9, 3.761947672779022*^9}}],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"m", "=", "0.4"}], ";"}],
  FontWeight->"Bold"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"GraphicsGrid", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"W1fixed0", "[", 
            RowBox[{"m", ",", "s1", ",", "0.3"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s1", ",", "0", ",", "lower"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1.05"}], "}"}]}], "}"}]}]}], "]"}], ",", 
         RowBox[{"Plot", "[", 
          RowBox[{"0.005", ",", 
           RowBox[{"{", 
            RowBox[{"s1", ",", "0", ",", "lower"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"W1poly", "[", 
            RowBox[{"m", ",", "s1", ",", "0.3"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s1", ",", "lower", ",", "upper"}], "}"}]}], "]"}], ",", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"P1Poly", "[", 
             RowBox[{"m", ",", "s1", ",", "0.3"}], "]"}], "-", "0.005"}], ",", 
           RowBox[{"{", 
            RowBox[{"s1", ",", 
             RowBox[{"lower", "+", "0.002"}], ",", 
             RowBox[{"upper", "-", "0.005"}]}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"W1fixed1", "[", 
            RowBox[{"m", ",", "s1", ",", "0.3"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s1", ",", "upper", ",", "1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Plot", "[", 
          RowBox[{"0.995", ",", 
           RowBox[{"{", 
            RowBox[{"s1", ",", "upper", ",", "1"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", " ", 
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(s\), \(2\)]\) = 0.3\>\"", ",", "18"}], 
           "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"W1fixed1", "[", 
            RowBox[{"m", ",", "0.3", ",", "s2"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s2", ",", "0", ",", "lower"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1.05"}], "}"}]}], "}"}]}]}], "]"}], ",", 
         RowBox[{"Plot", "[", 
          RowBox[{"0.995", ",", 
           RowBox[{"{", 
            RowBox[{"s2", ",", "0", ",", "lower"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"W1poly", "[", 
            RowBox[{"m", ",", "0.3", ",", "s2"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s2", ",", "lower", ",", "upper"}], "}"}]}], "]"}], ",", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"P1Poly", "[", 
            RowBox[{"m", ",", "0.3", ",", "s2"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s2", ",", 
             RowBox[{"lower", "+", "0.005"}], ",", 
             RowBox[{"upper", "-", "0.005"}]}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"W1fixed0", "[", 
            RowBox[{"m", ",", "0.3", ",", "s2"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s2", ",", "upper", ",", "1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Plot", "[", 
          RowBox[{"0.005", ",", 
           RowBox[{"{", 
            RowBox[{"s2", ",", "upper", ",", "1"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "\[Rule]", " ", 
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(s\), \(1\)]\) = 0.3\>\"", ",", "18"}], 
           "]"}]}]}], "]"}]}], "}"}], "}"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}],
  FontWeight->"Bold"]}], "Input",
 CellChangeTimes->{
  3.7203777556243258`*^9, {3.720377823948121*^9, 3.7203778367557344`*^9}, {
   3.7203779262055387`*^9, 3.720377970466319*^9}, 3.720716758873787*^9, {
   3.721220060101927*^9, 3.721220144414893*^9}, {3.7449014955278234`*^9, 
   3.744901520909461*^9}, {3.744901557595306*^9, 3.7449015747249975`*^9}, {
   3.744901613348439*^9, 3.7449016374989357`*^9}, {3.7449017999186697`*^9, 
   3.7449018632044244`*^9}, {3.7449019637433987`*^9, 3.744901970923436*^9}, {
   3.744902065114951*^9, 3.744902075203294*^9}, {3.7449021140131917`*^9, 
   3.744902134882966*^9}, {3.7449023057428827`*^9, 3.744902408982566*^9}, 
   3.761946644926442*^9, {3.7619467045673656`*^9, 3.7619467165854836`*^9}, {
   3.761947500591872*^9, 3.761947565184947*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Robustness to asymmetries", "Subsection",
 CellChangeTimes->{{3.748607398978879*^9, 3.7486074114704523`*^9}, {
  3.7619402274606647`*^9, 3.761940233993605*^9}}],

Cell["\<\
For Fig. S8 and S9, we impose fluctuations in the population density in niche \
1. Function N1PerP1P2Last can be used for the computations:\
\>", "Text",
 CellChangeTimes->{{3.7619454579529963`*^9, 3.761945559413511*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"p1Migr", "[", 
     RowBox[{
     "m12_", ",", "m21_", ",", "p1_", ",", "p2_", ",", "N1_", ",", "N2_"}], 
     "]"}], ":=", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "m12"}], ")"}], " ", "p1", " ", "N1"}], "+", 
      RowBox[{"m21", "  ", "p2", " ", "N2"}]}], 
     RowBox[{
      RowBox[{"N1", 
       RowBox[{"(", 
        RowBox[{"1", "-", "m12"}], ")"}]}], "+", 
      RowBox[{"m21", " ", "N2"}]}]]}], ";", "  ", 
   RowBox[{"(*", 
    RowBox[{" ", 
     RowBox[{
     "Allele", " ", "frequencies", " ", "after", " ", "migration", " ", 
      RowBox[{
       FormBox[
        RowBox[{"(", 
         SubscriptBox["p", "1"]}],
        TraditionalForm], "'"}]}], ")"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p2Migr", "[", 
     RowBox[{
     "m12_", ",", "m21_", ",", "p1_", ",", "p2_", ",", "N1_", ",", "N2_"}], 
     "]"}], ":=", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "m21"}], ")"}], " ", "p2", "  ", "N2"}], " ", "+", 
      RowBox[{"m12", "  ", "p1", "  ", "N1"}]}], 
     RowBox[{" ", 
      RowBox[{
       RowBox[{"N2", 
        RowBox[{"(", 
         RowBox[{"1", "-", "m21"}], ")"}]}], "+", 
       RowBox[{"m12", "  ", "N1"}]}]}]]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"Allele", " ", "frequencies", " ", "after", " ", "migration", " ", 
    RowBox[{"(", 
     RowBox[{
      FormBox[
       SubscriptBox["p", "2"],
       TraditionalForm], "'"}], ")"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PerTwo", "[", "ti_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Mod", "[", 
      RowBox[{"ti", ",", "2"}], "]"}], "+", "1"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N1PerP1P2Last", "[", 
   RowBox[{
   "s1_", ",", "s2_", ",", "m12_", ",", "m21_", ",", "n1per1_", ",", 
    "n1per2_", ",", "n2_", ",", "p1t0_", ",", "p2t0_", ",", "tm_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"per", "=", "0"}], ",", 
      RowBox[{"N1", "=", 
       RowBox[{"{", 
        RowBox[{"n1per1", ",", "n1per2"}], "}"}]}], ",", "p1m", ",", "p2m", 
      ",", 
      RowBox[{"w1A", "=", "1"}], ",", 
      RowBox[{"w1a", "=", 
       RowBox[{"1", "-", "s1"}]}], ",", 
      RowBox[{"w2A", "=", 
       RowBox[{"1", "-", "s2"}]}], ",", 
      RowBox[{"w2a", "=", "1"}]}], "}"}], ",", 
    RowBox[{"Nest", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"N1", "\[LeftDoubleBracket]", 
          RowBox[{"PerTwo", "[", " ", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}],
           "\[RightDoubleBracket]"}], ",", " ", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "+", "1"}], ",", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"p1Migr", "[", 
             RowBox[{"m12", ",", "m21", ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              " ", ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
              ",", " ", 
              RowBox[{"N1", "\[LeftDoubleBracket]", 
               RowBox[{"PerTwo", "[", " ", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                "]"}], "\[RightDoubleBracket]"}], ",", "n2"}], "]"}], " ", 
            StyleBox["w1A",
             Background->RGBColor[1, 0.9, 1]]}], 
           RowBox[{
            RowBox[{
             RowBox[{"p1Migr", "[", 
              RowBox[{"m12", ",", "m21", ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               " ", ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
               ",", " ", 
               RowBox[{"N1", "\[LeftDoubleBracket]", 
                RowBox[{"PerTwo", "[", " ", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 "]"}], "\[RightDoubleBracket]"}], ",", "n2"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"w1A", "-", "w1a"}], ")"}]}], "+", "w1a"}]], "//", 
          "Chop"}], ",", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"p2Migr", "[", 
             RowBox[{"m12", ",", "m21", ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              " ", ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
              ",", " ", 
              RowBox[{"N1", "\[LeftDoubleBracket]", 
               RowBox[{"PerTwo", "[", " ", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                "]"}], "\[RightDoubleBracket]"}], ",", "n2"}], "]"}], " ", 
            StyleBox["w2A",
             Background->RGBColor[1, 0.9, 1]]}], 
           RowBox[{
            RowBox[{
             RowBox[{"p2Migr", "[", 
              RowBox[{"m12", ",", "m21", ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               " ", ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
               ",", " ", 
               RowBox[{"N1", "\[LeftDoubleBracket]", 
                RowBox[{"PerTwo", "[", " ", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 "]"}], "\[RightDoubleBracket]"}], ",", "n2"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"w2A", "-", "w2a"}], ")"}]}], "+", "w2a"}]], "//", 
          "Chop"}]}], "}"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"n1per1", ",", "per", ",", "p1t0", ",", "p2t0"}], "}"}], ",", 
      "tm"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.691130711343828*^9, 3.691130914981784*^9}, 
   3.691131023064588*^9, {3.691131059986033*^9, 3.691131212857601*^9}, {
   3.691131249210312*^9, 3.6911313366269608`*^9}, {3.691131379131631*^9, 
   3.691131399446752*^9}, {3.691131510439068*^9, 3.691131627838402*^9}, {
   3.691131659150908*^9, 3.691131942708983*^9}, {3.69113827370041*^9, 
   3.6911383018451033`*^9}, {3.6911389162158318`*^9, 
   3.6911389305268917`*^9}, {3.691139446614834*^9, 3.691139450036359*^9}, {
   3.691139573455421*^9, 3.691139607327854*^9}, {3.691147971441763*^9, 
   3.691148036925931*^9}, {3.691148080725089*^9, 3.691148153048972*^9}, {
   3.691148228278754*^9, 3.6911482820634727`*^9}, {3.691148312936878*^9, 
   3.691148344025391*^9}, {3.691148789608877*^9, 3.69114879095856*^9}, {
   3.69114898848216*^9, 3.691149124324915*^9}, {3.69114915683574*^9, 
   3.691149195260207*^9}, 3.6911492674454927`*^9, {3.691243597194436*^9, 
   3.69124361729239*^9}, {3.691255237907462*^9, 3.691255252323709*^9}, {
   3.7599979154155607`*^9, 3.759997918060666*^9}, {3.761944908718861*^9, 
   3.7619449113130093`*^9}, {3.761945510075282*^9, 3.7619455123725605`*^9}},
 ExpressionUUID -> "74a1a288-1581-43b3-b415-53615e80cd2d"],

Cell["\<\
Simulations for Fig. S8 (with the given parameters, this takes quite a long \
time -- nn1 = 100; tm = 5000; and coarser spacing for migration {m12, 0, 0.5, \
0.005} is considerably quicker):\
\>", "Text",
 CellChangeTimes->{{3.761944746086268*^9, 3.7619447484155703`*^9}, {
  3.7619455851259165`*^9, 3.7619456420510755`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"m12", "=."}], ";", 
   RowBox[{"m21", "=", "0.2"}], ";", 
   RowBox[{"s1", "=", "0.1"}], ";", 
   RowBox[{"s2", "=", "0.1"}], ";", 
   RowBox[{"nn1", "=", " ", "200"}], ";", 
   RowBox[{"nn2", "=", "nn1"}], ";", 
   RowBox[{"p1t0", "=", "0.04"}], ";", 
   RowBox[{"p2t0", "=", "0.05"}], ";", 
   RowBox[{"tm", "=", "10000"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dm12P1List", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"dy", "/", "nn1"}], ",", "m12", ",", 
         RowBox[{
          RowBox[{"N1PerP1P2Last", "[", 
           RowBox[{"s1", ",", "s2", ",", "m12", ",", " ", "m21", ",", 
            RowBox[{"nn1", "-", "dy"}], ",", 
            RowBox[{"nn1", "+", "dy"}], ",", "nn1", " ", ",", "p1t0", ",", 
            "p2t0", ",", "tm"}], "]"}], "\[LeftDoubleBracket]", "3", 
          "\[RightDoubleBracket]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m12", ",", "0", ",", "0.5", ",", "0.025"}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"dy", ",", "0", ",", "nn1", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.761945657304862*^9, 3.7619456792936797`*^9}}],

Cell[TextData[{
 StyleBox["Fig. S8",
  FontWeight->"Bold"],
 ":"
}], "Text",
 CellChangeTimes->{{3.7619456932811594`*^9, 3.761945696829094*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListContourPlot", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Dm12P1List", ",", "1"}], "]"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Fluctuations  \!\(\*SubscriptBox[\(D\), \
\(1\)]\)/\!\(\*SubscriptBox[\(K\), \(1\)]\)\>\"", ",", 
        "\"\<Migration out  \!\(\*SubscriptBox[\(m\), \(12\)]\)\>\""}], 
       "}"}]}], ",", 
     RowBox[{"ColorFunction", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Blend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"White", ",", "Gray"}], "}"}], ",", "#"}], "]"}], "&"}], 
       ")"}]}], ",", 
     RowBox[{"Contours", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.001", ",", "0.25", ",", "0.5", ",", "0.75", ",", "0.999"}], 
       "}"}]}], ",", 
     RowBox[{"ContourLabels", "\[Rule]", "None"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Black", ",", "Dotted", ",", "Thick"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Dotted", ",", "Thick"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Dotted", ",", "Thick"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Dotted", ",", "Thick"}], "}"}]}], "}"}]}]}], 
    "]"}], ",", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Focal type extinct\>\"", ",", "Italic", ",", 
          RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.72", ",", "0.08"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<Focal type  \\n fixed            \>\"", ",", "Italic", ",", 
          RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.15", ",", "0.45"}], "}"}]}], "]"}]}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", " ", "350"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7619457353058043`*^9, 3.761945735884569*^9}, 
   3.7619457871187954`*^9}],

Cell["\<\

Simulations for Fig. S9 (e.g. green line in B):\
\>", "Text",
 CellChangeTimes->{{3.7619460802928605`*^9, 3.7619460994839535`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"s1", "=", "0.12"}], ";", 
   RowBox[{"s2", "=", "0.1"}], ";", 
   RowBox[{"nn1", "=", " ", "100"}], ";", 
   RowBox[{"nn2", "=", "nn1"}], ";", 
   RowBox[{"p1", "=", "0.04"}], ";", 
   RowBox[{"p2", "=", "0.05"}], ";", 
   RowBox[{"tm", "=", "10000"}], ";", 
   RowBox[{"d", "=", "50"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FluctMigrSymmS1Stronger", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
         RowBox[{"N1PerP1P2Last", "[", 
          RowBox[{"s1", ",", "s2", ",", "x", ",", " ", "x", ",", 
           RowBox[{"nn1", "-", "d"}], ",", 
           RowBox[{"nn1", "+", "d"}], ",", "nn2", ",", "p1", ",", "p2", ",", 
           "tm"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", 
       RowBox[{"1", "/", "2"}], ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.761946061976468*^9, 3.7619461618143454`*^9}}],

Cell[TextData[{
 StyleBox["\nFig. S9 ",
  FontWeight->"Bold"],
 "(e.g. green line in B):"
}], "Text",
 CellChangeTimes->{{3.7619458034966545`*^9, 3.761945806247427*^9}, {
   3.761945878438509*^9, 3.761945908147665*^9}, 3.761946165393239*^9}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "FluctMigrSymmS1Stronger", "]"}], 
      "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.015"}], ",", "1.15"}], "}"}]}], ",", 
     RowBox[{"Joined", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Thick", ",", 
        RowBox[{"Darker", "[", "Green", "]"}]}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Symmetric migration rate \!\(\*SubscriptBox[\(m\), \(12\)]\) = \!\
\(\*SubscriptBox[\(m\), \(21\)]\)\>\"", ",", 
        "\"\<\!\(\*SubscriptBox[\(p\), \(1\)]\), \!\(\*SubscriptBox[\(p\), \
\(2\)]\)\>\""}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "FluctMigrSymmS1Stronger", "]"}], 
      "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], ",", 
     RowBox[{"Joined", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Thick", ",", 
        RowBox[{"Darker", "[", "Green", "]"}], ",", "Dashed"}], "}"}]}]}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.761946212387212*^9, 3.7619462600844326`*^9}, 
   3.7619462980791073`*^9, {3.761946331569126*^9, 3.7619463396960335`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Logistic density dependence", "Subsection",
 CellChangeTimes->{{3.748607398978879*^9, 3.7486074114704523`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"s1", "=."}], ";", 
  RowBox[{"s2", "=."}], ";", 
  RowBox[{"m12", "=."}], ";", 
  RowBox[{"m21", "=."}], ";", 
  RowBox[{"p1", "=."}], ";", 
  RowBox[{"p2", "=."}], ";", 
  RowBox[{"N1", "=."}], ";", 
  RowBox[{"K1", "=."}], ";", 
  RowBox[{"K2", "=."}], ";", 
  RowBox[{"r1", "=."}], ";", 
  RowBox[{"r2", "=."}], ";", 
  RowBox[{"tm", "=."}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Logistic", "[", 
   RowBox[{
   "s1_", ",", "s2_", ",", "m12_", ",", "m21_", ",", "p1_", ",", "p2_", ",", 
    "N1_", ",", "N2_", " ", ",", "K1_", ",", "K2_", ",", "r1_", ",", "r2_", 
    ",", "tm_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"w1A", "=", "1"}], ",", 
      RowBox[{"w1a", "=", 
       RowBox[{"1", "-", "s1"}]}], ",", 
      RowBox[{"w2A", "=", 
       RowBox[{"1", "-", "s2"}]}], ",", 
      RowBox[{"w2a", "=", "1"}]}], "}"}], ",", 
    RowBox[{"NestList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m12"}], ")"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               ",", "0"}], "]"}]}], "+", 
            RowBox[{"m21", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
               ",", "0"}], "]"}]}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m12"}], ")"}], 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               ",", "0"}], "]"}]}], "+", 
            RowBox[{"m21", " ", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
               ",", "0"}], "]"}]}]}]], "*", 
          RowBox[{"(", 
           RowBox[{"w1A", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "m12"}], ")"}], 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   " ", 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                 RowBox[{"m21", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   " ", 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "m12"}], ")"}], 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                 RowBox[{"m21", " ", 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}]], "*", 
               "w1A"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                   RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                   RowBox[{"m21", " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}]]}], 
                ")"}], "*", "w1a"}]}], ")"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m21"}], ")"}], 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
               ",", "0"}], "]"}]}], "+", 
            RowBox[{"m12", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               ",", "0"}], "]"}]}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "m21"}], ")"}], 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
               ",", "0"}], "]"}]}], "+", 
            RowBox[{"m12", " ", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               ",", "0"}], "]"}]}]}]], "*", 
          RowBox[{"(", 
           RowBox[{"w2A", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "m21"}], ")"}], 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                 RowBox[{"m12", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   " ", 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "m21"}], ")"}], 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                 RowBox[{"m12", " ", 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}]], "*", 
               "w2A"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                   RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                   RowBox[{"m12", " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}]]}], 
                ")"}], "*", "w2a"}]}], ")"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "m12"}], ")"}], 
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                 ",", "0"}], "]"}]}], "+", 
              RowBox[{"m21", " ", 
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                 ",", "0"}], "]"}]}]}], ")"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m12"}], ")"}], 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
                   ",", "0"}], "]"}]}], "+", 
               RowBox[{"m21", " ", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}],
                   ",", "0"}], "]"}]}]}], ")"}], "*", " ", "r1", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "m12"}], ")"}], 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                 RowBox[{"m21", " ", 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], "K1"]}],
               ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                FractionBox[
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                  RowBox[{"m21", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                  RowBox[{"m21", " ", 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}]], "*", 
                "w1A"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m21", " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}]]}], 
                 ")"}], "*", "w1a"}]}], ")"}]}]}], ",", "0"}], "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "m21"}], ")"}], 
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                 ",", "0"}], "]"}]}], "+", 
              RowBox[{"m12", " ", 
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                 ",", "0"}], "]"}]}]}], ")"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m21"}], ")"}], 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}],
                   ",", "0"}], "]"}]}], "+", 
               RowBox[{"m12", " ", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
                   ",", "0"}], "]"}]}]}], ")"}], "*", " ", "r2", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "m21"}], ")"}], 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                 RowBox[{"m12", " ", 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], "K2"]}],
               ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                FractionBox[
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                  RowBox[{"m12", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                  RowBox[{"m12", " ", 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}]], "*", 
                "w2A"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m12", " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}]]}], 
                 ")"}], "*", "w2a"}]}], ")"}]}]}], ",", "0"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], " ", "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2", ",", "N1", ",", "N2"}], "}"}], ",", "tm"}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.748607541330324*^9, 3.748607711731187*^9}}],

Cell[TextData[{
 "With this code we can compute ",
 StyleBox["Fig. S10:",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.748607764221773*^9, 3.748607816469911*^9}, {
  3.760522621114045*^9, 3.7605226213222218`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=", "0.05"}], ";", " ", 
  RowBox[{"s2", "=", "0.05"}], ";", 
  RowBox[{"m12", "=", "0.1"}], ";", " ", 
  RowBox[{"m21", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r2", "=", "1"}], ";", " ", 
  RowBox[{"K1", "=", "50"}], ";", " ", 
  RowBox[{"K2", "=", "K1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p1", "=", "0.05"}], ";", 
  RowBox[{"p2", "=", "0.06"}], ";", " ", 
  RowBox[{"N1", "=", "1"}], ";", 
  RowBox[{"N2", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tm", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", "=", 
   RowBox[{"Logistic", "[", 
    RowBox[{
    "s1", ",", "s2", ",", "m12", ",", "m21", ",", "p1", ",", "p2", ",", "N1", 
     ",", "N2", ",", "c1", ",", "1", ",", "r2", ",", "kk", ",", "tm"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Lr1big", "=", 
    RowBox[{"Logistic", "[", 
     RowBox[{
     "s1", ",", "s2", ",", "m12", ",", "m21", ",", "p1", ",", "p2", ",", "N1",
       ",", "N2", ",", "c1", ",", "2.5", ",", "r2", ",", "kk", ",", "tm"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsGrid", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"L", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "100"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"2", "K1"}], "+", "10"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Darker", "[", "Blue", "]"}], ",", 
              RowBox[{"Thickness", "[", "0.0015", "]"}]}], "}"}]}], ",", " ", 
           RowBox[{"Joined", "\[Rule]", " ", "True"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"L", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Lighter", "[", "Orange", "]"}], ",", 
              RowBox[{"Thickness", "[", "0.0015", "]"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"L", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.7"}], "}"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Darker", "[", "Blue", "]"}], ",", 
              RowBox[{"Thickness", "[", "0.0015", "]"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", " ", "True"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"L", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Lighter", "[", "Orange", "]"}], ",", 
              RowBox[{"Thickness", "[", "0.0015", "]"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], "]"}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Lr1big", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "100"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"2", "K1"}], "+", "10"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Darker", "[", "Blue", "]"}], ",", 
              RowBox[{"Thickness", "[", "0.0015", "]"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", " ", "True"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Lr1big", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Lighter", "[", "Orange", "]"}], ",", 
              RowBox[{"Thickness", "[", "0.0015", "]"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Lr1big", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0.7"}], "}"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Darker", "[", "Blue", "]"}], ",", 
              RowBox[{"Thickness", "[", "0.0015", "]"}]}], "}"}]}], ",", " ", 
           RowBox[{"Joined", "\[Rule]", " ", "True"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Lr1big", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Lighter", "[", "Orange", "]"}], ",", 
              RowBox[{"Thickness", "[", "0.0015", "]"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], "]"}]}], "}"}]}],
     "}"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7486078531006145`*^9, 3.748607866210743*^9}, {
  3.748607912604845*^9, 3.748608046391985*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"LogisticLast", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"s2", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m12", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m21", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p2", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"N1", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"N2", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"K1", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"K2", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r2", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"tm", ",", "_Integer"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"w1A", "=", "1"}], ",", 
          RowBox[{"w1a", "=", 
           RowBox[{"1", "-", "s1"}]}], ",", 
          RowBox[{"w2A", "=", 
           RowBox[{"1", "-", "s2"}]}], ",", 
          RowBox[{"w2a", "=", "1"}]}], "}"}], ",", 
        RowBox[{"Nest", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m12"}], ")"}], 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 " ", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                RowBox[{"m21", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 " ", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m12"}], ")"}], 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                RowBox[{"m21", " ", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}]], "*", 
              RowBox[{"(", 
               RowBox[{"w1A", "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m21", " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}]], "*", 
                   "w1A"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m21", " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}]]}], 
                    ")"}], "*", "w1a"}]}], ")"}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m21"}], ")"}], 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                RowBox[{"m12", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 " ", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "m21"}], ")"}], 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                RowBox[{"m12", " ", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}]], "*", 
              RowBox[{"(", 
               RowBox[{"w2A", "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m12", " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}]], "*", 
                   "w2A"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m12", " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}]]}], 
                    ")"}], "*", "w2a"}]}], ")"}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                  RowBox[{"m21", " ", 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], ")"}], 
                "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                   RowBox[{"m21", " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], ")"}], 
                 "*", " ", "r1", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m21", " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], "K1"]}],
                   ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m21", " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}]], "*", 
                    "w1A"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m21", " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}]]}], 
                    ")"}], "*", "w1a"}]}], ")"}]}]}], ",", "0"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                  RowBox[{"m12", " ", 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], ")"}], 
                "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                   RowBox[{"m12", " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], ")"}], 
                 "*", " ", "r2", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m12", " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], "K2"]}],
                   ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m12", " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}]], "*", 
                    "w2A"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}], "+", 
                    RowBox[{"m12", " ", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "]"}]}]}]]}], 
                    ")"}], "*", "w2a"}]}], ")"}]}]}], ",", "0"}], "]"}]}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], " ", "&"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"p1", ",", "p2", ",", "N1", ",", "N2"}], "}"}], ",", 
          "tm"}], "]"}]}], "]"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{3.7486080532987766`*^9}],

Cell[TextData[{
 StyleBox["Fig. S11",
  FontWeight->"Bold"],
 ":"
}], "Text",
 CellChangeTimes->{{3.7486080661922445`*^9, 3.7486080824407053`*^9}, {
  3.7605226389005876`*^9, 3.760522639067995*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=", "0.1"}], ";", " ", 
  RowBox[{"s2", "=", "0.1"}], ";", 
  RowBox[{"m12", "=", "0.05"}], ";", " ", 
  RowBox[{"m21", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c1", "=", "0.5"}], ";", " ", 
  RowBox[{"r2", "=", "1"}], ";", " ", 
  RowBox[{"kk", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p1", "=", "0.1"}], ";", 
  RowBox[{"p2", "=", "0.1"}], ";", " ", 
  RowBox[{"N1", "=."}], ";", 
  RowBox[{"N2", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "c1"}], ")"}], " ", "kk"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tm", "=", 
    SuperscriptBox["2", "13"]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LLast", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"r1", ",", "r1", ",", "r1", ",", "r1"}], "}"}], ",", 
            RowBox[{"LogisticLast", "[", 
             RowBox[{
             "s1", ",", "s2", ",", "m12", ",", "m21", ",", "p1", ",", "p2", 
              ",", "N1", ",", "N2", ",", "c1", ",", "r1", ",", "r2", ",", 
              "kk", ",", 
              RowBox[{"tm", "+", 
               RowBox[{"RandomInteger", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "]"}]}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"r1", ",", "0.1", ",", "5", ",", "0.0012"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"N1", ",", 
          RowBox[{"Round", "[", 
           RowBox[{"c1", " ", 
            RowBox[{"kk", "/", "10"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"Round", "[", 
            RowBox[{"c1", " ", "kk"}], "]"}], "-", "1"}], ",", "5"}], "}"}]}],
        "]"}], ",", "1"}], "]"}], "]"}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{"GraphicsGrid", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
          "LLast", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "5"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "87"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.005", "]"}], ",", 
             RowBox[{"Darker", "[", "Blue", "]"}]}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
          "LLast", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.005", "]"}], ",", 
             RowBox[{"Lighter", "[", "Orange", "]"}]}], "}"}]}]}], "]"}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
          "LLast", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "5"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.005", "]"}], ",", 
             RowBox[{"Darker", "[", "Blue", "]"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "5"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
          "LLast", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.005", "]"}], ",", 
             RowBox[{"Lighter", "[", "Orange", "]"}]}], "}"}]}]}], "]"}]}], 
       "]"}]}], "}"}], "}"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.748608141158537*^9, 3.7486081701185565`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hard selection", "Subsection",
 CellChangeTimes->{{3.748607398978879*^9, 3.7486074114704523`*^9}, {
  3.7605227470231733`*^9, 3.7605227499473505`*^9}}],

Cell["\<\
Under the alternative model with hard selection, the function for computing \
the allele frequencies and the population densities after tm generations \
reads:\
\>", "Text",
 CellChangeTimes->{{3.7605229697866707`*^9, 3.7605230351546993`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"s1", "=."}], ";", 
   RowBox[{"s2", "=."}], ";", 
   RowBox[{"m", "=."}], ";", 
   RowBox[{"p1", "=."}], ";", 
   RowBox[{"p2", "=."}], ";", 
   RowBox[{"N1", "=."}], ";", 
   RowBox[{"N2", "=."}], ";", 
   RowBox[{"c1", "=."}], ";", 
   RowBox[{"r1", "=."}], ";", 
   RowBox[{"r2", "=."}], ";", 
   RowBox[{"kk", "=."}], ";", 
   RowBox[{"tm", "=."}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AltModelLast", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s1", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s2", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m12", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m21", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p2", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"N1", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"N2", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"K1", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"K2", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"r1", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"r2", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"tm", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"w1A", "=", "1"}], ",", 
         RowBox[{"w1a", "=", 
          RowBox[{"1", "-", "s1"}]}], ",", 
         RowBox[{"w2A", "=", 
          RowBox[{"1", "-", "s2"}]}], ",", 
         RowBox[{"w2a", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Nest", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m12"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m21", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", 
                 "\[RightDoubleBracket]"}]}]}], 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m12"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m21", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", 
                 "\[RightDoubleBracket]"}]}]}]], "*", 
             RowBox[{"(", 
              RowBox[{"w1A", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}]], "*", "w1A"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}]]}], ")"}], "*", "w1a"}]}], 
                ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m21"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m12", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}]}], 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m21"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m12", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}]}]], "*", 
             RowBox[{"(", 
              RowBox[{"w2A", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]], "*", "w2A"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]]}], ")"}], "*", "w2a"}]}], 
                ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m12"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m21", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", 
                 "\[RightDoubleBracket]"}]}]}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                FractionBox[
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                  RowBox[{"m21", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                  RowBox[{"m21", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}]], "*", "w1A"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}]]}], ")"}], "*", "w1a"}]}], 
              ")"}], "*", 
             RowBox[{"Exp", "[", " ", 
              RowBox[{"r1", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m12"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m21", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], "K1"]}], ")"}]}], "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "m21"}], ")"}], 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}],
                "+", 
               RowBox[{"m12", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}]}], ")"}], " ", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                FractionBox[
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                  RowBox[{"m12", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                  RowBox[{"m12", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]], "*", "w2A"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]]}], ")"}], "*", "w2a"}]}], 
              ")"}], "*", 
             RowBox[{"Exp", "[", 
              RowBox[{"r2", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m21"}], ")"}], 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{"m12", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], "K2"]}], ")"}]}], 
              "]"}]}]}], "}"}], " ", "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p2", ",", "N1", ",", "N2"}], "}"}], ",", "tm"}],
         "]"}]}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7566716790320387`*^9, 3.7566717460017614`*^9}, {
   3.7566718872300277`*^9, 3.7566719112040925`*^9}, {3.7566719465705204`*^9, 
   3.7566720242088356`*^9}, {3.756672068607997*^9, 3.7566720692173*^9}, {
   3.7566721548193226`*^9, 3.7566721795737767`*^9}, 3.7566728167349615`*^9, {
   3.756672863943942*^9, 3.756672867897263*^9}, {3.7605229533784604`*^9, 
   3.760522964160591*^9}}],

Cell["\<\
Using this function, we can run the simulations for Fig. S12:\
\>", "Text",
 CellChangeTimes->{{3.7605230722979507`*^9, 3.760523080786167*^9}, {
  3.7605233492650385`*^9, 3.7605233765127363`*^9}, {3.7605235078083878`*^9, 
  3.7605235249041557`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p1", "=", "0.5"}], ";", 
  RowBox[{"p2", "=", "0.5"}], ";", "  ", 
  RowBox[{"K1", "=", "1"}], ";", " ", 
  RowBox[{"K2", "=", "1"}], ";", 
  RowBox[{"N2", "=", " ", "0.8"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", "0.1"}], ";", " ", 
  RowBox[{"s2", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", "0.05"}], ";", " ", 
  RowBox[{"m12", "=", "m"}], ";", 
  RowBox[{"m21", "=", "m"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tm", "=", 
   SuperscriptBox["2", "9"]}], ";", 
  RowBox[{"rmax", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N1", "=."}], ";", " ", 
   RowBox[{"r1", "=."}], ";", 
   RowBox[{"r2", "=", "1"}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AltModels01m005", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"r1", ",", "r1", ",", "r1", ",", " ", "r1"}], "}"}], ",", 
            RowBox[{"AltModelLast", "[", 
             RowBox[{
             "s1", ",", "s2", ",", "m12", ",", "m21", ",", "p1", ",", "p2", 
              ",", "N1", ",", "N2", ",", "K1", ",", "K2", ",", "r1", ",", 
              "r2", ",", 
              RowBox[{"tm", "+", 
               RowBox[{"RandomInteger", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "]"}]}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"r1", ",", "0.01", ",", "rmax", ",", "0.0012"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"N1", ",", "0.1", ",", "1", ",", "0.01"}], "}"}]}], "]"}], 
      ",", "1"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.739590847180065*^9, 3.7395908515870557`*^9}, 
   3.739590934136098*^9, {3.739591012941035*^9, 3.7395910322256746`*^9}, {
   3.739591147092822*^9, 3.7395911725191283`*^9}, {3.739591429594863*^9, 
   3.739591452039361*^9}, 3.7395915187383127`*^9, 3.7395918673153887`*^9, {
   3.7566723784705396`*^9, 3.756672464910656*^9}, {3.756672569568692*^9, 
   3.756672593105899*^9}, {3.760523191828865*^9, 3.7605232238830566`*^9}}],

Cell[TextData[StyleBox["\nFig. S12:",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.760523550107976*^9, 3.76052355286157*^9}, 
   3.7605237396136894`*^9}],

Cell[BoxData[
 RowBox[{"GraphicsGrid", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "/", "50"}]}], "}"}], "&"}], "/@", 
           RowBox[{
           "s01m005Longterm", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "4.5"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "4"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"True", ",", "False"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameLabel", "->", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Intrinsic rate of increase \!\(\*SubscriptBox[\(r\), \
\(1\)]\)\>\"", ",", "\"\<\!\(\*
StyleBox[SubscriptBox[
StyleBox[\"N\",
FontColor->RGBColor[0., 0.25098039215686274`, 0.5019607843137255]], 
StyleBox[\"1\",
FontColor->RGBColor[0., 0.25098039215686274`, 0.5019607843137255]]],
FontColor->RGBColor[0., 0., 0.7764705882352941]]\)\!\(\*
StyleBox[\" \",
FontColor->RGBColor[0., 0., 0.7764705882352941]]\)\!\(\*
StyleBox[\"/\",
FontColor->RGBColor[0., 0., 0.7764705882352941]]\)\!\(\*
StyleBox[\" \",
FontColor->RGBColor[0., 0., 0.7764705882352941]]\)\!\(\*
StyleBox[\"K\",
FontColor->RGBColor[0., 0.25098039215686274`, 0.5019607843137255]]\),  \!\(\*
StyleBox[\" \",
FontColor->RGBColor[0.9607843137254902, 0.6823529411764706, \
0.0392156862745098]]\)\!\(\*
StyleBox[SubscriptBox[
StyleBox[\"N\",
FontColor->RGBColor[0.9299305714503701, 0.5673151750972762, \
0.032166018158236054`]], 
StyleBox[\"2\",
FontColor->RGBColor[0.9299305714503701, 0.5673151750972762, \
0.032166018158236054`]]],
FontColor->RGBColor[0.9607843137254902, 0.6823529411764706, \
0.0392156862745098]]\)\!\(\*
StyleBox[\" \",
FontColor->RGBColor[0.9607843137254902, 0.6823529411764706, \
0.0392156862745098]]\)\!\(\*
StyleBox[\"/\",
FontColor->RGBColor[0.9299305714503701, 0.5673151750972762, \
0.032166018158236054`]]\)\!\(\*
StyleBox[\" \",
FontColor->RGBColor[0.9299305714503701, 0.5673151750972762, \
0.032166018158236054`]]\)\!\(\*
StyleBox[\"K\",
FontColor->RGBColor[0.9299305714503701, 0.5673151750972762, \
0.032166018158236054`]]\)\>\""}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.003", "]"}], ",", 
             RowBox[{"Lighter", "[", "Gray", "]"}]}], "}"}]}], ",", 
          RowBox[{"BaseStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"FontSize", "\[Rule]", "16"}], "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "/", "50"}]}], "}"}], "&"}], "/@", 
           RowBox[{
           "s01m005Longterm", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.003", "]"}], ",", 
             RowBox[{"Lighter", "[", "Gray", "]"}]}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
          "AltModels01m005", "\[LeftDoubleBracket]", "4", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.004", "]"}], ",", 
             RowBox[{"Lighter", "[", "Orange", "]"}]}], "}"}]}]}], "]"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
          "AltModels01m005", "\[LeftDoubleBracket]", "3", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.004", "]"}], ",", 
             RowBox[{"Darker", "[", "Blue", "]"}]}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<A\>\"", ",", "Bold", ",", "Italic", ",", 
              RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"0.2", ",", "3.8"}], "}"}]}], "]"}], "}"}]}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
          "s01m005Longterm", "\[LeftDoubleBracket]", "3", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "4.5"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.001"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"True", ",", "False"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameLabel", "->", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Intrinsic rate of increase \!\(\*SubscriptBox[\(r\), \
\(1\)]\)\>\"", ",", "\"\<\!\(\*
StyleBox[SubscriptBox[\"p\", \"1\"],
FontColor->RGBColor[0., 0.25098039215686274`, 0.5019607843137255]]\),  \!\(\*
StyleBox[SubscriptBox[\"p\", \"2\"],
FontColor->RGBColor[0.9607843137254902, 0.6823529411764706, \
0.0392156862745098]]\)\>\""}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.003", "]"}], ",", 
             RowBox[{"Lighter", "[", "Gray", "]"}]}], "}"}]}], ",", 
          RowBox[{"BaseStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"FontSize", "\[Rule]", "16"}], "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
          "s01m005Longterm", "\[LeftDoubleBracket]", "4", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.003", "]"}], ",", 
             RowBox[{"Lighter", "[", "Gray", "]"}]}], "}"}]}], ",", 
          RowBox[{"BaseStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"FontSize", "\[Rule]", "16"}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
          "AltModels01m005", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.004", "]"}], ",", 
             RowBox[{"Lighter", "[", "Orange", "]"}]}], "}"}]}]}], "]"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
          "AltModels01m005", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.004", "]"}], ",", 
             RowBox[{"Darker", "[", "Blue", "]"}]}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<B\>\"", ",", "Bold", ",", "Italic", ",", 
              RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"0.2", ",", "0.95"}], "}"}]}], "]"}], "}"}]}]}], "]"}]}],
      "}"}], "}"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", " ", "900"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7605236184468637`*^9, 3.7605236234335256`*^9}, {
  3.760523703035561*^9, 3.7605237132670994`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 997},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
PrintingCopies->1,
PrintingStartingPageNumber->1,
PrintingPageRange->{32000, 32000},
PageHeaders->{{None, None, None}, {None, None, None}},
PageFooters->{{None, None, None}, {None, None, None}},
PageHeaderLines->{False, False},
PageFooterLines->{False, False},
PrintingOptions->{"FacingPages"->True,
"FirstPageFace"->Right,
"FirstPageFooter"->True,
"FirstPageHeader"->False,
"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{595.1999999999999, 841.68},
"PrintCellBrackets"->False,
"PrintMultipleHorizontalPages"->False,
"PrintRegistrationMarks"->False,
"PrintingMargins"->{{71.007874785, 71.007874785}, {72.00000078, 72.00000078}}},
Magnification:>1.15 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 356, 7, 81, "Chapter"],
Cell[CellGroupData[{
Cell[961, 33, 194, 2, 80, "Section"],
Cell[1158, 37, 191, 2, 34, "Text"],
Cell[1352, 41, 6500, 162, 181, "Input"],
Cell[7855, 205, 355, 7, 56, "Text"],
Cell[8213, 214, 5993, 157, 204, "Input"],
Cell[14209, 373, 190, 2, 34, "Text"],
Cell[14402, 377, 752, 23, 128, "Input"],
Cell[15157, 402, 188, 4, 56, "Text"],
Cell[15348, 408, 1138, 29, 59, "Input"],
Cell[16489, 439, 273, 5, 34, "Text"],
Cell[16765, 446, 945, 32, 38, "Text"],
Cell[17713, 480, 2056, 69, 132, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19806, 554, 113, 1, 80, "Section"],
Cell[CellGroupData[{
Cell[19944, 559, 100, 1, 56, "Subsection"],
Cell[20047, 562, 1764, 50, 58, "Text"],
Cell[21814, 614, 16602, 426, 280, "Input"],
Cell[38419, 1042, 414, 9, 35, "Text"],
Cell[38836, 1053, 1175, 27, 151, "Input"],
Cell[40014, 1082, 794, 17, 59, "Input"],
Cell[40811, 1101, 698, 16, 59, "Input"],
Cell[41512, 1119, 1446, 40, 59, "Input"],
Cell[42961, 1161, 3686, 92, 105, "Input"],
Cell[46650, 1255, 1035, 23, 79, "Text"],
Cell[47688, 1280, 19377, 474, 342, "Input"],
Cell[67068, 1756, 3023, 63, 103, "Text"],
Cell[70094, 1821, 3628, 84, 266, "Input"],
Cell[73725, 1907, 4216, 106, 151, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[77990, 2019, 156, 2, 80, "Section"],
Cell[CellGroupData[{
Cell[78171, 2025, 99, 1, 56, "Subsection"],
Cell[78273, 2028, 459, 8, 56, "Text"],
Cell[78735, 2038, 378, 12, 35, "Input"],
Cell[79116, 2052, 8262, 212, 225, "Input"],
Cell[87381, 2266, 7878, 206, 225, "Input"],
Cell[95262, 2474, 466, 9, 34, "Text"],
Cell[95731, 2485, 262, 7, 35, "Text"],
Cell[95996, 2494, 2853, 68, 174, "Input"],
Cell[98852, 2564, 3525, 94, 105, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[102426, 2664, 169, 2, 80, "Section"],
Cell[CellGroupData[{
Cell[102620, 2670, 104, 1, 56, "Subsection"],
Cell[102727, 2673, 1200, 18, 77, "Text"],
Cell[103930, 2693, 37917, 948, 726, "Input"],
Cell[141850, 3643, 387, 6, 34, "Text"],
Cell[142240, 3651, 4318, 93, 197, "Input"],
Cell[146561, 3746, 291, 6, 56, "Text"],
Cell[146855, 3754, 2377, 60, 174, "Input"],
Cell[149235, 3816, 385, 8, 77, "Text"],
Cell[149623, 3826, 19066, 481, 392, "Input"],
Cell[168692, 4309, 169, 2, 34, "Text"],
Cell[168864, 4313, 5557, 107, 174, "Input"],
Cell[174424, 4422, 137, 2, 58, "Text"],
Cell[174564, 4426, 3402, 93, 174, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178003, 4524, 165, 2, 56, "Subsection"],
Cell[178171, 4528, 225, 4, 34, "Text"],
Cell[178399, 4534, 1874, 62, 108, "Input"],
Cell[180276, 4598, 373, 6, 34, "Text"],
Cell[180652, 4606, 2623, 81, 230, "Input"],
Cell[183278, 4689, 133, 2, 58, "Text"],
Cell[183414, 4693, 4735, 129, 220, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188186, 4827, 267, 5, 56, "Subsection"],
Cell[188456, 4834, 503, 11, 120, "Text"],
Cell[188962, 4847, 4311, 122, 189, "Input"],
Cell[193276, 4971, 239, 6, 77, "Text"],
Cell[193518, 4979, 266, 5, 34, "Text"],
Cell[193787, 4986, 1630, 46, 82, "Input"],
Cell[195420, 5034, 264, 5, 34, "Text"],
Cell[195687, 5041, 3612, 84, 151, "Input"],
Cell[199302, 5127, 177, 4, 34, "Text"],
Cell[199482, 5133, 6963, 193, 151, "Input"],
Cell[206448, 5328, 354, 8, 56, "Text"],
Cell[206805, 5338, 189, 4, 34, "Text"],
Cell[206997, 5344, 2278, 56, 151, "Input"],
Cell[209278, 5402, 225, 5, 34, "Text"],
Cell[209506, 5409, 2014, 58, 59, "Input"],
Cell[211523, 5469, 164, 5, 57, "Text"],
Cell[211690, 5476, 7695, 201, 289, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219422, 5682, 266, 3, 56, "Subsection"],
Cell[219691, 5687, 331, 6, 34, "Text"],
Cell[220025, 5695, 235, 5, 34, "Text"],
Cell[220263, 5702, 5314, 143, 225, "Input"],
Cell[225580, 5847, 98, 1, 34, "Text"],
Cell[225681, 5850, 2063, 52, 128, "Input"],
Cell[227747, 5904, 161, 3, 58, "Text"],
Cell[227911, 5909, 6030, 149, 266, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[233990, 6064, 175, 2, 80, "Section"],
Cell[234168, 6068, 419, 8, 56, "Text"],
Cell[234590, 6078, 306, 10, 35, "Input"],
Cell[234899, 6090, 7641, 214, 345, "Input"],
Cell[242543, 6306, 2033, 44, 128, "Input"],
Cell[244579, 6352, 515, 8, 56, "Text"],
Cell[245097, 6362, 530, 15, 35, "Input"],
Cell[245630, 6379, 537, 15, 59, "Input"],
Cell[246170, 6396, 534, 15, 59, "Input"],
Cell[246707, 6413, 847, 13, 99, "Text"],
Cell[247557, 6428, 195, 6, 35, "Text"],
Cell[247755, 6436, 10483, 269, 427, "Input"],
Cell[258241, 6707, 199, 7, 57, "Text"],
Cell[258443, 6716, 724, 12, 34, "Text"],
Cell[259170, 6730, 3150, 90, 197, "Input"],
Cell[CellGroupData[{
Cell[262345, 6824, 110, 1, 56, "Subsection"],
Cell[262458, 6827, 308, 6, 34, "Text"],
Cell[262769, 6835, 241, 4, 34, "Text"],
Cell[263013, 6841, 3237, 87, 285, "Input"],
Cell[266253, 6930, 437, 9, 35, "Text"],
Cell[CellGroupData[{
Cell[266715, 6943, 1259, 26, 82, "Input"],
Cell[267977, 6971, 29837, 683, 4378, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[297851, 7659, 863, 20, 74, "Input"],
Cell[298717, 7681, 29812, 683, 4378, "Output"]
}, Closed]],
Cell[328544, 8367, 324, 6, 52, "Text"],
Cell[328871, 8375, 29768, 688, 515, "Input"],
Cell[358642, 9065, 192, 2, 34, "Text"],
Cell[358837, 9069, 467, 10, 35, "Input"],
Cell[359307, 9081, 368, 7, 56, "Text"],
Cell[CellGroupData[{
Cell[359700, 9092, 548, 14, 35, "Input"],
Cell[360251, 9108, 1652, 50, 50, "Output"]
}, Open  ]],
Cell[361918, 9161, 1054, 32, 65, "Text"],
Cell[362975, 9195, 223, 7, 57, "Text"],
Cell[363201, 9204, 2431, 75, 207, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[365681, 9285, 111, 1, 80, "Section"],
Cell[CellGroupData[{
Cell[365817, 9290, 259, 5, 56, "Subsection"],
Cell[366079, 9297, 3284, 97, 187, "Text"],
Cell[369366, 9396, 6742, 197, 223, "Input"],
Cell[376111, 9595, 175, 2, 34, "Text"],
Cell[376289, 9599, 925, 28, 59, "Input"],
Cell[377217, 9629, 263, 4, 34, "Text"],
Cell[377483, 9635, 1009, 29, 59, "Input"],
Cell[378495, 9666, 160, 2, 34, "Text"],
Cell[378658, 9670, 794, 23, 59, "Input"],
Cell[379455, 9695, 693, 21, 59, "Input"],
Cell[380151, 9718, 3550, 64, 295, "Text"],
Cell[383704, 9784, 305, 6, 34, "Text"],
Cell[CellGroupData[{
Cell[384034, 9794, 1485, 40, 105, "Input"],
Cell[385522, 9836, 351, 8, 50, "Output"]
}, Open  ]],
Cell[385888, 9847, 346, 8, 35, "Text"],
Cell[386237, 9857, 5302, 136, 174, "Input"],
Cell[391542, 9995, 1217, 28, 100, "Text"],
Cell[392762, 10025, 609, 11, 78, "Text"],
Cell[393374, 10038, 149, 2, 34, "Text"],
Cell[393526, 10042, 2791, 76, 151, "Input"],
Cell[396320, 10120, 149, 2, 34, "Text"],
Cell[396472, 10124, 740, 21, 59, "Input"],
Cell[397215, 10147, 1379, 35, 105, "Input"],
Cell[398597, 10184, 799, 12, 56, "Text"],
Cell[399399, 10198, 149, 2, 34, "Text"],
Cell[CellGroupData[{
Cell[399573, 10204, 632, 16, 59, "Input"],
Cell[400208, 10222, 375, 11, 35, "Output"]
}, Open  ]],
Cell[400598, 10236, 245, 5, 59, "Input"],
Cell[CellGroupData[{
Cell[400868, 10245, 1367, 35, 59, "Input"],
Cell[402238, 10282, 315, 9, 39, "Output"],
Cell[402556, 10293, 190, 4, 35, "Output"]
}, Open  ]],
Cell[402761, 10300, 249, 5, 59, "Input"],
Cell[403013, 10307, 5608, 153, 243, "Input"],
Cell[408624, 10462, 262, 6, 56, "Text"],
Cell[408889, 10470, 10015, 273, 534, "Input"],
Cell[418907, 10745, 200, 6, 35, "Text"],
Cell[419110, 10753, 5551, 131, 220, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[424698, 10889, 166, 2, 56, "Subsection"],
Cell[424867, 10893, 231, 4, 34, "Text"],
Cell[425101, 10899, 7406, 184, 297, "Input"],
Cell[432510, 11085, 335, 6, 34, "Text"],
Cell[432848, 11093, 1319, 35, 82, "Input"],
Cell[434170, 11130, 144, 5, 35, "Text"],
Cell[434317, 11137, 2433, 64, 105, "Input"],
Cell[436753, 11203, 142, 4, 56, "Text"],
Cell[436898, 11209, 1250, 34, 82, "Input"],
Cell[438151, 11245, 241, 6, 58, "Text"],
Cell[438395, 11253, 1749, 43, 82, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[440181, 11301, 117, 1, 56, "Subsection"],
Cell[440301, 11304, 396, 13, 35, "Input"],
Cell[440700, 11319, 21545, 542, 438, "Input"],
Cell[462248, 11863, 224, 6, 35, "Text"],
Cell[462475, 11871, 6685, 161, 335, "Input"],
Cell[469163, 12034, 23617, 579, 449, "Input"],
Cell[492783, 12615, 198, 6, 35, "Text"],
Cell[492984, 12623, 2183, 61, 174, "Input"],
Cell[495170, 12686, 2801, 76, 105, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[498008, 12767, 157, 2, 56, "Subsection"],
Cell[498168, 12771, 253, 5, 34, "Text"],
Cell[498424, 12778, 17842, 452, 321, "Input"],
Cell[516269, 13232, 259, 5, 34, "Text"],
Cell[516531, 13239, 2475, 61, 197, "Input"],
Cell[519009, 13302, 161, 3, 58, "Text"],
Cell[519173, 13307, 9467, 241, 312, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

